{
  "version": 3,
  "sources": ["../node_modules/@webqit/util/js/isObject.js", "../node_modules/@webqit/util/js/isTypeFunction.js", "../node_modules/@webqit/util/js/isTypeObject.js", "../node_modules/@webqit/util/js/isFunction.js", "../src/PlayElementClassFactory.js", "../src/PlayElement.js", "../src/targets.browser.js"],
  "sourcesContent": ["\r\n/**\r\n * Tells if val is pure object.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\r\n};\r\n", "\r\n/**\r\n * Tells if val is of type \"function\".\r\n * This holds true for both regular functions and classes.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn typeof val === 'function';\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"object\".\r\n * This holds true for anything object, including built-ins.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"function\".\r\n *\r\n * @param object \t\tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\r\n};\r\n", "\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _isObject } from '@webqit/util/js/index.js';\n\n/**\n * @PlayElementClassFactory\n */\nexport const PlayElementClassFactory = ( HTMLElement, ReflexFunction, Observer ) => class extends HTMLElement {\n\n    static get reflexFunctions() {\n        return [];\n    }\n\n    static get reflexFunctionsEnv() {\n        return {};\n    }\n\n    constructor() {\n        super();\n        const _static = this.constructor;\n        Object.defineProperty( this, 'reflexFunctionsInternals', { value: new Map } );\n        this._init = _static.reflexFunctions.map( methodName => {\n            if ( !_isFunction( this[ methodName ] ) ) throw new Error( `[PLAY_ELEMENT]: ${ methodName } is not a method.` );\n            if ( methodName === 'constructor' ) throw new Error( `[PLAY_ELEMENT]: Class constructors cannot be reflex methods.` );\n            return _await( _static.reflexCompile( this[ methodName ] ), ( [ reflexFunction, properties ] ) => {\n                Object.defineProperty( this, methodName, { value: reflexFunction } );\n                this.reflexFunctionsInternals.set( methodName, properties );\n            } );\n        } );\n        if ( ( this._init = this._init.filter( x => x instanceof Promise ) ).length ) {\n            this._init = Promise.all( this._init );\n        }\n    }\n\n    connectedCallback() {\n        super.connectedCallback && super.connectedCallback();\n        const _static = this.constructor;\n        _await( this._init, () => {\n            _static.reflexFunctions.forEach( methodName => {\n                const returnValue = this[ methodName ]();\n                _await( returnValue, ( [ , rerenderCallback ] ) => {\n                    _static.reflexBind( this.reflexFunctionsInternals.get( methodName ), rerenderCallback, this );\n                } );\n            } );\n        } );\n    }\n\n    disconnectedCallback() {\n        super.disconnectedCallback && super.disconnectedCallback();\n        const _static = this.constructor;\n        _await( this._init, () => {\n            _static.reflexFunctions.forEach( methodName => {\n                _static.reflexUnbind( this.reflexFunctionsInternals.get( methodName ) );\n            } );\n        } );\n    }\n\n    // ----------------------------------------------------------\n\n    static reflexCompile( _function ) {\n        let source = _function.toString();\n        if ( _isFunction( _function ) ) {\n            if ( !source.startsWith( 'function ' ) && !source.startsWith( 'function(' ) ) {\n                source = source.startsWith( 'async ' ) ? source.replace( 'async ', 'async function ' ) : `function ${ source }`;\n            };\n            source = `\\nreturn ${ source.replace( 'function', 'function **' ) }`;\n        }\n        let parameters = [];\n        if ( _isObject( this.reflexFunctionsEnv ) ) {\n            parameters = [ `{ ${ Object.keys( this.reflexFunctionsEnv ).join( ', ' ) } }` ];\n        }\n        let __function = ReflexFunction( parameters, source, {\n            compilerParams: this.compilerParams,\n            runtimeParams: this.runtimeParams,\n        } );\n        if ( _isObject( this.reflexFunctionsEnv ) ) {\n            return _await( __function( this.reflexFunctionsEnv ), ( [ __function ] ) => {\n                return [ __function, ReflexFunction.inspect( __function ) ];\n            } );\n        }\n        return [ __function, ReflexFunction.inspect( __function ) ];\n    }\n\n    static reflexBind( properties, rerenderCallback, thisContext = undefined ) {\n        _await( properties, properties => {\n            const _env = { ...( this.reflexFunctionsEnv || {} ), 'this': thisContext };\n            const getPaths = ( base, record_s ) => ( Array.isArray( record_s ) ? record_s : [ record_s ] ).map( record => [ ...base, ...( record.path || [ record.key ] ) ] );\n            properties.processes = properties.dependencies.map( path => {\n                if ( _isTypeObject( _env[ path[ 0 ] ] ) ) {\n                    if ( path.length === 1 ) return;\n                    return Observer.reduce( _env[ path[ 0 ] ], path.slice( 1 ), Observer.observe, record_s => {\n                        rerenderCallback( ...getPaths( [ path[ 0 ] ], record_s ) );\n                    } );\n                }\n                return Observer.reduce( globalThis, path, Observer.observe, record_s => {\n                    rerenderCallback( ...getPaths( [], record_s ) );\n                } );\n            } );\n        } );\n    }\n    \n    static reflexUnbind( properties ) {\n        _await( properties, properties => {\n            properties?.processes.forEach( process => process?.abort() );\n        } );\n    }\n\n    // ----------------------------------------------------------\n\n    static get runtimeParams() {\n        return { apiVersion: 2, };\n    }\n\n    static get compilerParams() {\n        return {};\n    }\n\n}\n\nexport const _await = ( maybePromise, callback ) => (\n    maybePromise instanceof Promise ? maybePromise.then( callback ) : callback( maybePromise )\n);", "\n/**\n * @imports\n */\nimport { PlayElementClassFactory } from './PlayElementClassFactory.js';\n\n/**\n * @PlayElementLite\n */\nexport default function PlayElement( HTMLElement ) {\n    if ( typeof self.webqit !== 'object' ) throw new Error( `No \"webqit\" object in context.` );\n    if ( typeof self.webqit.ReflexFunction !== 'function' ) throw new Error( `No \"webqit.ReflexFunction\" function in context.` );\n    if ( typeof self.webqit.Observer !== 'object' ) throw new Error( `No \"webqit.Observer\" object in context.` );\n    return PlayElementClassFactory( HTMLElement, window.webqit.ReflexFunction, window.webqit.Observer );\n}", "\n/**\n * @imports\n */\nimport PlayElement from './PlayElement.js';\n\n// As globals\nif ( !self.webqit ) { self.webqit = {}; }\nself.webqit.PlayElement = PlayElement;\n"],
  "mappings": "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",
  "names": ["isObject_default", "val", "isTypeFunction_default", "val", "isTypeObject_default", "val", "isTypeFunction_default", "isFunction_default", "val", "isTypeFunction_default", "PlayElementClassFactory", "HTMLElement", "ReflexFunction", "Observer", "_static", "methodName", "isFunction_default", "_await", "reflexFunction", "properties", "x", "returnValue", "rerenderCallback", "_function", "source", "parameters", "isObject_default", "__function", "thisContext", "_env", "getPaths", "base", "record_s", "record", "path", "isTypeObject_default", "process", "maybePromise", "callback", "PlayElement", "HTMLElement", "PlayElementClassFactory", "PlayElement"]
}
