{
  "version": 3,
  "sources": ["../node_modules/@webqit/util/js/isObject.js", "../node_modules/@webqit/util/js/isTypeFunction.js", "../node_modules/@webqit/util/js/isTypeObject.js", "../node_modules/@webqit/util/js/isFunction.js", "../src/PlayElementClassFactory.js", "../src/PlayElement.js", "../src/targets.browser.js"],
  "sourcesContent": ["\r\n/**\r\n * Tells if val is pure object.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\r\n};\r\n", "\r\n/**\r\n * Tells if val is of type \"function\".\r\n * This holds true for both regular functions and classes.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn typeof val === 'function';\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"object\".\r\n * This holds true for anything object, including built-ins.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"function\".\r\n *\r\n * @param object \t\tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isFunction, _isTypeObject, _isObject } from '@webqit/util/js/index.js';\r\n\r\n/**\r\n * @PlayElementClassFactory\r\n */\r\nexport const PlayElementClassFactory = ( HTMLElement, SubscriptFunction, Observer ) => class extends HTMLElement {\r\n\r\n    static get contractFunctions() {\r\n        return [];\r\n    }\r\n\r\n    static get contractFunctionsEnv() {\r\n        return {};\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const _static = this.constructor;\r\n        Object.defineProperty( this, 'contractFunctionsInternals', { value: new Map } );\r\n        this._init = _static.contractFunctions.map( methodName => {\r\n            if ( !_isFunction( this[ methodName ] ) ) throw new Error( `[PLAY_ELEMENT]: ${ methodName } is not a method.` );\r\n            if ( methodName === 'constructor' ) throw new Error( `[PLAY_ELEMENT]: Class constructors cannot be subscript methods.` );\r\n            return _await( _static.contractCompile( this[ methodName ] ), ( [ contractFunction, properties ] ) => {\r\n                Object.defineProperty( this, methodName, { value: contractFunction } );\r\n                this.contractFunctionsInternals.set( methodName, properties );\r\n            } );\r\n        } );\r\n        if ( ( this._init = this._init.filter( x => x instanceof Promise ) ).length ) {\r\n            this._init = Promise.all( this._init );\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback && super.connectedCallback();\r\n        const _static = this.constructor;\r\n        _await( this._init, () => {\r\n            _static.contractFunctions.forEach( methodName => {\r\n                const returnValue = this[ methodName ]();\r\n                _await( returnValue, ( [ , rerenderCallback ] ) => {\r\n                    _static.contractBind( this.contractFunctionsInternals.get( methodName ), rerenderCallback, this );\r\n                } );\r\n            } );\r\n        } );\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback && super.disconnectedCallback();\r\n        const _static = this.constructor;\r\n        _await( this._init, () => {\r\n            _static.contractFunctions.forEach( methodName => {\r\n                _static.contractUnbind( this.contractFunctionsInternals.get( methodName ) );\r\n            } );\r\n        } );\r\n    }\r\n\r\n    // ----------------------------------------------------------\r\n\r\n    static contractCompile( _function ) {\r\n        let source = _function.toString();\r\n        if ( _isFunction( _function ) ) {\r\n            if ( !source.startsWith( 'function ' ) && !source.startsWith( 'function(' ) ) {\r\n                source = source.startsWith( 'async ' ) ? source.replace( 'async ', 'async function ' ) : `function ${ source }`;\r\n            };\r\n            source = `\\nreturn ${ source.replace( 'function', 'function **' ) }`;\r\n        }\r\n        let parameters = [];\r\n        if ( _isObject( this.contractFunctionsEnv ) ) {\r\n            parameters = [ `{ ${ Object.keys( this.contractFunctionsEnv ).join( ', ' ) } }` ];\r\n        }\r\n        let __function = SubscriptFunction( parameters, source, {\r\n            compilerParams: this.compilerParams,\r\n            runtimeParams: this.runtimeParams,\r\n        } );\r\n        if ( _isObject( this.contractFunctionsEnv ) ) {\r\n            return _await( __function( this.contractFunctionsEnv ), ( [ __function ] ) => {\r\n                return [ __function, SubscriptFunction.inspect( __function, 'properties' ) ];\r\n            } );\r\n        }\r\n        return [ __function, SubscriptFunction.inspect( __function, 'properties' ) ];\r\n    }\r\n\r\n    static contractBind( properties, rerenderCallback, thisContext = undefined ) {\r\n        _await( properties, properties => {\r\n            const _env = { ...( this.contractFunctionsEnv || {} ), 'this': thisContext };\r\n            const getPaths = ( base, record_s ) => ( Array.isArray( record_s ) ? record_s : [ record_s ] ).map( record => [ ...base, ...( record.path || [ record.key ] ) ] );\r\n            properties.processes = properties.dependencies.map( path => {\r\n                if ( _isTypeObject( _env[ path[ 0 ] ] ) ) {\r\n                    return Observer.deep( _env[ path[ 0 ] ], path.slice( 1 ), Observer.observe, record_s => {\r\n                        rerenderCallback( ...getPaths( [ path[ 0 ] ], record_s ) );\r\n                    } );\r\n                }\r\n                return Observer.deep( globalThis, path, Observer.observe, record_s => {\r\n                    rerenderCallback( ...getPaths( [], record_s ) );\r\n                } );\r\n            } );\r\n        } );\r\n    }\r\n    \r\n    static contractUnbind( properties ) {\r\n        _await( properties, properties => {\r\n            properties?.processes.forEach( process => process.abort() );\r\n        } );\r\n    }\r\n\r\n    // ----------------------------------------------------------\r\n\r\n    static get runtimeParams() {\r\n        return { apiVersion: 2, };\r\n    }\r\n\r\n    static get compilerParams() {\r\n        return {};\r\n    }\r\n\r\n}\r\n\r\nexport const _await = ( maybePromise, callback ) => (\r\n    maybePromise instanceof Promise ? maybePromise.then( callback ) : callback( maybePromise )\r\n);", "\r\n/**\r\n * @imports\r\n */\r\nimport { PlayElementClassFactory } from './PlayElementClassFactory.js';\r\n\r\n/**\r\n * @PlayElementLite\r\n */\r\nexport default function PlayElement( HTMLElement ) {\r\n    if ( typeof self.webqit !== 'object' ) throw new Error( `No \"webqit\" object in context.` );\r\n    if ( typeof self.webqit.SubscriptFunction !== 'function' ) throw new Error( `No \"webqit.SubscriptFunction\" function in context.` );\r\n    if ( typeof self.webqit.Observer !== 'object' ) throw new Error( `No \"webqit.Observer\" object in context.` );\r\n    return PlayElementClassFactory( HTMLElement, window.webqit.SubscriptFunction, window.webqit.Observer );\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport PlayElement from './PlayElement.js';\r\n\r\n// As globals\r\nif ( !self.webqit ) { self.webqit = {}; }\r\nself.webqit.PlayElement = PlayElement;\r\n"],
  "mappings": "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",
  "names": ["isObject_default", "val", "isTypeFunction_default", "val", "isTypeObject_default", "val", "isTypeFunction_default", "isFunction_default", "val", "isTypeFunction_default", "PlayElementClassFactory", "HTMLElement", "SubscriptFunction", "Observer", "_static", "methodName", "isFunction_default", "_await", "contractFunction", "properties", "x", "returnValue", "rerenderCallback", "_function", "source", "parameters", "isObject_default", "__function", "thisContext", "_env", "getPaths", "base", "record_s", "record", "path", "isTypeObject_default", "process", "maybePromise", "callback", "PlayElement", "HTMLElement", "PlayElementClassFactory", "PlayElement"]
}
