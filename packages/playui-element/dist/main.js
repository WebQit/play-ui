(()=>{function f(r){return!Array.isArray(r)&&typeof r=="object"&&r}function a(r){return typeof r=="function"}function p(r){return Array.isArray(r)||typeof r=="object"&&r||a(r)}function m(r){return a(r)||r&&{}.toString.call(r)==="[object function]"}var O=(r,u,y)=>class extends r{static get contractFunctions(){return[]}static get contractFunctionsEnv(){return{}}constructor(){super();let e=this.constructor;Object.defineProperty(this,"contractFunctionsInternals",{value:new Map}),this._init=e.contractFunctions.map(t=>{if(!m(this[t]))throw new Error(`[PLAY_ELEMENT]: ${t} is not a method.`);if(t==="constructor")throw new Error("[PLAY_ELEMENT]: Class constructors cannot be subscript methods.");return c(e.contractCompile(this[t]),([n,o])=>{Object.defineProperty(this,t,{value:n}),this.contractFunctionsInternals.set(t,o)})}),(this._init=this._init.filter(t=>t instanceof Promise)).length&&(this._init=Promise.all(this._init))}connectedCallback(){super.connectedCallback&&super.connectedCallback();let e=this.constructor;c(this._init,()=>{e.contractFunctions.forEach(t=>{let n=this[t]();c(n,([,o])=>{e.contractBind(this.contractFunctionsInternals.get(t),o,this)})})})}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback();let e=this.constructor;c(this._init,()=>{e.contractFunctions.forEach(t=>{e.contractUnbind(this.contractFunctionsInternals.get(t))})})}static contractCompile(e){let t=e.toString();m(e)&&(!t.startsWith("function ")&&!t.startsWith("function(")&&(t=t.startsWith("async ")?t.replace("async ","async function "):`function ${t}`),t=`
return ${t.replace("function","function **")}`);let n=[];f(this.contractFunctionsEnv)&&(n=[`{ ${Object.keys(this.contractFunctionsEnv).join(", ")} }`]);let o=u(n,t,{compilerParams:this.compilerParams,runtimeParams:this.runtimeParams});return f(this.contractFunctionsEnv)?c(o(this.contractFunctionsEnv),([l])=>[l,u.inspect(l,"properties")]):[o,u.inspect(o,"properties")]}static contractBind(e,t,n=void 0){c(e,o=>{let l={...this.contractFunctionsEnv||{},this:n},_=(i,s)=>(Array.isArray(s)?s:[s]).map(b=>[...i,...b.path||[b.key]]);o.processes=o.dependencies.map(i=>p(l[i[0]])?y.deep(l[i[0]],i.slice(1),y.observe,s=>{t(..._([i[0]],s))}):y.deep(globalThis,i,y.observe,s=>{t(..._([],s))}))})}static contractUnbind(e){c(e,t=>{t?.processes.forEach(n=>n.abort())})}static get runtimeParams(){return{apiVersion:2}}static get compilerParams(){return{}}},c=(r,u)=>r instanceof Promise?r.then(u):u(r);function d(r){if(typeof self.webqit!="object")throw new Error('No "webqit" object in context.');if(typeof self.webqit.SubscriptFunction!="function")throw new Error('No "webqit.SubscriptFunction" function in context.');if(typeof self.webqit.Observer!="object")throw new Error('No "webqit.Observer" object in context.');return O(r,window.webqit.SubscriptFunction,window.webqit.Observer)}self.webqit||(self.webqit={});self.webqit.PlayElement=d;})();
//# sourceMappingURL=main.js.map
