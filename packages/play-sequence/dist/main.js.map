{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isTypeFunction.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isFunction.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isArray.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isString.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isUndefined.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isTypeObject.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isEmpty.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isNull.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isObject.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/from.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isTypeArray.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/first.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isNumber.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/js/isNumeric.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/pushUnique.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/getAllPropertyNames.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/getPrototypeChain.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/mergeCallback.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/merge.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/remove.js","webpack:///./node_modules/@webqit/play-js/src/animation/API.js","webpack:///./node_modules/@webqit/play-js/src/animation/Timeline.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/each.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/str/fromCamel.js","webpack:///./node_modules/@webqit/plot-js/src/css/vendorize.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/str/toCamel.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/str/toTitle.js","webpack:///./node_modules/@webqit/plot-js/src/css/ruleCallback.js","webpack:///./node_modules/@webqit/plot-js/src/css/classes/TransformRule.js","webpack:///./node_modules/@webqit/plot-js/src/css/readSync.js","webpack:///./node_modules/@webqit/plot-js/src/css/autopx.js","webpack:///./node_modules/@webqit/plot-js/src/css/writeSync.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/from.js","webpack:///./node_modules/@webqit/plot-js/src/css/readInline.js","webpack:///./node_modules/@webqit/plot-js/src/css/readAsync.js","webpack:///./node_modules/@webqit/plot-js/src/css/writeAsync.js","webpack:///./node_modules/@webqit/plot-js/src/css/readRendering.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/obj/copyPlain.js","webpack:///./node_modules/@webqit/plot-js/src/css/stylesheetRuleCallback.js","webpack:///./node_modules/@webqit/plot-js/src/css/parseRules.js","webpack:///./node_modules/@webqit/plot-js/src/css/readKeyframes.js","webpack:///./node_modules/@webqit/plot-js/src/css/varRead.js","webpack:///./node_modules/@webqit/play-js/src/animation/Ani.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/exclude.js","webpack:///./node_modules/@webqit/play-js/src/animation/Ani2.js","webpack:///./node_modules/@webqit/play-js/src/animation/Sequence.js","webpack:///C:/Users/ox_ha/Documents/CODE/webqit/util/arr/last.js","webpack:///./node_modules/@webqit/play-js/src/animation/play.js","webpack:///./src/dfn.js","webpack:///./src/index.js","webpack:///./src/browser-entry.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","val","toString","Array","isArray","String","arguments","length","undefined","keys","castObject","slice","values","count","arr","forEach","itm","firsts","amount","Number","isNaN","items","indexOf","push","keysAll","until","prototypalChain","obj","getPrototypeOf","getOwnPropertyNames","mergeCallback","objs","callback","deepProps","isReplace","withSymbols","depth","obj1","shift","Error","obj2","valAtObj1","valAtObj2","getOwnPropertyDescriptor","e","limit","splice","el","effect","params","this","$","readyCallbacks","finishCallbacks","cancelCallbacks","delay","duration","endDelay","anim","currentTime","to","ready","totalDuration","Math","max","min","reverse","Promise","resolve","reject","play","onfinish","oncancel","pause","finish","cancel","animations","add","addCallback","playState","reversed","removeCallback","reduce","a","b","progress","res","rej","alreadyResolved","alreadyRejected","handleFinish","handleCancel","total","then","catch","entry","except","each","seek","filter","includes","returnValue","k","parseFloat","str","split","join","delimiter","camelCasedProp","replace","txt","charAt","toUpperCase","strict","substr","toLowerCase","prop","fromStart","prefix","api","window","document","body","style","css","valsList","propsList","props","callCallback","normalProp","withVendorVersion","vendorize","vendorizedProp","TransformRule","transformRules","rule","trim","CTXT","round","r2d","radians","deg","PI","transformStr","WebKitCSSMatrix","f","rdigit","exec","stom","A","B","C","D","scaleX","sqrt","skew","scaleY","translate","scale","rotate","atan2","atan","map","getComputedStyle","psuedo","ruleCallback","rawProp","getPropertyValue","parse","nameOrProps","destructables","inset","margin","padding","destructableProp","meaning","autopx","getAttribute","RegExp","Reflow","onread","readSync","onwrite","writeSync","propsToRead","readCallback","inlineSavepoint","asyncMode","rendering","stylesheets","styleSheets","stylesheetCallback","stylesheet","cssRules","ruleDefinition","_split","cacheKey","noCache","stylesheetKeyframesCache","allKeyframes","stylesheetRuleCallback","type","CSSRule","KEYFRAMES_RULE","concat","keyframes","keyframeRule","keyframe","parseRules","cssText","keyText","offsets","parseInt","normalize","normalizeToWAAPI","_keyframe","offset","sort","parseKeyframes","animationProps","pref","easing","fill","iterations","Infinity","cssAnimNameCache","super","WQ","DOM","init","firstFrame","lastFrame","transform","itms","animate","error","cancelForCss","callFinish","callCancel","createCallback","animNameNoCache","succes","isObjectAndOnlyLastKeyframe","v","isArrayButEmptyFirstKeyframe","keyframesWithAutoSizes","height","width","readRendering","getBoundingClientRect","result","sym","for","_this","timing","active","state","currentDelay","totalTiming","calculate","interval","setInterval","stop","clearInterval","start","phase","_callBegin","_callEnd","_callPause","entries","nowPlaying","Timeline","queue","nowPlayingAdd","nowPlayingEffect","createAnimation","animation","oneoff","remove","compute","nowPlayingParams","lag","endLag","lastAni","_params","reverseList","only","Observers","Map","Observe","rootMargin","has","callbacks","set","IntersectionObserver","target","obs","observe","getAnimParams","animIn","animInAlt","ul","li","div","HTMLUListElement","_sequenceA","Sequence","_sequenceB","isIntersecting","boundingClientRect","top","HTMLLIElement","parentNode","sequenceAdd","HTMLDivElement","animatingA","animatingB","dfn","customElements","define","extends"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\r\n/**\r\n * Tells if val is of type \"function\".\r\n * This holds true for both regular functions and classes.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn typeof val === 'function';\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"function\".\r\n *\r\n * @param object \t\tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\r\n};\r\n","\r\n/**\r\n * Tells if val is of type \"array\".\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val);\r\n};\r\n","\r\n/**\r\n * Tells if val is of type \"string\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\r\n};\r\n","\r\n/**\r\n * Tells if val is undefined or is of type \"undefined\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"object\".\r\n * This holds true for anything object, including built-ins.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isNull from './isNull.js';\r\nimport _isUndefined from './isUndefined.js';\r\nimport _isTypeObject from './isTypeObject.js';\r\n\r\n/**\r\n * Tells if val is empty in its own type.\r\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\r\n * objects without keys, empty arrays.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \r\n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\r\n};\r\n","\r\n/**\r\n * Tells if val is undefined or is null.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val === null || val === '';\r\n};\r\n","\r\n/**\r\n * Tells if val is pure object.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\nimport _isTypeArray from '../js/isTypeArray.js';\r\nimport _isEmpty from '../js/isEmpty.js';\r\nimport _isObject from '../js/isObject.js';\r\n\r\n/**\r\n * Casts an array-like object to an array.\r\n *\r\n * @param mixed \tval\r\n * @param bool\t \tcastObject\r\n *\r\n * @return array\r\n */\r\nexport default function(val, castObject = true) {\r\n\tif (_isArray(val)) {\r\n\t\treturn val;\r\n\t};\r\n\tif (!castObject && _isObject(val)) {\r\n\t\treturn [val];\r\n\t};\r\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\r\n\t\treturn [];\r\n\t};\r\n\tif (_isTypeArray(val)) {\r\n\t\treturn Array.prototype.slice.call(val);\r\n\t};\r\n\tif (_isObject(val)) {\r\n\t\treturn Object.values(val);\r\n\t};\r\n\treturn [val];\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isString from './isString.js';\r\nimport _isUndefined from './isUndefined.js';\r\n\r\n/**\r\n * Tells if val is \"array-like\".\r\n * This holds true for anything that has a length property.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !_isString(val) && !_isUndefined(val.length);\r\n};\r\n","\r\n/**\r\n * Returns THE FIRST ENTRY OR A NUMBER OF ENTRIES counting forward from the begining.\r\n *\r\n * @param array \tarr\r\n * @param int\t \tamount\r\n *\r\n * @return mixed|array\r\n */\r\nexport default function(arr, amount = 1) {\r\n\tvar count = 0;\r\n\tarr.forEach(itm => {\r\n\t\tcount ++;\r\n\t});\r\n\tvar firsts = arr.slice(arr.length - count, amount);\r\n\treturn arguments.length > 1 ? firsts : firsts[0];\r\n};\r\n","\r\n/**\r\n * Tells if val is of type \"number\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val instanceof Number || (typeof val === 'number');\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isNumber from './isNumber.js';\r\n/**\r\n * Tells if val is of type \"string\" or a numeric string.\r\n * This holds true for both numbers and numeric strings.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\r\n};\r\n","\r\n/**\r\n * Adds an item if not already exist.\r\n *\r\n * @param array \tarr\r\n * @param array\t \t...itms\r\n *\r\n * @return array\r\n */\r\nexport default function(arr, ...items) {\r\n\titems.forEach(itm => {\r\n\t\tif (arr.indexOf(itm) < 0) {\r\n\t\t\tarr.push(itm);\r\n\t\t}\r\n\t});\r\n\treturn arr;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _pushUnique from '../arr/pushUnique.js';\r\nimport _getPrototypeChain from './getPrototypeChain.js';\r\n\r\n/**\r\n * Eagerly retrieves object members all down the prototype chain.\r\n *\r\n * @param object\t \tobj\r\n * @param object\t \tuntil\r\n *\r\n * @return array\r\n */\r\nexport default function(obj, until) {\r\n\tvar keysAll = [];\r\n\t_getPrototypeChain(obj, until).forEach(obj => {\r\n\t\t_pushUnique(keysAll, ...Object.getOwnPropertyNames(obj));\r\n\t});\r\n\treturn keysAll;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\n\r\n/**\r\n * Returns the prototype chain.\r\n *\r\n * @param object \t\tobj\r\n * @param object\t \tuntil\r\n *\r\n * @return bool\r\n */\r\nexport default function(obj, until) {\r\n\tuntil = until || Object.prototype;\r\n\tuntil = until && !_isArray(until) ? [until] : until;\r\n\t// We get the chain of inheritance\r\n\tvar prototypalChain = [];\r\n\tvar obj = obj;\r\n\twhile((obj && (!until || until.indexOf(obj) < 0) && obj.name !== 'default')) {\r\n\t\tprototypalChain.push(obj);\r\n\t\tobj = obj ? Object.getPrototypeOf(obj) : null;\r\n\t}\r\n\treturn prototypalChain;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\nimport _isFunction from '../js/isFunction.js';\r\nimport _isObject from '../js/isObject.js';\r\nimport _isTypeObject from '../js/isTypeObject.js';\r\nimport _isNumeric from '../js/isNumeric.js';\r\nimport _getAllPropertyNames from './getAllPropertyNames.js';\r\n\r\n/**\r\n  * Merges values from subsequent arrays/objects first array/object;\r\n  * optionally recursive\r\n  *\r\n  * @param array ...objs\r\n  *\r\n  * @return void\r\n  */\r\nexport default function mergeCallback(objs, callback, deepProps = false, isReplace = false, withSymbols = false) {\r\n\tvar depth = 0;\r\n\tvar obj1 = objs.shift();\r\n\tif (_isNumeric(obj1) || obj1 === true || obj1 === false) {\r\n\t\tdepth = obj1;\r\n\t\tobj1 = objs.shift();\r\n\t}\r\n\tif (!objs.length) {\r\n\t\tthrow new Error('_merge() requires two or more array/objects.');\r\n\t}\r\n\tobjs.forEach((obj2, i) => {\r\n\t\tif (!_isTypeObject(obj2) && !_isFunction(obj2)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t(deepProps ? _getAllPropertyNames(obj2) : Object.getOwnPropertyNames(obj2)).forEach(key => {\r\n\t\t\tif (!callback(key, obj1, obj2, i)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar valAtObj1 = obj1[key];\r\n\t\t\tvar valAtObj2 = obj2[key];\r\n\t\t\tif (((_isArray(valAtObj1) && _isArray(valAtObj2)) || (_isObject(valAtObj1) && _isObject(valAtObj2))) \r\n\t\t\t&& (depth === true || depth > 0)) {\r\n\t\t\t\t// RECURSE...\r\n\t\t\t\tobj1[key] = _isArray(valAtObj1) && _isArray(valAtObj2) ? [] : {};\r\n\t\t\t\tmergeCallback([_isNumeric(depth) ? depth - 1 : depth, obj1[key], valAtObj1, valAtObj2], callback, deepProps, isReplace, withSymbols);\r\n\t\t\t} else {\r\n\t\t\t\tif (_isArray(obj1) && _isArray(obj2)) {\r\n\t\t\t\t\tif (isReplace) {\r\n\t\t\t\t\t\tobj1[key] = valAtObj2;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj1.push(valAtObj2);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// In case we're setting a read-only property\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tif (withSymbols) {\r\n\t\t\t\t\t\t\tObject.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj2, key));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tobj1[key] = obj2[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\treturn obj1;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _mergeCallback from './mergeCallback.js';\r\n\r\n/**\r\n  * Merges values from subsequent arrays/objects first array/object;\r\n  * optionally recursive\r\n  *\r\n  * @param array ...objs\r\n  *\r\n  * @return void\r\n  */\r\nexport default function(...objs) {\r\n\treturn _mergeCallback(objs, (k, obj1, obj2) => {\r\n\t\treturn true;\r\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\r\n};\r\n","\r\n/**\r\n * Removes instances of reference up to <limit> times.\r\n *\r\n * @param array \tarr\r\n * @param mixed\t \titm\r\n * @param int|bool \tlimit\r\n *\r\n * @return array\r\n */\r\nexport default function(arr, itm, limit = false) {\r\n\tvar i = arr.indexOf(itm);\r\n\twhile (i > -1 && (limit || limit === false)) {\r\n\t\tarr.splice(i, 1);\r\n\t\tif (limit > 0) {\r\n\t\t\tlimit --;\r\n\t\t};\r\n\t\ti = arr.indexOf(itm);\r\n\t};\r\n\treturn arr;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isNumber from '@webqit/util/js/isNumber.js';\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\n/**\r\n * ---------------------------\r\n * The Element utility class\r\n * ---------------------------\r\n */\r\n\t\t\t\r\nexport default class AniAPI {\r\n\t\r\n\t/**\r\n\t * Creates an amiation from\r\n\t * any of keyframes, CSS keyframe name, or CSS object.\r\n\t *\r\n\t * @param Element\t\t\t\tel\r\n\t * @param any\t\t\t\t\teffect\r\n\t * @param object\t\t\t\tparams\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor(el, effect, params = {}) {\r\n\t\t// Private properties\r\n\t\tthis.el = el;\r\n\t\tthis.$ = {\r\n\t\t\tel,\r\n\t\t\treadyCallbacks: [],\r\n\t\t\tfinishCallbacks: [],\r\n\t\t\tcancelCallbacks: [],\r\n\t\t\tparams: {...params},\r\n\t\t\tcallFinish() {\r\n\t\t\t\tthis.finishCallbacks.forEach(callback => {\r\n\t\t\t\t\tcallback(this.el);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcallCancel() {\r\n\t\t\t\tthis.cancelCallbacks.forEach(callback => {\r\n\t\t\t\t\tcallback(this.el);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.$.params.delay = _isNumber(this.$.params.delay) ? this.$.params.delay : 0;\r\n\t\tthis.$.params.duration = _isNumber(this.$.params.duration) ? this.$.params.duration : 400;\r\n\t\tthis.$.params.endDelay = _isNumber(this.$.params.endDelay) ? this.$.params.endDelay : 0;\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Returns the animation.\r\n\t *\r\n\t * @return Animation\r\n\t */\r\n\tget anim() {\r\n\t\treturn this.$.anim;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a function to the \"onfinish\" event.\r\n\t *\r\n\t * @param function callback\r\n\t *\r\n\t * @return this\r\n\t *\r\n\t */\r\n\tonfinish(callback) {\r\n\t\tif (!_isFunction(callback)) {\r\n\t\t\tthrow new Error(\"Onfinish() accepts only a function.\");\r\n\t\t}\r\n\t\tthis.$.finishCallbacks.push(callback);\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a function to the \"oncancel\" event.\r\n\t *\r\n\t * @param function callback\r\n\t *\r\n\t * @return this\r\n\t *\r\n\t */\r\n\toncancel(callback) {\r\n\t\tif (!_isFunction(callback)) {\r\n\t\t\tthrow new Error(\"Oncancel() accepts only a function.\");\r\n\t\t}\r\n\t\tthis.$.cancelCallbacks.push(callback);\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Returns the animation's progress.\r\n\t *\r\n\t * @return number\r\n\t */\r\n\tprogress() {\r\n\t\tif (this.$.anim) {\r\n\t\t\treturn this.$.anim.currentTime / this.$.anim.effect.duration;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Seeks the animation to a time.\r\n\t *\r\n\t * @param number to\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tseek(to) {\r\n\t\tif (!_isNumber(to)) {\r\n\t\t\tthrow new Error(\"Seek() accepts only a numeric value.\");\r\n\t\t}\r\n\t\tthis.ready((anim, params) => {\r\n\t\t\tvar totalDuration = params.duration + (params.delay || 0) + (params.endDelay || 0);\r\n\t\t\tanim.currentTime = Math.max(0, Math.min(to * totalDuration, totalDuration));\r\n\t\t});\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Reverses the animation.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\treverse() {\r\n\t\tthis.ready(anim => anim.reverse());\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Plays the animation.\r\n\t * Returns an \"onfinish\" promise.\r\n\t *\r\n\t * @return Promise\r\n\t */\r\n\tplay() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.ready(anim => {\r\n\t\t\t\tanim.play();\r\n\t\t\t\tthis.onfinish(() => resolve(this));\r\n\t\t\t\tthis.oncancel(() => reject(this));\r\n\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Pauses the animation.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tpause() {\r\n\t\tthis.ready(anim => anim.pause());\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Finishes the animation.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tfinish() {\r\n\t\tthis.ready(anim => anim.finish());\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Cancels the animation.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tcancel() {\r\n\t\tthis.ready(anim => anim.cancel());\r\n\t\treturn this;\r\n\t}\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport _arrFrom from '@webqit/util/arr/from.js';\r\nimport _remove from '@webqit/util/arr/remove.js';\r\nimport API from './API.js';\r\n\r\n/**\r\n * -----------------------------\r\n * The timeline class\r\n * for working with multiple animations.\r\n * -----------------------------\r\n */\r\n \r\nexport default class {\r\n\t\r\n\t/**\r\n\t * Creates an amiation from keyframes.\r\n\t *\r\n\t * @param array\t\t\t\t\tanimations\r\n\t * @param object\t\t\t\tparams\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor(animations = [], params = {}) {\r\n\t\t// Private properties\r\n\t\tthis.$ = {\r\n\t\t\tanimations: [],\r\n\t\t\tfinishCallbacks: [],\r\n\t\t\tcancelCallbacks: [],\r\n\t\t\tparams: params,\r\n\t\t};\r\n\t\tanimations.forEach(anim => {\r\n\t\t\tthis.add(anim);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Adds an animation instance.\r\n\t *\r\n\t * @param API\t\t\t anim\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tadd(anim) {\r\n\t\tif (!(anim instanceof API)) {\r\n\t\t\tthrow new Error('Argument#1 must be an animation API instance!');\r\n\t\t}\r\n\t\tthis.$.animations.push(anim);\r\n\t\t\r\n\t\tif (this.$.addCallback) {\r\n\t\t\tthis.$.addCallback(anim);\r\n\t\t}\r\n\t\tswitch(this.$.playState) {\r\n\t\t\tcase 'paused':\r\n\t\t\t\tanim.pause();\r\n\t\t\tbreak;\r\n\t\t\tcase 'cancelled':\r\n\t\t\t\tanim.cancel();\r\n\t\t\tbreak;\r\n\t\t\tcase 'finished':\r\n\t\t\t\tanim.finish();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (this.$.reversed) {\r\n\t\t\tanim.reverse();\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Removes an animation instance.\r\n\t *\r\n\t * @param API\t\t\t anim\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tremove(anim) {\r\n\t\tif (!(anim instanceof API)) {\r\n\t\t\tthrow new Error('Argument#1 must be an animation API instance!');\r\n\t\t}\r\n\t\t_remove(this.$.animations, anim);\r\n\t\tif (this.$.removeCallback) {\r\n\t\t\tthis.$.removeCallback(anim);\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a function to the \"onfinish\" event.\r\n\t *\r\n\t * @param function callback\r\n\t *\r\n\t * @return this\r\n\t *\r\n\t */\r\n\tonfinish(callback) {\r\n\t\tif (!_isFunction(callback)) {\r\n\t\t\tthrow new Error(\"Onfinish() accepts only a function.\");\r\n\t\t}\r\n\t\tthis.$.finishCallbacks.push(callback);\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a function to the \"oncancel\" event.\r\n\t *\r\n\t * @param function callback\r\n\t *\r\n\t * @return this\r\n\t *\r\n\t */\r\n\toncancel(callback) {\r\n\t\tif (!_isFunction(callback)) {\r\n\t\t\tthrow new Error(\"Oncancel() accepts only a function.\");\r\n\t\t}\r\n\t\tthis.$.cancelCallbacks.push(callback);\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Returns the average of all animation's progress.\r\n\t *\r\n\t * @return number\r\n\t */\r\n\tprogress() {\r\n\t\treturn this.$.animations.reduce((a, b) => a.progress() + b.progress(), 0) / this.$.animations.length;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Plays all animations.\r\n\t * Returns an \"onfinish\" promise.\r\n\t *\r\n\t * @return Promise\r\n\t */\r\n\tplay() {\r\n\t\tthis.$.playState = 'playing';\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\t// ---------------------------------\r\n\t\t\tvar alreadyResolved, alreadyRejected;\r\n\t\t\tvar handleFinish = () => {\r\n\t\t\t\tif (!alreadyResolved) {\r\n\t\t\t\t\talreadyResolved = true;\r\n\t\t\t\t\tthis.$.finishCallbacks.forEach(callback => callback());\r\n\t\t\t\t\tres();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar handleCancel = e => {\r\n\t\t\t\tif (!alreadyRejected) {\r\n\t\t\t\t\talreadyRejected = true;\r\n\t\t\t\t\tthis.$.cancelCallbacks.forEach(callback => callback());\r\n\t\t\t\t\trej(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// ---------------------------------\r\n\t\t\tvar total = this.$.animations.length;\r\n\t\t\tthis.$.animations.forEach(anim => {\r\n\t\t\t\tanim.play().then(() => {\r\n\t\t\t\t\ttotal --;\r\n\t\t\t\t\tif (!total > 0) {\r\n\t\t\t\t\t\thandleFinish();\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(handleCancel);\r\n\t\t\t});\r\n\t\t\tthis.$.addCallback = entry => {\r\n\t\t\t\tif (this.$.playState === 'playing') {\r\n\t\t\t\t\ttotal ++;\r\n\t\t\t\t\tentry.play().then(() => {\r\n\t\t\t\t\t\ttotal --;\r\n\t\t\t\t\t\tif (!total > 0) {\r\n\t\t\t\t\t\t\thandleFinish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch(handleCancel);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.$.removeCallback = entry => {\r\n\t\t\t\ttotal --;\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Seeks all animations to a time.\r\n\t *\r\n\t * @param int \t\tto\r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tseek(to, except = []) {\r\n\t\t// The validity of the \"to\" input is handled by each anim...\r\n        this.each(anim => anim.seek(to), except);\r\n\t}\r\n\r\n\t/**\r\n\t * Reverses all animations.\r\n\t *\r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\treverse(except = []) {\r\n\t\tthis.$.reversed = this.$.reversed ? false : true;\r\n        this.each(anim => anim.reverse(), except);\r\n\t}\r\n\t/**\r\n\t * Pauses all animations.\r\n\t *\r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tpause(except = []) {\r\n\t\tthis.$.playState = 'paused';\r\n        this.each(anim => anim.pause(), except);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Finishes all animations.\r\n\t *\r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tfinish(except = []) {\r\n\t\tthis.$.playState = 'finished';\r\n        this.each(anim => anim.finish(), except);\r\n\t}\r\n\t    \t\r\n\t/**\r\n\t * Cancels all effects.\r\n\t \r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tcancel(except = []) {\r\n\t\tthis.$.playState = 'cancelled';\r\n        this.each(anim => anim.cancel(), except);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears all animations.\r\n\t *\r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tclear(except = []) {\r\n\t\tthis.$.animations = this.$.animations.filter(anim => {\r\n\t\t\tif (!except || !_arrFrom(except, false/*castObject*/).includes(anim.el)) {\r\n                return false;\r\n            }\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Loops thru entries, selectively.\r\n\t \r\n\t * @param array\t\texcept\r\n\t *\r\n\t * @return void\r\n\t */\r\n\teach(callback, except = []) {\r\n        this.$.animations.forEach(anim => {\r\n            if (!except || !_arrFrom(except, false/*castObject*/).includes(anim.el)) {\r\n                callback(anim);\r\n            }\r\n        });\r\n    }\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeObject from '../js/isTypeObject.js';\r\nimport _isNumeric from '../js/isNumeric.js';\r\n\r\n/**\r\n * Loops thru obj flatly with a callback function.\r\n * Stops when callback returns a non-undefined value.\r\n *\r\n * @param array|object \t\t\tobj \t\t\tThe array or object to iterate.\r\n * @param function \t\t\t\tcallback \t\tThe callback function.\r\n *\r\n * @return mixed|null\t\t\tAny non-null return from callback\r\n */\r\nexport default function(obj, callback) {\r\n\tvar returnValue = undefined;\r\n\tif (_isTypeObject(obj)) {\r\n\t\tObject.keys(obj).forEach((k, i) => {\r\n\t\t\tif (returnValue !== false) {\r\n\t\t\t\treturnValue = callback(_isNumeric(k) ? parseFloat(k) : k, obj[k], i);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\treturn returnValue;\r\n};\r\n","\r\n/**\r\n * Splits a camel-cased string.\r\n *\r\n * @param string \tstr\r\n * @param string \tdelimiter\r\n *\r\n * @return string\r\n */\r\nexport default function(str, delimiter) {\r\n\treturn str === undefined ? '' : str.split(/(?=[A-Z])/).join(delimiter ? delimiter : ' '); // positive lookahead to keep the capital letters\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _fromCamel from '@webqit/util/str/fromCamel.js';\r\nimport _toCamel from '@webqit/util/str/toCamel.js';\r\n\r\n/**\r\n * Returns the vendor-specific css property if supported. NULL if not.\r\n *\r\n * @param string \tprop\r\n *\r\n * @return string|NULL\r\n */\r\nexport default function(prop) {\r\n\tvar camelCasedProp = _toCamel(prop, true);\r\n\tif (this.prefix.api + camelCasedProp in this.window.document.body.style) {\r\n\t\treturn this.prefix.css + _fromCamel(prop, '-');\r\n\t}\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _toTitle from './toTitle.js';\r\n\r\n/**\r\n * Makes a string camel-cased.\r\n *\r\n * @param string \tstr\r\n * @param bool\t \tfromStart\r\n *\r\n * @return string\r\n */\r\nexport default function(str, fromStart) {\r\n\t// Make disting words\r\n\tstr = _toTitle(str.replace(/-/g, ' ')).replace(/ /g, '');\r\n\treturn fromStart ? str : str[0].toLowerCase() + str.substr(1);\r\n};\r\n","\r\n/**\r\n * Converts a string to title case.\r\n *\r\n * @param string \tstr\r\n * @param bool \t\tstrict\r\n *\r\n * @return string\r\n */\r\nexport default function(str, strict) {\r\n\tif (typeof str !== 'string') {\r\n\t\treturn str;\r\n\t}\r\n\treturn str.replace(/\\w\\S*/g,  function(txt) { return txt.charAt(0).toUpperCase() + ((typeof strict !== undefined && strict) ? txt.substr(1).toLowerCase() : txt.substr(1)); })\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _arrFrom from '@webqit/util/arr/from.js';\r\nimport _fromCamel from '@webqit/util/str/fromCamel.js';\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport _each from '@webqit/util/obj/each.js';\r\nimport vendorize from './vendorize.js';\r\n\r\n/**\r\n * Loops thru all keys in props calls callback to obtain their value.\r\n *\r\n * @param string|array\t\tprops\r\n * @param function\t\t\tcallback\r\n * @param bool\t\t\t\twithVendorVersion\r\n *\r\n * @return NULL|bool\r\n */\r\nexport default function(props, callback, withVendorVersion) {\r\n\tvar valsList = {};\r\n\tvar propsList = _arrFrom(props);\r\n\tvar callCallback = (i, prop) => {\r\n\t\t// We use the key as given, but we obtain value with\r\n\t\t// We support camel cases, but return their normalized versions\r\n\t\tvar normalProp = _fromCamel(prop, '-').toLowerCase();\r\n\t\t// With vendor verison?\r\n\t\t// We set the vendor version first if support for this property\r\n\t\tif (withVendorVersion === 'auto') {\r\n\t\t\tvalsList[normalProp] = callback(vendorize.call(this, normalProp) || normalProp, propsList[i]);\r\n\t\t} else {\r\n\t\t\tif (withVendorVersion) {\r\n\t\t\t\tvar vendorizedProp = vendorize.call(this, normalProp);\r\n\t\t\t\tif (vendorizedProp) {\r\n\t\t\t\t\tvalsList[vendorizedProp] = callback(vendorizedProp, propsList[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvalsList[normalProp] = callback(normalProp, propsList[i]);\r\n\t\t}\r\n\t};\r\n\t_each(propsList, (i, prop) => {\r\n\t\tcallCallback(i, prop);\r\n\t});\r\n\treturn _isArray(props) || withVendorVersion || props === 'size' || props === 'offsets' \r\n\t\t? valsList \r\n\t\t: valsList[props];\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _each from '@webqit/util/obj/each.js';\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport _isNumeric from '@webqit/util/js/isNumeric.js';\r\n\r\n/**\r\n * ------------------------------\r\n * The little transform utility class\r\n * and stringifyer classes.\r\n * ------------------------------\r\n */\r\nconst TransformRule = class {\r\n\t\r\n\t/**\r\n\t * Creates a new TransformRule instance\r\n\t * and each rule's appropriate class.\r\n\t *\r\n\t * @param object\t\t transformRules\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor(transformRules) {\r\n\t\t_each(transformRules, (rule, value) => {\r\n\t\t\tif (['rotate', 'scale', 'skew', 'translate'].includes(rule)) {\r\n\t\t\t\tthis[rule] = _isArray(value)\r\n\t\t\t\t\t? new TransformRule[rule](...value)\r\n\t\t\t\t\t: new TransformRule[rule](value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Stringifies the transformRules in a CSS-compatible format.\r\n\t *\r\n\t * @return string\r\n\t */\r\n\ttoString() {\r\n\t\treturn ['rotate', 'scale', 'skew', 'translate'].reduce(\r\n\t\t\t(str, rule) => str + (this[rule] && this[rule].length ? ' ' + this[rule] : ''), ''\r\n\t\t).trim();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Unmatrix: parse the values of the matrix\r\n\t *\r\n\t * Algorithm from:\r\n\t *\r\n\t * https://github.com/matthewmueller/unmatrix/blob/master/index.js\r\n\t * @see http://hg.mozilla.org/mozilla-central/file/7cb3e9795d04/layout/style/nsStyleAnimation.cpp\r\n\t *\r\n\t * @param string \t str\r\n\t *\r\n\t * @return {Object}\r\n\t */\r\n\tstatic parse(CTXT, str) {\r\n\t\t// String to matrix\r\n\t\tvar stom = function(transformStr) {\r\n\t\t\tvar m = [];\r\n\t\t\tif (CTXT.window.WebKitCSSMatrix) {\r\n\t\t\t\tm = new CTXT.window.WebKitCSSMatrix(transformStr);\r\n\t\t\t\treturn [m.a, m.b, m.c, m.d, m.e, m.f];\r\n\t\t\t}\r\n\t\t\tvar rdigit = /[\\d\\.\\-]+/g;\r\n\t\t\tvar n;\r\n\t\t\twhile(n = rdigit.exec(transformStr)) {\r\n\t\t\t\tm.push(+n);\r\n\t\t\t}\r\n\t\t\treturn m;\r\n\t\t};\r\n\t\t// Round to the nearest hundredth\r\n\t\tvar round = function(n) {\r\n\t\t\treturn Math.round(n * 100) / 100;\r\n\t\t};\r\n\t\t// Radians to degrees\r\n\t\tvar r2d = function(radians) {\r\n\t\t\tvar deg = radians * 180 / Math.PI;\r\n\t\t\treturn round(deg);\r\n\t\t};\r\n\t\t// ---------------------------------\r\n\t\tvar m = stom(str);\r\n\t\tvar A = m[0];\r\n\t\tvar B = m[1];\r\n\t\tvar C = m[2];\r\n\t\tvar D = m[3];\r\n\t\tif (A * D == B * C) throw new Error('Dramatic.parseTransform: matrix is singular');\r\n\t\t// step (3)\r\n\t\tvar scaleX = Math.sqrt(A * A + B * B);\r\n\t\tA /= scaleX;\r\n\t\tB /= scaleX;\r\n\t\t// step (4)\r\n\t\tvar skew = A * C + B * D;\r\n\t\tC -= A * skew;\r\n\t\tD -= B * skew;\r\n\t\t// step (5)\r\n\t\tvar scaleY = Math.sqrt(C * C + D * D);\r\n\t\tC /= scaleY;\r\n\t\tD /= scaleY;\r\n\t\tskew /= scaleY;\r\n\t\t// step (6)\r\n\t\tif ( A * D < B * C ) {\r\n\t\t\tA = -A;\r\n\t\t\tB = -B;\r\n\t\t\tskew = -skew;\r\n\t\t\tscaleX = -scaleX;\r\n\t\t}\r\n\t\treturn new TransformRule({\r\n\t\t\ttranslate: [/*x*/m[4], /*y*/m[5],],\r\n\t\t\tscale: [/*x*/round(scaleX), /*y*/round(scaleY),],\r\n\t\t\trotate: r2d(Math.atan2(B, A)),\r\n\t\t\tskew: r2d(Math.atan(skew)),\r\n\t\t});\r\n\t};\r\n};\r\n\r\n/**\r\n * -------------\r\n * The \"rotate\" value class\r\n * -------------\r\n */\r\nTransformRule.rotate = class extends Array {\r\n\t\r\n\t/**\r\n\t * Returns \"rotate\" values as a CSS function\r\n\t *\r\n\t * @return string\r\n\t */\r\n\ttoString() {\r\n\t\tvar values = this.map(val => _isNumeric(val) ? val + 'deg' : val);\r\n\t\treturn 'rotate(' + values.join(', ') + ')';\r\n\t}\r\n};\r\n\r\n/**\r\n * -------------\r\n * The \"scale\" array class\r\n * -------------\r\n */\r\nTransformRule.scale = class extends Array {\r\n\t\r\n\t/**\r\n\t * Returns \"scale\" values as a CSS function\r\n\t *\r\n\t * @return string\r\n\t */\r\n\ttoString() {\r\n\t\treturn 'scale(' + this.join(', ') + ')';\r\n\t}\r\n};\r\n\r\n/**\r\n * -------------\r\n * The \"skew\" array class\r\n * -------------\r\n */\r\nTransformRule.skew = class extends Array {\r\n\t\r\n\t/**\r\n\t * Returns \"skew\" values as a CSS function\r\n\t *\r\n\t * @return string\r\n\t */\r\n\ttoString() {\r\n\t\tvar values = this.map(val => _isNumeric(val) ? val + 'deg' : val);\r\n\t\treturn 'skew(' + values.join(', ') + ')';\r\n\t}\r\n};\r\n\r\n/**\r\n * -------------\r\n * The \"translate\" array class\r\n * -------------\r\n */\r\nTransformRule.translate = class extends Array {\r\n\t\r\n\t/**\r\n\t * Returns \"translate\" values as a CSS function\r\n\t *\r\n\t * @return string\r\n\t */\r\n\ttoString() {\r\n\t\tvar values = this.map(val => _isNumeric(val) ? val + 'px' : val);\r\n\t\treturn 'translate(' + values.join(', ') + ')';\r\n\t}\r\n};\r\n\r\n/**\r\n * @exports\r\n */\r\nexport default TransformRule;","\r\n/**\r\n * @imports\r\n */\r\nimport ruleCallback from './ruleCallback.js';\r\nimport TransformRule from './classes/TransformRule.js';\r\nimport vendorize from './vendorize.js';\r\n\r\n/**\r\n * Returns computed CSS properties.\r\n *\r\n * @param HTMLElement\t\tel\r\n * @param string|array\t\tprops\r\n * @param string\t\t\tpsuedo\r\n *\r\n * @return object|string\r\n */\r\nexport default function(el, props, psuedo = null) {\r\n\tvar style = this.window.getComputedStyle(el, psuedo), rect;\r\n\treturn ruleCallback.call(this, props, (prop, rawProp) => {\r\n\t\tvar val = style.getPropertyValue(vendorize.call(this, prop) || prop);\r\n\t\tif ((prop === 'width' || prop === 'height') && val === '') {\r\n\t\t\tval = '0px';\r\n\t\t}\r\n\t\t// -----------------------------\r\n\t\t// We return an object for the \"transform\" property\r\n\t\t// -----------------------------\r\n\t\tif (prop === 'transform') {\r\n\t\t\tval = TransformRule.parse(this, val);\r\n\t\t}\r\n\t\treturn val;\r\n\t}, false/*withVendorVersion*/);\r\n};\r\n","\r\n/**\r\n * CSS properties that must have a default pixel unit.\r\n *\r\n * @var array\r\n */\r\nexport default ['width', 'height', 'top', 'left', 'right', 'bottom',\r\n\t'padding', 'padding-top', 'padding-left', 'padding-right', 'padding-bottom',\r\n\t'margin', 'margin-top', 'margin-left', 'margin-right', 'margin-bottom',\r\n\t'border-width', 'border-top-width', 'border-left-width', 'border-right-width', 'border-bottom-width',\r\n\t'outline-width', 'outline-top-width', 'outline-left-width', 'outline-right-width', 'outline-bottom-width',\r\n];\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isString from '@webqit/util/js/isString.js';\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport _isObject from '@webqit/util/js/isObject.js';\r\nimport _isUndefined from '@webqit/util/js/isUndefined.js';\r\nimport _isNumeric from '@webqit/util/js/isNumeric.js';\r\nimport _objFrom from '@webqit/util/obj/from.js';\r\nimport _each from '@webqit/util/obj/each.js';\r\nimport TransformRule from './classes/TransformRule.js';\r\nimport ruleCallback from './ruleCallback.js';\r\nimport autopx from './autopx.js';\r\n\r\n/**\r\n * Sets new CSS properties.\r\n *\r\n * @param HTMLElement\t\tel\r\n * @param string|object\t\tnameOrProps\r\n * @param string|number\t\tval\r\n *\r\n * @return HTMLElement\r\n */\r\nexport default function(el, nameOrProps, val = null) {\r\n\tnameOrProps = _isString(nameOrProps)\r\n\t\t? _objFrom(nameOrProps, val)\r\n\t\t: nameOrProps;\r\n\tvar destructables = {\r\n\t\tinset: ['top', 'right', 'bottom', 'left'],\r\n\t\tmargin: ['top', 'right', 'bottom', 'left'],\r\n\t\tpadding: ['top', 'right', 'bottom', 'left'],\r\n\t};\r\n\truleCallback.call(this, Object.keys(nameOrProps), (prop, rawProp) => {\r\n\t\tvar val = nameOrProps[rawProp];\r\n\t\t// -----------------------------\r\n\t\t// We can destucture things like \"inset\"(\"left\", \"top\", \"right\", \"bottom\"), etc\r\n\t\t// -----------------------------\r\n\t\t_each(destructables, (destructableProp, meaning) => {\r\n\t\t\tif (prop === destructableProp) {\r\n\t\t\t\tif (_isObject(val)) {\r\n\t\t\t\t\tval = meaning.map(key => val[key]).filter(val => !_isUndefined(val));\r\n\t\t\t\t}\r\n\t\t\t\tif (_isArray(val)) {\r\n\t\t\t\t\tval = val.join(' ');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t// -----------------------------\r\n\t\t// We accept an object for the \"transform\" property\r\n\t\t// -----------------------------\r\n\t\tif (prop === 'transform' && _isObject(val) && !(val instanceof TransformRule)) {\r\n\t\t\tval = (new TransformRule(val)).toString();\r\n\t\t}\r\n\t\tel.style[prop] = autopx.includes(prop) && _isNumeric(val)\r\n\t\t\t? val + 'px'\r\n\t\t\t: val;\r\n\t}, 'auto'/*withVendorVersion*/);\r\n\treturn el;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\nimport _isString from '../js/isString.js';\r\n\r\n/**\r\n * Return an object for the given pair(s) of input.\r\n *\r\n * @param string|array \t\t\tkey\r\n * @param mixed|array\t\t\tval \r\n *\r\n * @return object\r\n */\r\nexport default function(key, val = null) {\r\n\tvar obj = {};\r\n\tif (arguments.length === 2) {\r\n\t\tif (_isArray(key) && _isArray(val)) {\r\n\t\t\tkey.forEach((k, i) => obj[k] = val[i]);\r\n\t\t} else {\r\n\t\t\tobj[key] = val;\r\n\t\t}\r\n\t}\r\n\treturn obj;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport ruleCallback from './ruleCallback.js';\r\n\r\n/**\r\n * Returns inline-only CSS properties.\r\n *\r\n * @param HTMLElement\t\tel\r\n * @param string|object\t\tprop\r\n * @param bool|string\t\twithVendorVersions\r\n *\r\n * @return mixed\r\n */\r\nexport default function(el, props, withVendorVersion = 'auto') {\r\n\tvar style = el.getAttribute('style');\r\n\tif (props === 'all') {\r\n\t\tprops = style.split(';').map(str => str.split(':')[0]);\r\n\t}\r\n\treturn ruleCallback.call(this, props, prop => {\r\n\t\tvar regex = new RegExp(';[ ]*?' + prop + ':([^;]+);?', 'g');\r\n\t\treturn (regex.exec(';' + style) || ['', ''])[1].trim();\r\n\t}, withVendorVersion);\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport readSync from './readSync.js';\r\n\r\n/**\r\n * The async type of readSync().\r\n *\r\n * @see readSync()\r\n *\r\n * @return Promise\r\n */\r\nexport default function(el, props, psuedo = null) {\r\n\treturn this.Reflow.onread((resolve, reject) => {\r\n\t\ttry {\r\n\t\t\tresolve(_isFunction(props) ? props(el) : readSync.call(this, el, props, psuedo));\r\n\t\t} catch(e) {\r\n\t\t\treject(e);\r\n\t\t}\r\n\t}, true/*withPromise*/);\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport writeSync from './writeSync.js';\r\n\r\n/**\r\n * The async type of writeSync().\r\n *\r\n * @see cssWrite()\r\n *\r\n * @return Promise\r\n */\r\nexport default function(el, nameOrProps, val = null) {\r\n\treturn this.Reflow.onwrite((resolve, reject) => {\r\n\t\ttry {\r\n\t\t\tresolve(_isFunction(nameOrProps) ? nameOrProps(el) : writeSync.call(this, el, nameOrProps, val));\r\n\t\t} catch(e) {\r\n\t\t\treject(e);\r\n\t\t}\r\n\t}, true/*withPromise*/);\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isObject from '@webqit/util/js/isObject.js';\r\nimport cssReadInline from './readInline.js';\r\nimport cssReadSync from './readSync.js';\r\nimport cssWriteSync from './writeSync.js';\r\nimport cssReadAsync from './readAsync.js';\r\nimport cssWriteAsync from './writeAsync.js';\r\n\r\n/**\r\n * Applies some CSS within a transaction, gets computed values for use before rolling back.\r\n * If a callback is provided, it synces the entire operation with Reflow's normal read/write cycles.\r\n *\r\n * @param HTMLElement\t\tel \r\n * @param string|object\t\tnameOrProps\r\n * @param string|number\t\tval\r\n * @param function\t\t\treadCallback\r\n * @param bool\t\t\t\tasyncMode\r\n *\r\n * @return Promise\r\n */\r\nexport default async function(el, nameOrProps, val = null, readCallback = null. asyncMode = false) {\r\n\tvar propsToRead = _isObject(nameOrProps) ? Object.keys(nameOrProps) : nameOrProps;\r\n\treadCallback = _isObject(nameOrProps) ? val : readCallback;\r\n\t// -------------\r\n\tvar inlineSavepoint = cssReadInline.call(this, el, propsToRead);\r\n\tawait (asyncMode ? cssWriteAsync : cssWriteSync).call(this, el, nameOrProps, val);\r\n\tvar rendering = (asyncMode ? cssReadAsync : cssReadSync).call(this, el, readCallback || propsToRead);\r\n\t// We return the rendering in a promise\r\n\tawait (asyncMode ? cssWriteAsync : cssWriteSync).call(this, el, inlineSavepoint);\r\n\treturn rendering;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\nimport _isFunction from '../js/isFunction.js';\r\nimport _mergeCallback from './mergeCallback.js';\r\n\r\n/**\r\n * Copies only properties of an object.\r\n *\r\n * @param object\t \tobj\r\n * @param array\t\t \tonly\r\n * @param array\t\t \texcept\r\n *\r\n * @return object\r\n */\r\nexport default function(obj, filter = []) {\r\n\treturn _mergeCallback([{}, obj], (key, obj1, obj2) => {\r\n\t\tif (!_isFunction(obj2[key])) {\r\n\t\t\treturn _isFunction(filter) ? filter(key) \r\n\t\t\t\t: (_isArray(filter) && filter.length ? filter.indexOf(key) > -1 : true);\r\n\t\t}\r\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\r\n};\r\n","\r\n/**\r\n * Loops thru all rules in all stylesheets (in reverse order possible).\r\n *\r\n * @param function\t\t\tcallback\r\n * @param bool\t\t\t\treversed\r\n *\r\n * @return NULL|bool\r\n */\r\nexport default function(callback, reversed = false) {\r\n\tvar stylesheets = document.styleSheets;\r\n\tvar stylesheetCallback = function(stylesheet) {\r\n\t\ttry {\r\n\t\t\tfor (var k = 0; k < stylesheet.cssRules.length; k ++) {\r\n\t\t\t\tvar ruleDefinition = stylesheet.cssRules[k];\r\n\t\t\t\tif (callback(ruleDefinition) === true) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {}\r\n\t}\r\n\tif (reversed) {\r\n\t\tfor (var i = stylesheets.length - 1; i >= 0; i --) {\r\n\t\t\tif (stylesheetCallback(stylesheets[i]) === true) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var i = 0; i < stylesheets.length; i ++) {\r\n\t\t\tif (stylesheetCallback(stylesheets[i]) === true) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n","\r\n/**\r\n * Helper method: parses a CSS string into an associative array.\r\n *\r\n * @param string\t \tcss\r\n *\r\n * @return object\r\n */\r\nexport default function(css) {\r\n\tvar _split = {};\r\n\tcss.split(';').filter(r => r).forEach(rule => {\r\n\t\trule = rule.split(':');\r\n\t\t_split[rule[0].trim()] = rule[1].trim();\r\n\t});\r\n\treturn _split;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _copyPlain from '@webqit/util/obj/copyPlain.js';\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport stylesheetRuleCallback from './stylesheetRuleCallback.js';\r\nimport parseRules from './parseRules.js';\r\n\r\n/**\r\n * FInds the keyframes of the given animation name(s) across all stylesheets.\r\n *\r\n * @param string|array\t\tname\r\n * @param bool\t\t\t\tnoCache\r\n * @param bool\t\t\t\tnormalize\r\n *\r\n * @return NULL|bool\r\n */\r\nexport default function(name, noCache, normalize = true) {\r\n\t// Ask cache first...\r\n\tvar cacheKey = _isArray(name) ? name.join('|') : name;\r\n\tif (!noCache && stylesheetKeyframesCache[cacheKey]) {\r\n\t\treturn stylesheetKeyframesCache[cacheKey];\r\n\t}\r\n\t// Parse keyframes rule\r\n\tvar parseKeyframes = function(ruleDefinition) {\r\n\t\tvar keyframes = [];\r\n\t\tfor (var i = 0; i < ruleDefinition.cssRules.length; i ++) {\r\n\t\t\tvar keyframeRule = ruleDefinition.cssRules[i];\r\n\t\t\tvar keyframe = parseRules(keyframeRule.cssText.replace(keyframeRule.keyText, '').replace('{', '').replace('}', '').trim());\r\n\t\t\tvar offsets = (keyframeRule.keyText || ' ').split(',').map(key => key === 'from' ? 0 : (key === 'to' ? 1 : (parseInt(key) / 100)));\r\n\t\t\tif (normalize) {\r\n\t\t\t\tnormalizeToWAAPI(keyframe, ['animation-', 'transition-']);\r\n\t\t\t\twhile(offsets.length) {\r\n\t\t\t\t\tvar _keyframe = _copyPlain(keyframe);\r\n\t\t\t\t\t_keyframe.offset = offsets.shift();\r\n\t\t\t\t\tkeyframes.push(_keyframe);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tkeyframe.offset = offsets.length > 1 ? offsets : offsets[0];\r\n\t\t\t\tkeyframes.push(keyframe);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn keyframes.sort((a, b) => a.offset === b.offset ? 0 : a.offset > b.offset ? 1 : -1);\r\n\t};\r\n\t// Find keyframes\r\n\tvar allKeyframes = [];\r\n\tstylesheetRuleCallback.call(this, ruleDefinition => {\r\n\t\tif ((ruleDefinition.type === this.window.CSSRule.KEYFRAMES_RULE || ruleDefinition.type === this.window.CSSRule[this.prefix.api.toUpperCase() + '_KEYFRAMES_RULE'])\r\n\t\t&& (_isArray(name) ? name : [name]).indexOf(ruleDefinition.name) > -1) {\r\n\t\t\tallKeyframes = allKeyframes.concat(allKeyframes, parseKeyframes(ruleDefinition));\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}, true/*reversed*/);\r\n\t// Save\r\n\tstylesheetKeyframesCache[cacheKey] = allKeyframes;\r\n\treturn allKeyframes;\r\n};\r\n\r\n/**\r\n * Normalizes CSS animation properties to WAAPI compatible properties\r\n *\r\n * @param object\t\t\tanimationProps\r\n * @param string|arrau\t\tprefix\r\n * @param string|arrau\t\toffset\r\n *\r\n * @return null\r\n */\r\nconst normalizeToWAAPI = function(animationProps, offset, prefix = '') {\r\n\tif (_isArray(prefix)) {\r\n\t\tprefix.forEach(pref => normalizeToWAAPI(animationProps, pref));\r\n\t\treturn;\r\n\t}\r\n\tif (animationProps[prefix + 'timing-function']) {\r\n\t\tanimationProps.easing = animationProps[prefix + 'timing-function'];\r\n\t\tdelete animationProps[prefix + 'timing-function'];\r\n\t}\r\n\tif (animationProps[prefix + 'fill-mode']) {\r\n\t\tanimationProps.fill = animationProps[prefix + 'fill-mode'];\r\n\t\tdelete animationProps[prefix + 'fill-mode'];\r\n\t}\r\n\tif (animationProps[prefix + 'iteration-count']) {\r\n\t\tanimationProps.iterations = animationProps[prefix + 'iteration-count'];\r\n\t\tdelete animationProps[prefix + 'iteration-count'];\r\n\t\tif (animationProps.iterations === 'infinite') {\r\n\t\t\tanimationProps.iterations = Infinity;\r\n\t\t}\r\n\t}\r\n};\r\n\t\r\n/**\r\n * @var object\r\n */\r\nconst stylesheetKeyframesCache = {};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _fromCamel from '@webqit/util/str/fromCamel.js';\r\n\r\n/**\r\n * Returns preset easing functions from CSS variables.\r\n *\r\n * @param string \tname\r\n *\r\n * @return string|NULL\r\n */\r\nexport default function(name) {\r\n\tvar name = !name.indexOf('-') ? _fromCamel(name, '-') : name;\r\n\treturn this.window.getComputedStyle(this.window.document.body).getPropertyValue('--' + name);\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _each from '@webqit/util/obj/each.js';\r\nimport _exclude from '@webqit/util/arr/exclude.js';\r\nimport _pushUnique from '@webqit/util/arr/pushUnique.js';\r\nimport _isString from '@webqit/util/js/isString.js';\r\nimport _isArray from '@webqit/util/js/isArray.js';\r\nimport _isObject from '@webqit/util/js/isObject.js';\r\nimport _isNumeric from '@webqit/util/js/isNumeric.js';\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport _isEmpty from '@webqit/util/js/isEmpty.js';\r\nimport _isUndefined from '@webqit/util/js/isUndefined.js';\r\n// ------------------------------------\r\nimport API from './API.js';\r\n// ------------------------------------\r\nimport readSync from '@webqit/plot-js/src/css/readSync.js';\r\nimport writeSync from '@webqit/plot-js/src/css/writeSync.js';\r\nimport readRendering from '@webqit/plot-js/src/css/readRendering.js';\r\nimport readSyncKeyframes from '@webqit/plot-js/src/css/readKeyframes.js';\r\nimport cssVarRead from '@webqit/plot-js/src/css/varRead.js';\r\nimport cssAutopx from '@webqit/plot-js/src/css/autopx.js';\r\nimport TransformRule from '@webqit/plot-js/src/css/classes/TransformRule.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The Ani class\r\n * ---------------------------\r\n */\r\n\r\nconst cssAnimNameCache = {};\r\nexport default class Ani extends API {\r\n\t\r\n\t/**\r\n\t * Creates an amiation from\r\n\t * any of keyframes, CSS keyframe name, or CSS object.\r\n\t *\r\n\t * @param Element\t\t\t\tel\r\n\t * @param array|object|string\teffect\r\n\t * @param object\t\t\t\tparams\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor(el, effect, params = {}) {\r\n\t\tsuper(el, effect, params);\r\n\t\t// -----------------------------\r\n\t\tthis.$.params.fill = this.$.params.fill || 'both';\r\n\t\tif (!('duration' in this.$.params)) {\r\n\t\t\tthis.$.params.duration = 400;\r\n\t\t}\r\n\t\t// Convert certain easing strings to beizier curves\r\n\t\tif (this.$.params.easing && ['ease-in', 'ease-out', 'ease-in-out'].indexOf(this.$.params.easing) === -1 && this.$.params.easing.indexOf('(') === -1) {\r\n\t\t\t// Native easings, custom cubic-beziers, or Dramatic's cubic-beziers\r\n\t\t\tthis.$.params.easing = cssVarRead.call(WQ.DOM, this.$.params.easing) || this.$.params.easing;\r\n\t\t}\r\n\t\t// -----------------------------\r\n\t\t// Normalize keyframes...\r\n\t\t// -----------------------------\r\n\t\tvar destructables = {\r\n\t\t\tinset: ['top', 'right', 'bottom', 'left'],\r\n\t\t\tmargin: ['top', 'right', 'bottom', 'left'],\r\n\t\t\tpadding: ['top', 'right', 'bottom', 'left'],\r\n\t\t};\r\n\t\tconst init = keyframes => {\r\n\t\t\tkeyframes = keyframes.slice();\r\n\t\t\t// Mine out end-state properties\r\n\t\t\tvar firstFrame = {};\r\n\t\t\tvar lastFrame = {};\r\n\t\t\t_each(keyframes, (i, keyframe) => {\r\n\t\t\t\t// -----------------------------\r\n\t\t\t\t// We can destucture things like \"inset\"(\"left\", \"top\", \"right\", \"bottom\"), etc\r\n\t\t\t\t// -----------------------------\r\n\t\t\t\t_each(destructables, (destructableProp, meaning) => {\r\n\t\t\t\t\tif (keyframe[destructableProp]) {\r\n\t\t\t\t\t\tif (_isObject(keyframe[destructableProp])) {\r\n\t\t\t\t\t\t\tkeyframe[destructableProp] = meaning.map(key => keyframe[destructableProp][key]).filter(val => !_isUndefined(val));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (_isArray(keyframe[destructableProp])) {\r\n\t\t\t\t\t\t\tkeyframe[destructableProp] = keyframe[destructableProp].join(' ');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// -----------------------------\r\n\t\t\t\t// We accept an object for the \"transform\" property\r\n\t\t\t\t// -----------------------------\r\n\t\t\t\tif (keyframe.transform && _isObject(keyframe.transform) && !(keyframe.transform instanceof TransformRule)) {\r\n\t\t\t\t\tkeyframe.transform = (new TransformRule(keyframe.transform)).toString();\r\n\t\t\t\t}\r\n\t\t\t\t// Marshal out its properties\r\n\t\t\t\t_exclude(Object.keys(keyframe), 'offset', 'easing').forEach(prop => {\r\n\t\t\t\t\t// Auto-px\r\n\t\t\t\t\tif (cssAutopx.includes(prop) && _isNumeric(keyframe[prop])) {\r\n\t\t\t\t\t\tkeyframe[prop] += 'px';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Save last seen value of this property\r\n\t\t\t\t\t// across all keyframes...\r\n\t\t\t\t\tfirstFrame[prop] = typeof firstFrame[prop] === 'undefined' ? keyframe[prop] : firstFrame[prop];\r\n\t\t\t\t\tlastFrame[prop] = keyframe[prop];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t// -----------------------------\r\n\t\t\t// The animation...\r\n\t\t\t// -----------------------------\r\n\t\t\ttry {\r\n\t\t\t\tvar anim = this.el.animate(keyframes, params);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tthis.$.error = e;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Reverse\r\n\t\t\tif (this.$.params.reverse) {\r\n\t\t\t\tanim.reverse();\r\n\t\t\t}\r\n\t\t\t// A little polifyll\r\n\t\t\tif (!anim.effect) {\r\n\t\t\t\tanim.effect = {};\r\n\t\t\t}\r\n\t\t\tif (!anim.effect.duration) {\r\n\t\t\t\tanim.effect.duration = this.$.params.duration;\r\n\t\t\t}\r\n\t\t\t// -----------------------------\r\n\t\t\t// \"onfinish\" and \"oncancel\" listener\r\n\t\t\t// -----------------------------\r\n\t\t\tanim.onfinish = () => {\r\n\t\t\t\t// As getter, as it were\r\n\t\t\t\tif (this.$.params.cancelForCss) {\r\n\t\t\t\t\tanim.cancel();\r\n\t\t\t\t\tif (this.$.params.fill === 'forwards' || this.$.params.fill === 'both') {\r\n\t\t\t\t\t\twriteSync.call(WQ.DOM, this.el, lastFrame);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.$.callFinish();\r\n\t\t\t};\r\n\t\t\t// oncancel listener\r\n\t\t\tanim.oncancel = () => this.$.callCancel();\r\n\t\t\t// -------------------\r\n\t\t\tthis.$.anim = anim;\r\n\t\t\tthis.$.firstFrame = firstFrame;\r\n\t\t\tthis.$.lastFrame = lastFrame;\r\n\t\t\tif (this.$.readyCallbacks.length) {\r\n\t\t\t\tthis.$.readyCallbacks.forEach(callback => callback(anim, this.$.params, firstFrame, lastFrame));\r\n\t\t\t}\r\n\t\t\t// -------------------\r\n\t\t};\r\n\t\tif (_isFunction(effect)) {\r\n\t\t\teffect(el, init);\r\n\t\t} else {\r\n\t\t\tAni.createCallback(el, effect, init, error => {\r\n\t\t\t\t// -------------------\r\n\t\t\t\tthis.$.error = error;\r\n\t\t\t\t// -------------------\r\n\t\t\t}, this.$.params.animNameNoCache);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Animation-ready callback.\r\n\t *\r\n\t * @param function\t\tsucces\r\n\t * @param function\t\terror\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tready(succes, error) {\r\n\t\tif (this.$.error) {\r\n\t\t\tif (error) {\r\n\t\t\t\terror(this.$.error);\r\n\t\t\t}\r\n\t\t} else if (this.$.anim) {\r\n\t\t\tsucces(this.$.anim, this.$.params, this.$.firstFrame, this.$.lastFrame);\r\n\t\t} else {\r\n\t\t\tthis.$.readyCallbacks.push(succes);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resolves the given effect into valid keyframes.\r\n\t *\r\n\t * Effect can be CSS animation name,\r\n\t * or an object of CSS properties that represent the end keyframe.\r\n\t *\r\n\t * @param Element\t\t\t\tel\r\n\t * @param array|object|string\teffect\r\n\t * @param function\t\t\t\tready\r\n\t * @param function\t\t\t\terror\r\n\t * @param bool\t\t\t\t\terror\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tstatic createCallback(el, effect, ready, error, animNameNoCache) {\r\n\t\t// -----------------------------\r\n\t\t// Resolve firstFrame from current state?\r\n\t\t// -----------------------------\r\n\t\tvar isObjectAndOnlyLastKeyframe = _isObject(effect) && !Object.values(effect).filter(v => _isArray(v)).length;\r\n\t\tvar isArrayButEmptyFirstKeyframe = _isArray(effect) && effect.length > 1 && _isEmpty(effect[0]);\r\n\t\tif (isObjectAndOnlyLastKeyframe || isArrayButEmptyFirstKeyframe) {\r\n\t\t\t// Get first keyframe from current state\r\n\t\t\tWQ.DOM.Reflow.onread(() => {\r\n\t\t\t\tif (isArrayButEmptyFirstKeyframe) {\r\n\t\t\t\t\teffect.shift();\r\n\t\t\t\t\tAni.createCallback(el, [readSync.call(WQ.DOM, el, Object.keys(effect[0])), ...effect], ready, error, animNameNoCache);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tAni.createCallback(el, [readSync.call(WQ.DOM, el, Object.keys(effect)), effect], ready, error, animNameNoCache);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// -----------------------------\r\n\t\t// Create keyframes from CSS animation name...\r\n\t\t// -----------------------------\r\n\t\tif (_isString(effect)) {\r\n\t\t\t// Retrieve keyframes of the given animation name from css\r\n\t\t\tif (!cssAnimNameCache[effect] || !cssAnimNameCache[effect].length || animNameNoCache) {\r\n\t\t\t\tcssAnimNameCache[effect] = readSyncKeyframes.call(WQ.DOM, effect);\r\n\t\t\t\tif (!cssAnimNameCache[effect].length && error) {\r\n\t\t\t\t\terror('Animation name \"' + effect + '\" not found in any stylesheet!');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\teffect = cssAnimNameCache[effect];\r\n\t\t}\r\n\t\t// -----------------------------\r\n\t\t// Resolve auto pixels...\r\n\t\t// -----------------------------\r\n\t\tif (_isArray(effect)) {\r\n\t\t\tvar keyframesWithAutoSizes = [];\r\n\t\t\t_each(effect, (i, keyframe) => {\r\n\t\t\t\t// We can animate to auto width and height\r\n\t\t\t\tif (keyframe.height === 'auto') {\r\n\t\t\t\t\t_pushUnique(keyframesWithAutoSizes, i);\r\n\t\t\t\t}\r\n\t\t\t\tif (keyframe.width === 'auto') {\r\n\t\t\t\t\t_pushUnique(keyframesWithAutoSizes, i);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (keyframesWithAutoSizes.length) {\r\n\t\t\t\t// apply() will be called when ready\r\n\t\t\t\t// We return readRendering(), which in itself returns the return of apply()\r\n\t\t\t\treadRendering.call(WQ.DOM, el, {width:'auto', height:'auto'}, el => el.getBoundingClientRect()).then(result => {\r\n\t\t\t\t\tkeyframesWithAutoSizes.forEach(i => {\r\n\t\t\t\t\t\tif (effect[i].width === 'auto') {\r\n\t\t\t\t\t\t\teffect[i].width = result.width + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (effect[i].height === 'auto') {\r\n\t\t\t\t\t\t\teffect[i].height = result.height + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tready(effect);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// -----------------------------\r\n\t\t// Return result...\r\n\t\t// -----------------------------\r\n\t\t// We return the return of success()\r\n\t\tready(effect);\r\n\t}\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport _remove from './remove.js';\r\n\r\n/**\r\n * Removes all instances of each item.\r\n *\r\n * @param array \tarr\r\n * @param array\t \titms\r\n *\r\n * @return array\r\n */\r\nexport default function(arr, ...itms) {\r\n\titms.forEach(itm => _remove(arr, itm));\r\n\treturn arr;\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport API from './API.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The Ani2 class\r\n * ---------------------------\r\n */\r\n\t\t\t\r\nexport default class Ani2 extends API {\r\n\t\r\n\t/**\r\n\t * Creates an amiation from\r\n\t * any of keyframes, CSS keyframe name, or CSS object.\r\n\t *\r\n\t * @param Element\t\t\t\tel\r\n\t * @param function\t\t\t\tcallback\r\n\t * @param object\t\t\t\tparams\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor(el, callback, params = {}) {\r\n\t\tsuper(el, callback, params);\r\n\t\tvar sym = Symbol.for('play-js-ani2');\r\n\t\t// -----------------------------\r\n\t\t// The state...\r\n\t\t// -----------------------------\r\n\t\tconst _this = this;\r\n\t\tthis.$.anim = {\r\n\t\t\tel,\r\n\t\t\ttiming: {\r\n\t\t\t\tcurrentTime: 0,\r\n\t\t\t\tdelay: _this.$.params.delay,\r\n\t\t\t\tduration: _this.$.params.duration,\r\n\t\t\t\tendDelay: _this.$.params.endDelay,\r\n\t\t\t\tcalculate() {\r\n\t\t\t\t\tvar active = this.state === 'playing' || this.state === 'paused';\r\n\t\t\t\t\tvar delay = active ? this.delay : _this.$.params.delay,\r\n\t\t\t\t\t\tduration = active ? this.duration : _this.$.params.duration,\r\n\t\t\t\t\t\tendDelay = active ? this.endDelay : _this.$.params.endDelay;\r\n\t\t\t\t\tvar currentDelay = delay,\r\n\t\t\t\t\t\ttotalDuration = currentDelay + duration,\r\n\t\t\t\t\t\ttotalTiming = totalDuration + endDelay;\r\n\t\t\t\t\tthis.delay = Math.max(0, Math.min(delay, this.currentTime >= currentDelay ? 0 : currentDelay - this.currentTime));\r\n\t\t\t\t\tthis.duration = Math.max(0, Math.min(duration, this.currentTime >= totalDuration ? 0 : totalDuration - this.currentTime));\r\n\t\t\t\t\tthis.endDelay = Math.max(0, Math.min(endDelay, this.currentTime >= totalTiming ? 0 : totalTiming - this.currentTime));\r\n\t\t\t\t},\r\n\t\t\t\tstart(callback) {\r\n\t\t\t\t\tif (_this.$.anim.el[sym]) {\r\n\t\t\t\t\t\t_this.$.anim.el[sym].finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_this.$.anim.el[sym] = _this.$.anim;\r\n\t\t\t\t\t// ---------------\r\n\t\t\t\t\tthis.state = 'playing';\r\n\t\t\t\t\tthis.calculate();\r\n\t\t\t\t\tif (!this.delay) {\r\n\t\t\t\t\t\tcallback(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.interval = setInterval(() => {\r\n\t\t\t\t\t\tthis.currentTime ++;\r\n\t\t\t\t\t\tif (this.currentTime === this.delay) {\r\n\t\t\t\t\t\t\tcallback(0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.currentTime === this.delay + this.duration) {\r\n\t\t\t\t\t\t\tcallback(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.currentTime === this.delay + this.duration + this.endDelay) {\r\n\t\t\t\t\t\t\tthis.state = 'finished';\r\n\t\t\t\t\t\t\tthis.stop();\r\n\t\t\t\t\t\t\tcallback(2);\r\n\t\t\t\t\t\t\tthis.currentTime = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1);\r\n\t\t\t\t},\r\n\t\t\t\tstop() {\r\n\t\t\t\t\t// Interval is cleared at the entire end\r\n\t\t\t\t\t// duration: delay + duration + endDelay\r\n\t\t\t\t\tclearInterval(this.interval);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tset currentTime(currentTime) {\r\n\t\t\t\tthis.timing.currentTime = currentTime;\r\n\t\t\t\tif (this.timing.state === 'playing') {\r\n\t\t\t\t\tthis.timing.stop();\r\n\t\t\t\t\tthis.play();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tget currentTime() {\r\n\t\t\t\treturn this.timing.currentTime;\r\n\t\t\t},\r\n\r\n\t\t\t_callBegin() {\r\n\t\t\t\treturn callback(this.el, 'begin', this.reversed, this.currentTime);\r\n\t\t\t},\r\n\r\n\t\t\t_callPause() {\r\n\t\t\t\treturn callback(this.el, 'pause', this.reversed, this.currentTime);\r\n\t\t\t},\r\n\r\n\t\t\t_callEnd() {\r\n\t\t\t\treturn callback(this.el, 'end', this.reversed, this.currentTime);\r\n\t\t\t},\r\n\r\n\t\t\tplay() {\r\n\t\t\t\tthis.timing.start(phase => {\r\n\t\t\t\t\tif (phase === 0) {\r\n\t\t\t\t\t\tthis._callBegin();\r\n\t\t\t\t\t} else if (phase === 1) {\r\n\t\t\t\t\t\tthis._callEnd();\r\n\t\t\t\t\t} else if (phase === 2) {\r\n\t\t\t\t\t\t_this.$.callFinish();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\treverse() {\r\n\t\t\t\tthis.reversed = !this.reversed;\r\n\t\t\t\tif (this.timing.state === 'playing') {\r\n\t\t\t\t\tthis.timing.stop();\r\n\t\t\t\t\tthis.play();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tpause() {\r\n\t\t\t\t// Is pause supported by handler?\r\n\t\t\t\tif (this._callPause() !== false) {\r\n\t\t\t\t\tthis.timing.state = 'paused';\r\n\t\t\t\t\tthis.timing.stop();\r\n\t\t\t\t}\r\n\t\t\t},\t\t\t\r\n\r\n\t\t\tfinish() {\r\n\t\t\t\tthis.timing.state = 'finished';\r\n\t\t\t\tthis.timing.stop();\r\n\t\t\t\tthis._callEnd();\r\n\t\t\t\t_this.$.callFinish();\r\n\t\t\t},\r\n\r\n\t\t\tcancel() {\r\n\t\t\t\tthis.timing.state = 'cancelled';\r\n\t\t\t\tthis.timing.stop();\r\n\t\t\t\t_this.$.callCancel();\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\t// A little polifyll\r\n\t\tif (!this.$.anim.effect) {\r\n\t\t\tthis.$.anim.effect = {};\r\n\t\t}\r\n\t\tif (!this.$.anim.effect.duration) {\r\n\t\t\tthis.$.anim.effect.duration = this.$.params.delay + this.$.params.duration + this.$.params.endDelay;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Animation-ready callback.\r\n\t *\r\n\t * @param function\t\tsucces\r\n\t * @param function\t\terror\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tready(succes, error) {\r\n\t\tsucces(this.$.anim, this.$.params);\r\n\t}\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport _arrFrom from '@webqit/util/arr/from.js';\r\nimport _arrLast from '@webqit/util/arr/last.js';\r\nimport _merge from '@webqit/util/obj/merge.js';\r\nimport _isNumber from '@webqit/util/js/isNumber.js';\r\nimport _isEmpty from '@webqit/util/js/isEmpty.js';\r\nimport Timeline from './Timeline.js';\r\nimport Ani from './Ani.js';\r\nimport Ani2 from './Ani2.js';\r\n\r\n/**\r\n * ---------------------------\r\n * A base class for Observer implementations.\r\n * ---------------------------\r\n */\r\n\r\nexport default class {\r\n\t\r\n\t/**\r\n\t * Accepts elements (targets) and options for,\r\n\t * and creates the, Observer instance.\r\n\t *\r\n\t * @param array     \tentries\r\n\t * @param object \t\toptions\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tconstructor(entries = [], params = {}) {\r\n\t\tthis.$ = {};\r\n        this.$.entries = [];\r\n        this.$.params = params;\r\n        this.nowPlaying = new Timeline;\r\n        // -------------------\r\n        entries.forEach(el => {\r\n            this.add(el, params.timing);\r\n        });\r\n        this.queue = [];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Adda a new entry to the timeline.\r\n\t * Optionally accepts a timing for the specific entry.\r\n\t *\r\n\t * @param HTMLElement \t    el\r\n\t * @param pbject        \teffect\r\n\t * @param pbject \t        params\r\n\t * @param function        \tonfinish\r\n\t * @param function        \toncancel\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tadd(el, effect = {}, params = {}, onfinish = null, oncancel = null) {\r\n        if (!this.$.entries.filter(entry => entry.el === el).length) {\r\n            var entry = {el, effect, params, onfinish, oncancel};\r\n            this.$.entries.push(entry);\r\n            this.nowPlayingAdd(entry);\r\n        }\r\n    }\t\r\n\t\r\n\t/**\r\n\t * Removes an entry from the timeline.\r\n\t *\r\n\t * @param HTMLElement \t    el\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tremove(el) {\r\n        this.$.entries = this.$.entries.filter(entry => entry.el !== el);\r\n    }\r\n\r\n\t/**\r\n\t * Adda a qualified entry to the nowPlaying.\r\n\t *\r\n\t * @param object \t     entry\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tnowPlayingAdd(entry) {\r\n        if (!this.nowPlayingEffect) {\r\n            return;\r\n        }\r\n        // ---------------------------------\r\n        var createAnimation = (nowPlaying, entry, effect, params) => {\r\n            var _ani = _isFunction(effect) ? Ani2 : Ani;\r\n            var animation = new _ani(entry.el, effect, params);\r\n            nowPlaying.add(animation);\r\n            if (params.oneoff) {\r\n                animation.onfinish(() => {\r\n                    nowPlaying.remove(animation);\r\n                    this.remove(entry.el);\r\n                });\r\n            }\r\n            if (entry.onfinish) {\r\n                animation.onfinish(entry.onfinish);\r\n                \r\n            }\r\n            if (entry.oncancel) {\r\n                animation.oncancel(entry.oncancel);\r\n            }\r\n        };\r\n        // ---------------------------------\r\n        var compute = (nowPlaying, queue) => {\r\n            var entry = queue[0];\r\n            var effect = !_isEmpty(entry.effect) ? entry.effect : this.nowPlayingEffect;\r\n            var params = _merge({}, this.nowPlayingParams, entry.params);\r\n            params.delay = (params.delay || 0);\r\n            if (_isNumber(params.lag) || _isNumber(params.endLag)) {\r\n                var lastAni = _arrLast(nowPlaying.$.animations);\r\n                if (lastAni) {\r\n                    lastAni.ready((anim, _params) => {\r\n                        if (_isNumber(params.lag)) {\r\n                            params.delay += _params.delay + params.lag;\r\n                        } else {\r\n                            params.delay += _params.delay + parseFloat(_params.endDelay) + _params.duration + params.endLag;\r\n                        }\r\n                        params.delay -= _isNumber(anim.currentTime) ? anim.currentTime : 0;\r\n                        createAnimation(nowPlaying, entry, effect, params);\r\n                        // ----------------\r\n                        queue.shift();\r\n                        if (queue.length) {\r\n                            compute(nowPlaying, queue);\r\n                        }\r\n                    });\r\n                    return;\r\n                }\r\n            }\r\n            createAnimation(nowPlaying, entry, effect, params);\r\n            // ----------------\r\n            queue.shift();\r\n            if (queue.length) {\r\n                compute(nowPlaying, queue);\r\n            }\r\n        };\r\n        this.queue.push(entry);\r\n        if (this.queue.length === 1) {\r\n            compute(this.nowPlaying, this.queue);\r\n        }\r\n\t}\r\n\t\r\n\t/**\r\n\t * Plays an effect.\r\n\t *\r\n\t * @param object|array  effect\r\n\t * @param object\t\tparams\r\n\t *\r\n\t * @return Promise\r\n\t */\r\n\tplay(effect = {}, params = {}) {\r\n        // Ongoing animation?\r\n        // Clear only on subsequent call to this method\r\n        if (this.nowPlayingEffect) {\r\n            this.nowPlaying = new Timeline;\r\n            this.queue = [];\r\n       }\r\n        this.nowPlayingEffect = effect;\r\n        this.nowPlayingParams = params;\r\n        // Create new playlist\r\n        var entries = params.reverseList ? this.$.entries.slice().reverse() : this.$.entries;\r\n        entries.forEach(entry => {\r\n            if ((!params.except || !_arrFrom(params.except, false/*castObject*/).includes(entry.el))\r\n            && (!params.only || _arrFrom(params.only, false/*castObject*/).includes(entry.el))) {\r\n                this.nowPlayingAdd(entry);\r\n            }\r\n        });\r\n        return this.nowPlaying.play();\r\n    }\r\n\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _first from './first.js';\r\n\r\n/**\r\n * Returns THE LAST ENTRY OR A NUMBER OF ENTRIES counting forward to the end.\r\n *\r\n * @param array \tarr\r\n * @param int\t \tamount\r\n *\r\n * @return mixed|array\r\n */\r\nexport default function(arr, amount = 1) {\r\n\treturn arguments.length > 1\r\n\t\t? _first(arr.slice().reverse(), amount).reverse()\r\n\t\t: _first(arr.slice().reverse());\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport _isFunction from '@webqit/util/js/isFunction.js';\r\nimport Ani from './Ani.js';\r\nimport Ani2 from './Ani2.js';\r\n\r\n/**\r\n * Creates and plays an amiation.\r\n * @see Ani\r\n *\r\n * @param Element|Any\t\t\tparams\r\n * @param array|object|string\teffect\r\n * @param object\t\t\t\tparams\r\n *\r\n * @return Promise\r\n */\r\nexport default function play(el, effect, params = {}) {\r\n\tif (!('cancelForCss' in params)) {\r\n\t\tparams.cancelForCss = true;\r\n\t}\r\n\tvar _ani = _isFunction(effect) ? Ani2 : Ani;\r\n\treturn (new _ani(el, effect, params)).play().then(() => el);\r\n};","\r\n/**\r\n * @imports\r\n */\r\nimport Sequence from '@webqit/play-js/src/animation/Sequence.js';\r\nimport play from '@webqit/play-js/src/animation/play.js';\r\n\r\n\r\n/**\r\n * ---------------------------\r\n * Class definitions\r\n * ---------------------------\r\n */\r\nexport default function(window) {\r\n\r\n    /**\r\n     * @list\r\n    */\r\n    const ul = class extends window.HTMLUListElement {\r\n        \r\n        /**\r\n         * Establish a common Timeline.\r\n         *\r\n         * @return void\r\n         */\r\n        connectedCallback() {\r\n            this._params = getAnimParams(this);\r\n            // ----------------\r\n            if (this._params.animIn) {\r\n                this._sequenceA = new Sequence;\r\n                this._sequenceA.play(this._params.animIn, this._params);\r\n            }\r\n            // -----------------\r\n            if (this._params.animInAlt) {\r\n                this._sequenceB = new Sequence;\r\n                this._sequenceB.play(this._params.animInAlt, this._params);\r\n            }\r\n            // --------------\r\n        }\r\n\r\n        /**\r\n         * Adds an element to the sequence.\r\n         *\r\n         * @param HTMLElement el\r\n         *\r\n         * @return void\r\n         */\r\n        sequenceAdd(el) {\r\n            Observe(el, this._params.rootMargin, entry => {\r\n                if (entry.isIntersecting) {\r\n                    if (entry.boundingClientRect.top < 0) {\r\n                        if (this._params.animInAlt) {\r\n                            // Top-to-bottom motion\r\n                            this._sequenceB.add(entry.target);\r\n                        }\r\n                    } else if (this._params.animIn) {\r\n                        // Bottom-to-top motion\r\n                        this._sequenceA.add(entry.target);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * @list-item\r\n    */\r\n    const li = class extends window.HTMLLIElement {\r\n\t\t\r\n\t\t/**\r\n\t\t * This triggers self-replacement\r\n\t\t * when so defined.\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tconnectedCallback() {\r\n\t\t\tif (this.parentNode.sequenceAdd) {\r\n\t\t\t\tthis.parentNode.sequenceAdd(this);\r\n            }\r\n\t\t}\r\n\r\n    };\r\n\r\n    /**\r\n     * @list-item\r\n    */\r\n   const div = class extends window.HTMLDivElement {\r\n        \r\n        /**\r\n         * Establish a common Timeline.\r\n         *\r\n         * @return void\r\n         */\r\n        connectedCallback() {\r\n            var params = getAnimParams(this);\r\n            // --------------\r\n            var animatingA, animatingB;\r\n            Observe(this, params.rootMargin, entry => {\r\n                if (entry.isIntersecting) {\r\n                    if (entry.boundingClientRect.top < 0) {\r\n                        if (params.animInAlt && !animatingB) {\r\n                            animatingB = true;\r\n                            // Top-to-bottom motion\r\n                            play(entry.target, params.animInAlt, params).then(() => {\r\n                                animatingB = false;\r\n                            });\r\n                        }\r\n                    } else if (params.animIn && !animatingA) {\r\n                        animatingA = true;\r\n                        // Bottom-to-top motion\r\n                        play(entry.target, params.animIn, params).then(() => {\r\n                            animatingA = false;\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        \r\n    };\r\n\r\n    return {\r\n        ul,\r\n        li,\r\n        div,\r\n    }\r\n};\r\n\r\nconst Observers = new Map();\r\nconst Observe = (el, rootMargin, callback) => {\r\n    if (!Observers.has(rootMargin)) {\r\n        const callbacks = new Map();\r\n        Observers.set(rootMargin, {\r\n            o: new window.IntersectionObserver(entries => {\r\n                entries.forEach(entry => {\r\n                    callbacks.get(entry.target)(entry);\r\n                });\r\n            }, {rootMargin}), \r\n            c: callbacks,\r\n        });\r\n    }\r\n    var obs = Observers.get(rootMargin);\r\n    obs.c.set(el, callback);\r\n    obs.o.observe(el);\r\n};\r\n\r\nconst getAnimParams = el => {\r\n    return (el.getAttribute('play-seq') || '').split(';').reduce((p, prop) => {\r\n        var [ name, value ] = prop.split(':').map(s => s.trim());\r\n        p[name] = ['duration', 'lag', 'oneoff'].includes(name) ? parseInt(value) : value;\r\n        return p;\r\n    }, {\r\n        lag: 100,\r\n        rootMargin: '0px',\r\n        duration: 200,\r\n        animIn: '',\r\n        animInAlt: '',\r\n        oneoff: true,\r\n        fill: 'forwards',\r\n        easing: 'ease-out',\r\n    });\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport dfn from './dfn.js';\r\n\r\n/**\r\n * @definitions\r\n */\r\nexport default function(window) {\r\n\r\n\tconst { ul, li, div } = dfn(window);\r\n\t\r\n\twindow.customElements.define('play-seq-ul', ul, {extends: 'ul'});\r\n\twindow.customElements.define('play-seq-li', li, {extends: 'li'});\r\n\twindow.customElements.define('play-seq-div', div, {extends: 'div'});\r\n};\r\n","\r\n/**\r\n * @imports\r\n */\r\nimport init from './index.js';\r\n\r\n/**\r\n * @init\r\n */\r\ninit(window);"],"sourceRoot":""}