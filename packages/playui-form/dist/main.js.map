{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@webqit/util/js/isObject.js","webpack:///./node_modules/@webqit/util/js/getType.js","webpack:///./node_modules/@webqit/util/js/internals.js","webpack:///./node_modules/@webqit/util/js/isArray.js","webpack:///./node_modules/@webqit/util/js/isBoolean.js","webpack:///./node_modules/@webqit/util/js/isTypeFunction.js","webpack:///./node_modules/@webqit/util/js/isNull.js","webpack:///./node_modules/@webqit/util/js/isUndefined.js","webpack:///./node_modules/@webqit/util/js/isTypeObject.js","webpack:///./node_modules/@webqit/util/js/isEmpty.js","webpack:///./node_modules/@webqit/util/js/isFunction.js","webpack:///./node_modules/@webqit/util/js/isNumber.js","webpack:///./node_modules/@webqit/util/js/isNumeric.js","webpack:///./node_modules/@webqit/util/js/isString.js","webpack:///./node_modules/@webqit/util/arr/first.js","webpack:///./node_modules/@webqit/util/arr/last.js","webpack:///./node_modules/@webqit/util/arr/pushUnique.js","webpack:///./node_modules/@webqit/util/obj/getAllPropertyNames.js","webpack:///./node_modules/@webqit/util/obj/getPrototypeChain.js","webpack:///./node_modules/@webqit/util/obj/mergeCallback.js","webpack:///./node_modules/@webqit/util/obj/each.js","webpack:///./node_modules/@webqit/util/js/mixin.js","webpack:///./node_modules/@webqit/util/obj/merge.js","webpack:///./node_modules/@webqit/util/arr/indexOfSet.js","webpack:///./node_modules/@webqit/util/arr/after.js","webpack:///./node_modules/@webqit/util/arr/following.js","webpack:///./node_modules/@webqit/util/arr/from.js","webpack:///./node_modules/@webqit/util/js/isTypeArray.js","webpack:///./node_modules/@webqit/util/arr/difference.js","webpack:///./node_modules/@webqit/util/arr/equals.js","webpack:///./node_modules/@webqit/util/arr/flatten.js","webpack:///./node_modules/@webqit/util/arr/intersect.js","webpack:///./node_modules/@webqit/util/arr/startsWith.js","webpack:///./node_modules/@webqit/util/arr/unique.js","webpack:///./node_modules/@webqit/observer/src/core/utils.js","webpack:///./node_modules/@webqit/observer/src/core/Firebase.js","webpack:///./node_modules/@webqit/observer/src/core/Fireable.js","webpack:///./node_modules/@webqit/observer/src/core/Interceptor.js","webpack:///./node_modules/@webqit/observer/src/core/Action.js","webpack:///./node_modules/@webqit/observer/src/core/Interceptors.js","webpack:///./node_modules/@webqit/observer/src/actors/unproxy.js","webpack:///./node_modules/@webqit/observer/src/actions/_exec.js","webpack:///./node_modules/@webqit/observer/src/actions/apply.js","webpack:///./node_modules/@webqit/observer/src/actions/construct.js","webpack:///./node_modules/@webqit/util/str/toTitle.js","webpack:///./node_modules/@webqit/observer/src/core/Event.js","webpack:///./node_modules/@webqit/observer/src/core/Observer.js","webpack:///./node_modules/@webqit/util/arr/any.js","webpack:///./node_modules/@webqit/observer/src/core/Mutation.js","webpack:///./node_modules/@webqit/observer/src/core/Observers.js","webpack:///./node_modules/@webqit/observer/src/actions/get.js","webpack:///./node_modules/@webqit/observer/src/reactions/observe.js","webpack:///./node_modules/@webqit/observer/src/connectors/link.js","webpack:///./node_modules/@webqit/observer/src/connectors/build.js","webpack:///./node_modules/@webqit/observer/src/reactions/unobserve.js","webpack:///./node_modules/@webqit/observer/src/connectors/unlink.js","webpack:///./node_modules/@webqit/observer/src/actions/has.js","webpack:///./node_modules/@webqit/observer/src/actions/_setOrDefine.js","webpack:///./node_modules/@webqit/observer/src/actions/defineProperty.js","webpack:///./node_modules/@webqit/observer/src/actions/deleteProperty.js","webpack:///./node_modules/@webqit/observer/src/actions/getOwnPropertyDescriptor.js","webpack:///./node_modules/@webqit/observer/src/actions/getPrototypeOf.js","webpack:///./node_modules/@webqit/observer/src/actions/isExtensible.js","webpack:///./node_modules/@webqit/observer/src/actions/ownKeys.js","webpack:///./node_modules/@webqit/observer/src/actions/preventExtensions.js","webpack:///./node_modules/@webqit/observer/src/actions/set.js","webpack:///./node_modules/@webqit/observer/src/actions/setPrototypeOf.js","webpack:///./node_modules/@webqit/observer/src/index.js","webpack:///./node_modules/@webqit/observer/src/actors/proxy.js","webpack:///./node_modules/@webqit/util/js/isClass.js","webpack:///./src/utils/util.js","webpack:///./src/schema-mixins.js","webpack:///./src/playui-mixins.js","webpack:///./src/playui-element-mixins.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Array","isArray","val","internals","obj","namespaces","globalThis","WebQitInternalsRegistry","Map","_ns","_itnls","itnls","set","shift","arguments","length","undefined","keys","toString","Number","isNaN","String","count","arr","forEach","itm","firsts","slice","amount","reverse","items","indexOf","push","keysAll","until","prototypalChain","getPrototypeOf","getOwnPropertyNames","mergeCallback","objs","callback","deepProps","isReplace","withSymbols","depth","obj1","Error","obj2","valAtObj1","valAtObj2","getOwnPropertyDescriptor","e","returnValue","k","parseFloat","indexOfSet","a","b","fromInex","last","reduce","cursors","index","cursorA","cursorB","_cursorB","_cursors","concat","subsetIndex","castObject","values","arr2","filter","val1","val2","equals","dotSafe","join","prev","startsWith","self","paths2D","paths","pathsIs2D","multiple","path","map","DotSafePath","resolve","every","v","includes","yes","pathsIsDynamic","pathArray","seg","target","this","fireables","currentlyFiring","fireable","_fireable","dfn","match","fireableFilter","fireableTags","params","tags","dfnFilter","dfnTags","originalHandler","handler","type","createIfNotExists","namespace","__namespace","ImplementationClass","WebQitObserverNamespaceRegistry","has","Fireable","disconnected","event","next","recieved","seal","super","add","action","defaultHandler","_args","interceptor","fire","args","pop","_getFirebase","_namespace","interceptors","_val","Reflect","payload","getFirebase","_exec","thisArgument","argumentsList","newTarget","str","replace","txt","charAt","toUpperCase","strict","substr","toLowerCase","cancellable","_","propagationStopped","defaultPrevented","promisesInstance","promises","promise","Promise","all","rspns","proms","isEvent","stopPropagation","preventDefault","waitUntil","filters2D","filtersIsOriginally2D","filtersIsDynamic","changes","delta","prevTest","diff","oldValue","evt","matches","observerPathArray","observerPathArray_Resolved","_seg","subtree","suptree","changesObject","respondWith","originalSubject","buffers","observer","receiver","_keys","defaultGet","_value","touch","related","existing","observers","isUserObject","build","unique","remove","observe","eventObject","_changes","src","field","linkTag","_event","eventTypeReturn","_paths2D","rootLevelKeysToObserve","subLevelKeysToObserve","subBuild","_isFunction","Function","window","removeMatches","unobserve","keysOrPayload","handleSet","detail","descriptor","define","isUpdate","defaultSet","_success","restore","success","unlink","events","successfulEvents","successCount","_setOrDefine","defaultDel","proxy","Proxy","apply","construct","propertyKey","attributes","deleteProperty","proxyAutoBinding","test","isExtensible","ownKeys","preventExtensions","setPrototypeOf","_isTextMediaType","contentMediaType","_Schema","__Schema","jsonSchema","instance","validate","valid","_ObjectOrArray","__ObjectOrArray","validity","_validateMin","_validateMax","error","violation","_Object","__Object","instanceHint","propertyNameSchema","propertyNames","additionalProperties","isRequired","propertyName","propertySchema","properties","_patternPropertiesMatch","required","instanceProperties","requiringProp","dependentRequired","masterHint","master","patternProperties","pattern","RegExp","_validateRequired","_validateDependentRequired","maxProperties","minProperties","_Array","__Array","itemIndex","itemSchema","prefixItems","_validateUnique","_validateContains","min","max","desc","maxItems","minItems","uniqueItems","contains","passes","item","__validateContains","minContains","maxContains","_String","__String","_Num","__Num","_Number","__Number","_Integer","__Integer","isInteger","_Boolean","__Boolean","_Null","__Null","_Root","__Root","pair","schema","parentWidget","attrs","title","replaceAll","const","default","readOnly","readonly","_ParentRoot","__ParentRoot","childSchema","childWidget","removeCallback","_Collection","__Collection","setSchema","getPropertySchema","addResolvedEntry","renderChildWidget","deriveChildWidget","entries","console","warn","promptPropertyName","getPropertyNameSchema","json","_propertyName","extend","data","_data","_Multiple","__Multiple","getItemSchema","autoExtend","entry","_Multiple2","__Multiple2","testSchema","enum","widgetLineContentLengthLimit","lineContentLengthLimit","some","Math","minLength","maxLength","_Enum","__Enum","schemaName","constructor","getSchemaName","label","enumNames","selected","itemData","itemWidget","renderItemWidget","deriveItemWidget","enumItem","_Enum2","__Enum2","_File","__File","_isFileSchema","_jsonSchema","format","contentEncoding","schemaType","$schema","previewItem","_Input","__Input","examples","placeholder","_Editor","__Editor","_Text","__Text","maxlength","minlength","col","parseInt","exclusiveMaximum","maximum","exclusiveMinimum","minimum","multipleOf","step","_State","__State","checked","HTMLElement","$","html","class","template","hasAttribute","customElements","getAttribute","localName","disconnectedCallback","cloneNode","content","append","_MultipleRoot","__MultipleRoot","input","attr","_EnumRoot","__EnumRoot","HTMLSelectElement","document","createElement","enumWidget","options","setAttribute","selectedOptions","_isArray","from","option","parentwidget","_dataTransfer","DataTransfer","filesList","mutations","previewElement","addEventListener","dropArea","addFiles","files","_handlerDrag","state","dragging","dataTransfer","connectedCallback","eventName","removeEventListener","isDirectSelection","filesListAdd","file","splice","renderPreviewElement","derivePreviewElement","clear","size","revokeURL","el","URL","revokeObjectURL","img","onload","createObjectURL","mime","media","onloadstart","play","muted","classList","previewData","derivePreview","preview","FormWidget","WebQit","SubscriptElement","HTMLFormElement","CollectionWidget","HTMLFieldSetElement","MultipleWidget","Multiple2Widget","EnumWidget","HTMLLabelElement","Enum2Widget","FileWidget","EditorWidget","TextWidget","NumberWidget","StateWidget","extends"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\n/**\n * Tells if val is pure object.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\n};\n","\n/**\n * Returns the val's type.\n *\n * @param string \tval\n *\n * @return string\n */\nexport default function(val) {\n\treturn typeof val;\n};\n","\n/**\n * Creates and/or returns an \"internals\" object for the given object.\n * \n * @param Any obj\n * @param String namespace\n * \n * @return Object\n */\nexport default function internals(obj, ...namespaces) {\n    if (!globalThis.WebQitInternalsRegistry) {\n        globalThis.WebQitInternalsRegistry = new Map;\n    }\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\n    if (!itnls) {\n        itnls = new Map;\n        if (namespaces[0] === false) {\n            // FALSE means: Return orphan Map if not exists\n            return itnls;\n        }\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\n    }\n    var _ns, _itnls;\n    while ((_ns = namespaces.shift())) {\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\n            itnls = new Map;\n            if (namespaces[0] === false) {\n                // FALSE means: Return orphan Map if not exists\n                return itnls;\n            }\n            _itnls.set(_ns, itnls);\n        }\n    }\n    return itnls;\n}","\n/**\n * Tells if val is of type \"array\".\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val);\n};\n","\n/**\n * Tells if val is undefined or is of type \"boolean\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === true || val === false;\n};\n","\n/**\n * Tells if val is of type \"function\".\n * This holds true for both regular functions and classes.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn typeof val === 'function';\n};\n","\n/**\n * Tells if val is undefined or is null.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === null || val === '';\n};\n","\n/**\n * Tells if val is undefined or is of type \"undefined\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\n};\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"object\".\n * This holds true for anything object, including built-ins.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\n};\n","\n/**\n * @imports\n */\nimport _isNull from './isNull.js';\nimport _isUndefined from './isUndefined.js';\nimport _isTypeObject from './isTypeObject.js';\n\n/**\n * Tells if val is empty in its own type.\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\n * objects without keys, empty arrays.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\n};\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"function\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\n};\n","\n/**\n * Tells if val is of type \"number\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof Number || (typeof val === 'number');\n};\n","\n/**\n * @imports\n */\nimport _isNumber from './isNumber.js';\n/**\n * Tells if val is of type \"string\" or a numeric string.\n * This holds true for both numbers and numeric strings.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\n};\n","\n/**\n * Tells if val is of type \"string\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\n};\n","\n/**\n * Returns THE FIRST ENTRY OR A NUMBER OF ENTRIES counting forward from the begining.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\tvar count = 0;\n\tarr.forEach(itm => {\n\t\tcount ++;\n\t});\n\tvar firsts = arr.slice(arr.length - count, amount);\n\treturn arguments.length > 1 ? firsts : firsts[0];\n};\n","\n/**\n * @imports\n */\nimport _first from './first.js';\n\n/**\n * Returns THE LAST ENTRY OR A NUMBER OF ENTRIES counting forward to the end.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\treturn arguments.length > 1\n\t\t? _first(arr.slice().reverse(), amount).reverse()\n\t\t: _first(arr.slice().reverse());\n};\n","\n/**\n * Adds an item if not already exist.\n *\n * @param array \tarr\n * @param array\t \t...itms\n *\n * @return array\n */\nexport default function(arr, ...items) {\n\titems.forEach(itm => {\n\t\tif (arr.indexOf(itm) < 0) {\n\t\t\tarr.push(itm);\n\t\t}\n\t});\n\treturn arr;\n};\n","\n/**\n * @imports\n */\nimport _pushUnique from '../arr/pushUnique.js';\nimport _getPrototypeChain from './getPrototypeChain.js';\n\n/**\n * Eagerly retrieves object members all down the prototype chain.\n *\n * @param object\t \tobj\n * @param object\t \tuntil\n *\n * @return array\n */\nexport default function(obj, until) {\n\tvar keysAll = [];\n\t_getPrototypeChain(obj, until).forEach(obj => {\n\t\t_pushUnique(keysAll, ...Object.getOwnPropertyNames(obj));\n\t});\n\treturn keysAll;\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the prototype chain.\n *\n * @param object \t\tobj\n * @param object\t \tuntil\n *\n * @return bool\n */\nexport default function(obj, until) {\n\tuntil = until || Object.prototype;\n\tuntil = until && !_isArray(until) ? [until] : until;\n\t// We get the chain of inheritance\n\tvar prototypalChain = [];\n\tvar obj = obj;\n\twhile((obj && (!until || until.indexOf(obj) < 0) && obj.name !== 'default')) {\n\t\tprototypalChain.push(obj);\n\t\tobj = obj ? Object.getPrototypeOf(obj) : null;\n\t}\n\treturn prototypalChain;\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isObject from '../js/isObject.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _getAllPropertyNames from './getAllPropertyNames.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function mergeCallback(objs, callback, deepProps = false, isReplace = false, withSymbols = false) {\n\tvar depth = 0;\n\tvar obj1 = objs.shift();\n\tif (_isNumeric(obj1) || obj1 === true || obj1 === false) {\n\t\tdepth = obj1;\n\t\tobj1 = objs.shift();\n\t}\n\tif (!objs.length) {\n\t\tthrow new Error('_merge() requires two or more array/objects.');\n\t}\n\tobjs.forEach((obj2, i) => {\n\t\tif (!_isTypeObject(obj2) && !_isFunction(obj2)) {\n\t\t\treturn;\n\t\t}\n\t\t(deepProps ? _getAllPropertyNames(obj2) : Object.getOwnPropertyNames(obj2)).forEach(key => {\n\t\t\tif (!callback(key, obj1, obj2, i)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar valAtObj1 = obj1[key];\n\t\t\tvar valAtObj2 = obj2[key];\n\t\t\tif (((_isArray(valAtObj1) && _isArray(valAtObj2)) || (_isObject(valAtObj1) && _isObject(valAtObj2))) \n\t\t\t&& (depth === true || depth > 0)) {\n\t\t\t\t// RECURSE...\n\t\t\t\tobj1[key] = _isArray(valAtObj1) && _isArray(valAtObj2) ? [] : {};\n\t\t\t\tmergeCallback([_isNumeric(depth) ? depth - 1 : depth, obj1[key], valAtObj1, valAtObj2], callback, deepProps, isReplace, withSymbols);\n\t\t\t} else {\n\t\t\t\tif (_isArray(obj1) && _isArray(obj2)) {\n\t\t\t\t\tif (isReplace) {\n\t\t\t\t\t\tobj1[key] = valAtObj2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj1.push(valAtObj2);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// In case we're setting a read-only property\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (withSymbols) {\n\t\t\t\t\t\t\tObject.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj2, key));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj1[key] = obj2[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\treturn obj1;\n};\n","\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\n\n/**\n * Loops thru obj flatly with a callback function.\n * Stops when callback returns a non-undefined value.\n *\n * @param array|object \t\t\tobj \t\t\tThe array or object to iterate.\n * @param function \t\t\t\tcallback \t\tThe callback function.\n *\n * @return mixed|null\t\t\tAny non-null return from callback\n */\nexport default function(obj, callback) {\n\tvar returnValue = undefined;\n\tif (_isTypeObject(obj)) {\n\t\tObject.keys(obj).forEach((k, i) => {\n\t\t\tif (returnValue !== false) {\n\t\t\t\treturnValue = callback(_isNumeric(k) ? parseFloat(k) : k, obj[k], i);\n\t\t\t}\n\t\t});\n\t}\n\treturn returnValue;\n};\n","\n/**\n * @imports\n */\nimport _isArray from './isArray.js';\nimport _isFunction from './isFunction.js';\nimport _arrLast from '../arr/last.js';\nimport _mergeCallback from '../obj/mergeCallback.js';\nimport _each from '../obj/each.js';\n\n/**\n * A multi-inheritance implementstion.\n *\n * @param array\t \t...classes\n *\n * @return object\n */\nconst Implementations = new Map;\nexport default function mixin(...classes) {\n\t\n\tvar Traps = {};\n\tvar RetrnDirective = 'last';\n\tif (_isArray(arguments[0])) {\n\t\tclasses = arguments[0];\n\t\tTraps = arguments[1];\n\t\tif (arguments[2]) {\n\t\t\tRetrnDirective = arguments[2];\n\t\t}\n\t}\n\t// -----------------------\n\tvar Base = _arrLast(classes);\n\tvar supersMap = {};\n\t// -----------------------\n\t// Create the Mixin\n\t// ...with a special constructor.\n\t// -----------------------\n\tvar Mixin = class {\n\t\tconstructor(...args) {\n\t\t\tclasses.forEach((_class, i) => {\n\t\t\t\tReflect.construct(_class, args, this.constructor);\n\t\t\t});\n\t\t}\n\t};\n\t// -----------------------\n\t// Implement a special handler of the \"instanceof\" operator.\n\t// -----------------------\n\tclasses.forEach((_class, i) => {\n\t\tif (!Implementations.has(_class)) {\n\t\t\tImplementations.set(_class, []);\n\t\t\ttry {\n\t\t\t\tvar originalInstanceChecker = _class[Symbol.hasInstance];\n\t\t\t\tObject.defineProperty(_class, Symbol.hasInstance, {value: function(instance) {\n\t\t\t\t\tif (originalInstanceChecker.call(this, instance)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif (Implementations.has(this)) {\n\t\t\t\t\t\treturn Implementations.get(this).reduce((yes, _mixin) => yes || (instance instanceof _mixin), false);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}});\n\t\t\t} catch (e) {\n\t\t\t\tthrow new Error('Cannot mixin the class at index ' + i + '. Class may already have been configured for instance checks somewhere.');\n\t\t\t}\n\t\t}\n\t\tImplementations.get(_class).push(Mixin);\n\t});\n\t// ---------------------\n\t// Mixin both static and instance properties and methods\n\t// ---------------------\n\tclasses.forEach(_class => {\n\t\t// Copy const members\n\t\t_mergeCallback([Mixin, _class], (key, obj1, obj2) => ![\n\t\t\t'name', 'prototype', 'prototypes', 'length', 'caller', 'callee', 'arguments', 'constructor', 'apply', \"bind\", 'call', 'toString',/**/\n\t\t].includes(key), true/*deepProps*/);\n\t\t_mergeCallback([Mixin.prototype, _class.prototype], (key, obj1, obj2) => {\n\t\t\tif (!['prototype', 'prototypes'].includes(key)) {\n\t\t\t\tif (_isFunction(obj2[key])) {\n\t\t\t\t\tif (_isArray(supersMap[key])) {\n\t\t\t\t\t\tsupersMap[key].push(obj2[key]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsupersMap[key] = [obj2[key]];\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}, true/*deepProps*/);\n\t});\n\t// Extend (proxy) methods\n\t_each(supersMap, (name, supers) => {\n\t\tif (name === 'constructor') {\n\t\t\treturn;\n\t\t}\n\t\t// NOTE: this must not be defined as an arrow function\n\t\t// for the benefit of the \"this\".\n\t\tMixin.prototype[name] = function(...args) {\n\t\t\tif (Object.hasOwnProperty(Traps, name) && _isFunction(Traps[name])) {\n\t\t\t\t// Wrap a call to the trap...\n\t\t\t\t// So mixin supers are passed to traps\n\t\t\t\treturn Traps[name].call(this, supers, ...args);\n\t\t\t} else {\n\t\t\t\t// Call each super and return\n\t\t\t\t// the last one's return value\n\t\t\t\tvar supersReturnValues = [];\n\t\t\t\tsupers.forEach(supr => {\n\t\t\t\t\tsupersReturnValues.push(supr.call(this, ...args));\n\t\t\t\t})\n\t\t\t\treturn _arrLast(supersReturnValues);\n\t\t\t}\n\t\t};\n\t});\n\treturn Mixin;\n};","\n/**\n * @imports\n */\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function(...objs) {\n\treturn _mergeCallback(objs, (k, obj1, obj2) => {\n\t\treturn true;\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\n};\n","\n/**\n * Returns the index of subset array \"b\" in array \"a\".\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last\n * \n * @returns Int\n */\nexport default function indexOfSet(a, b, fromInex = null, last = false) {\n    if (b.length > a.length) return -1;\n\treturn (typeof fromInex === 'number' ? (last ? a.slice(0, (fromInex + 1) + (fromInex < 0 ? a.length : 0)) : a.slice(fromInex)) : a).reduce((cursors, value, i) => {\n        var [ index, cursorA, cursorB ] = cursors;\n        if (!last && index > -1) {\n            return [index, cursorA, cursorB];\n        }\n        var _cursorB = cursorB + 1;\n        var _cursors = value === b[_cursorB] ? (_cursorB === 0 ? [i, 0] : [cursorA, _cursorB]) : [-1, -1];\n        if (_cursors[1] === b.length - 1) {\n            // Reset B cursor\n            _cursors[1] = -1;\n            if (_cursors[0] > -1) {\n                return [_cursors[0]].concat(_cursors);\n            }\n        }\n        return [index].concat(_cursors);\n    }, [-1, -1, -1])[0] + (last || typeof fromInex !== 'number' ? 0 : (fromInex > -1 ? fromInex : a.length - fromInex));\n}","\n/**\n * @imports\n */\nimport _after from '../str/after.js';\nimport _indexOfSet from './indexOfSet.js';\n\n/**\n * Returns members of array \"a\" after the array \"b\" subset.\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last \n * \n * @returns Bool\n */\nexport default function after(a, b, fromInex = null, last = false) {\n\tvar subsetIndex = _indexOfSet(a, b, fromInex, last);\n\treturn subsetIndex === -1 ? [] : a.slice(subsetIndex + b.length);\n}","\n/**\n * @imports\n */\nimport _isUndefined from '../js/isUndefined.js';\nimport _isFunction from '../js/isFunction.js';\n\n/**\n * 1. Returns the ENTRY following (either the FIRST or the LAST instance of) the reference.\n * 2. Returns A NUMBER OF ENTRIES counting forwards from (either the FIRST or the LAST instance of) the given reference.\n *\n * @param array \t\tarr\n * @param mixed\t \t\treference\n * @param int|bool \t\tlength\n * @param bool|function\t loop\n * @param bool\t \t\tlastReference\n *\n * @return mixed|array\n */\nexport default function(arr, reference, length = false, loop = false, lastReference = false) {\n\tif (arr.indexOf(reference) === -1) {\n\t\treturn length ? [] : undefined;\n\t}\n\tvar amount = length === true ? arr.length - 1 : (length === false ? 1 : length);\n\tvar from = lastReference ? arr.lastIndexOf(reference) + 1 : arr.indexOf(reference) + 1;\n\tvar after = !_isUndefined(reference) ? arr.slice(from, from + amount) : [];\n\tif (loop && after.length < amount && after.length < arr.length) {\n\t\tif (!_isFunction(loop) || loop(amount - after.length)) {\n\t\t\tafter = after.concat(arr.slice(0, amount - after.length));\n\t\t}\n\t};\n\treturn length ? after : after[0];\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isTypeArray from '../js/isTypeArray.js';\nimport _isEmpty from '../js/isEmpty.js';\nimport _isObject from '../js/isObject.js';\n\n/**\n * Casts an array-like object to an array.\n *\n * @param mixed \tval\n * @param bool\t \tcastObject\n *\n * @return array\n */\nexport default function(val, castObject = true) {\n\tif (_isArray(val)) {\n\t\treturn val;\n\t};\n\tif (!castObject && _isObject(val)) {\n\t\treturn [val];\n\t};\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\n\t\treturn [];\n\t};\n\tif (_isTypeArray(val)) {\n\t\treturn Array.prototype.slice.call(val);\n\t};\n\tif (_isObject(val)) {\n\t\treturn Object.values(val);\n\t};\n\treturn [val];\n};\n","\n/**\n * @imports\n */\nimport _isString from './isString.js';\nimport _isUndefined from './isUndefined.js';\n\n/**\n * Tells if val is \"array-like\".\n * This holds true for anything that has a length property.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !_isString(val) && !_isUndefined(val.length);\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the difference of two arrays;\n * optionally using a custom matching function.\n *\n * @param array \tarr\n * @param array\t \tarr2\n * @param function \tcallback\n *\n * @return array\n */\nexport default function(arr, arr2, callback = null) {\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \n\t\t? arr2.filter(val2 => callback(val1, val2)).length \n\t\t: arr2.indexOf(val1) === -1\n\t);\n};\n","\n/**\n * Tells if two arrays are shallow equals.\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe\n * \n * @returns Bool\n */\nexport default function equals(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? a.join('.') === b.join('.') \n\t\t: a.length === b.length && a.reduce((prev, value, i) => prev && value === b[i], true);\n}","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isObject from '../js/isObject.js';\nimport _isNumeric from '../js/isNumeric.js';\n\n/**\n * Flattens a nested array to the given depth.\n *\n * @param array \tarr\n * @param int \t \tdepth\n * @param bool \t \twithObjects\n *\n * @return array\n */\nconst _flatten = function(arr, depth = 1, withObjects = true) {\n\tif (!_isNumeric(depth) || depth <= 0) {\n\t\treturn arr;\n\t};\n\tif (!_isArray(arr) && _isObject(arr) && withObjects) {\n\t\tarr = Object.values(arr);\n\t};\n\tif (!_isArray(arr)) {\n\t\treturn arr;\n\t};\n\treturn arr.reduce((acc, val) => _isArray(val) || (_isObject(val) && withObjects) \n\t\t? acc.concat(_flatten(!_isArray(val) ? Object.values(val) : val, depth - 1, withObjects)) \n\t\t: acc.concat(val), []);\n};\n\n/**\n * @exports\n */\nexport default _flatten;","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the intersection of two arrays;\n * optionally using a custom matching function.\n *\n * @param array \tarr\n * @param array\t \tarr2\n * @param function \tcallback\n *\n * @return array\n */\nexport default function(arr, arr2, callback = null) {\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \n\t\t? arr2.filter(val2 => callback(val1, val2)).length \n\t\t: arr2.indexOf(val1) !== -1\n\t);\n};\n","\n/**\n * Tells if the array \"a\" starts with array \"b\".\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe \n * \n * @returns Bool\n */\nexport default function startsWith(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? (a.join('.') + '.').startsWith(b.join('.') + '.') \n\t\t: b.reduce((prev, value, i) => prev && value === a[i], true);\n}","\n/**\n * Returns a list of unique items.\n *\n * @param array\t \t\t\t\tarr\n *\t *\n * @return array\n */\nexport default function(arr) {\n\tconst distinct = (value, index, self) => {\n\t\treturn self.indexOf(value) === index;\n\t};\n\treturn arr.filter(distinct);\n};\n","\n/**\n * @imports\n */\nimport { _isArray } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _all } from '@webqit/util/arr/index.js';\n\n\n/**\n *  Returns paths in 2-dimensional form.\n * \n * - key                    => [ [key] ]\n * - [key]                  => [ [key] ]\n * - [key, key2]            => [ [key, key2] ]\n * - [ [key] ]              => [ [key] ]\n * - [ [key1, key2] ]       => [ [key1, key2] ]\n * \n * @param Array|String paths\n * \n * @return Array\n */\nexport function paths2D(paths) {\n\treturn (pathsIs2D(paths) ? paths : (_arrFrom(paths).length ? [paths] : []))\n\t\t.reduce((multiple, path) => multiple.concat([_arrFrom(path)]), [])\n\t\t.map(path => DotSafePath.resolve(path));\n}\nexport class DotSafePath extends Array {\n\tstatic resolve(path) {\n\t\t// Note the concat() below...\n\t\t// the spread operator: new DotSafePath(...path) doesn't work when path is [0].\n\t\treturn path.every(v => !(v + '').includes('.')) ? (new DotSafePath).concat(path) : path;\n\t}\n\tget dotSafe() { return true }\n}\n\n/**\n * OTHER HELPERS\n */\n\nexport function pathsIs2D(paths) {\n\treturn _arrFrom(paths).reduce((yes, path) => yes || _isArray(path), false);\n}\nexport function pathsIsDynamic(pathArray) {\n\t// Note that trying to simply match empty slots, as in: pathArray.filter(seg => !seg && seg !== 0).length\n\t// doesn't work when the empty slots are really empty slote, as in: [ 'key', <1 empty item> ]\n\treturn pathArray.filter(seg => seg || seg === 0).length !== pathArray.length;\n}\nexport function paths2DIsDynamic(paths) {\n\treturn paths.filter(pathArray => pathsIsDynamic(_arrFrom(pathArray))).length > 0;\n}\n\n","\n/**\n * @imports\n */\nimport { _isTypeObject, _isFunction, _getType, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _intersect, _equals as _arrEquals } from '@webqit/util/arr/index.js';\nimport { paths2D } from './utils.js'\n\n/**\n * ---------------------------\n * The Firebase class\n * ---------------------------\n */\n\nexport default class Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tthis.target = target;\n\t\tthis.fireables = [];\n\t\tthis.currentlyFiring = [];\n\t}\n\t\n\t/**\n\t * Adds an Fireable instance\n\t * with optional tags.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return Fireable\n\t */\n\tadd(fireable) {\n\t\tthis.fireables.push(fireable);\n\t\treturn fireable;\n\t}\n\t\n\t/**\n\t * Removes fireables by instance.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return void\n\t */\n\tremove(fireable) {\n\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t}\n\t\n\t/**\n\t * Removes fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tremoveMatches(dfn) {\n\t\tthis.match(dfn).forEach(fireable => {\n\t\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t\t});\n\t}\n\t\n\t/**\n\t * Finds fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return array\n\t */\n\tmatch(dfn) {\n\t\treturn this.fireables.filter(fireable => {\n\t\t\tvar fireableFilter = paths2D(fireable.filter);\n\t\t\tvar fireableTags = _arrFrom((fireable.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\tvar dfnFilter = paths2D(dfn.filter);\n\t\t\tvar dfnTags = _arrFrom((dfn.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\treturn (!dfn.originalHandler || fireable.handler === dfn.originalHandler)\n\t\t\t\t&& (!dfnFilter.length || _arrEquals(dfnFilter, fireableFilter))\n\t\t\t\t&& (!dfnTags.length || (dfnTags.length === fireableTags.length && _intersect(fireableTags, dfnTags).length === dfnTags.length));\n\t\t});\n\t}\n\t\t\n\t/**\n\t * Returns a observer-specific object embedded on an element.\n\t *\n\t * @param string\t\ttype\n\t * @param array|object\ttarget\n\t * @param bool      \tcreateIfNotExists\n\t * @param string      \tnamespace\n\t *\n\t * @return Firebase\n\t */\n\tstatic _getFirebase(type, target, createIfNotExists = true, namespace = this.__namespace) {\n\t\tif (!_isTypeObject(target)) {\n\t\t\tthrow new Error('Subject must be of type object; \"' + _getType(target) + '\" given!');\n\t\t}\n\t\tvar ImplementationClass = this;\n\t\tif (namespace && globalThis.WebQitObserverNamespaceRegistry.has(type + '-' + namespace)) {\n\t\t\tImplementationClass = globalThis.WebQitObserverNamespaceRegistry.get(type + '-' + namespace);\n\t\t\ttype += '-' + namespace\n\t\t}\n\t\tif (!_internals(target, 'firebases').has(type) && createIfNotExists) {\n\t\t\t_internals(target, 'firebases').set(type, new ImplementationClass(target));\n\t\t}\n\t\treturn _internals(target, 'firebases').get(type);\n\t}\n\n\t/**\n\t * Extend a Fireable Class with a namespace.\n\t *\n\t * @param string\t\tnamespace\n\t * @param class      \tImplementationClass\n\t *\n\t * @return void|class\n\t */\n\tstatic _namespace(type, namespace, ImplementationClass = null) {\n\t\ttype += '-' + namespace;\n\t\tif (arguments.length === 2) {\n\t\t\treturn globalThis.WebQitObserverNamespaceRegistry.get(type);\n\t\t}\n\t\tif (!(ImplementationClass.prototype instanceof this)) {\n\t\t\tthrow new Error(`The implementation of the namespace ${this.name}.${namespace} must be a subclass of ${this.name}.`);\n\t\t}\n\t\tglobalThis.WebQitObserverNamespaceRegistry.set(type, ImplementationClass);\n\t\tImplementationClass.__namespace = namespace;\n\t}\n}\n\nif (!globalThis.WebQitObserverNamespaceRegistry) {\n\tglobalThis.WebQitObserverNamespaceRegistry = new Map();\n}\n","\n/**\n * ---------------------------\n * The Fireable class\n * ---------------------------\n */\n\nexport default class Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object|array\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tthis.handler = dfn.handler;\n\t\tthis.filter = dfn.filter;\n\t\tthis.params = dfn.params;\n\n\t}\n\n\t/**\n\t * Sets a \"disconnected\" flag on the Fireable.\n\t *\n\t * @return void\n\t */\n\tdisconnect() {\n\t\tthis.disconnected = true;\n\t}\n}","\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _intersect } from '@webqit/util/arr/index.js';\nimport Fireable from './Fireable.js';\n\n/**\n * ---------------------------\n * The Trap class\n * ---------------------------\n */\n\nexport default class Interceptor extends Fireable {\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's fields.\n\t *\n\t * @param Event\t\t\t \t\t\tevent\n\t * @param function\t\t\t\t\tnext\n\t * @param mixed\t\t\t\t\t \trecieved\n\t *\n\t * @return void\n\t */\n\tfire(event, next, recieved) {\n\t\tif (this.disconnected || (this.filter && !_intersect(_arrFrom(this.filter), [event.type]).length)) {\n\t\t\treturn next(...Array.prototype.slice.call(arguments, 2));\n\t\t}\n\t\treturn this.handler(event, recieved, next);\n\t}\n}","\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Action {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.type) {\n\t\t\tthrow new Error('Action type must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tObject.seal(this);\n\t}\n}","\n/**\n * @imports\n */\nimport Firebase from './Firebase.js';\nimport Interceptor from './Interceptor.js';\nimport Action from './Action.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Interceptors extends Firebase {\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Interceptor(this.target, dfn));\n\t}\n\n\t/**\n\t * Fires all interceptors with the given action.\n\t *\n\t * @param Action\t\t\taction\n\t * @param function\t\t\tdefaultHandler\n\t *\n\t * @return mixed\n\t */\n\tfire(action, defaultHandler = null) {\n\t\tif (!(action instanceof Action)) {\n\t\t\taction = new Action(this.target, action);\n\t\t}\n\t\tif (this.currentlyFiring.filter(a => a.type === action.type && a.name === action.name).length) {\n\t\t\treturn defaultHandler ? defaultHandler() : undefined;\n\t\t}\n\t\tthis.currentlyFiring.push(action);\n\t\tconst next = (index, ..._args) => {\n\t\t\tvar interceptor = this.fireables[index];\n\t\t\tif (interceptor) {\n\t\t\t\treturn interceptor.fire(action, (...args) => {\n\t\t\t\t\treturn next(index + 1, ...args);\n\t\t\t\t}/*next*/, ..._args);\n\t\t\t}\n\t\t\treturn defaultHandler ? defaultHandler(..._args) : _args[0];\n\t\t};\n\t\tvar value = next(0);\n\t\tthis.currentlyFiring.pop();\n\t\treturn value;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('interceptor', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('interceptor', ...arguments);\n\t}\n}","\n/**\n * @imports\n */\nimport { _internals } from '@webqit/util/js/index.js';\n\n/**\n * Returns the original object earlier proxied by proxy().\n *\n * @param Proxy|Any\t\ttarget\n *\n * @return Any\n */\nexport default function(target) {\n    // Proxy targets are mapped to their own instances internally\n    return _internals(target, false).get(target) || target;\n}\n","\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a Reflect operation of the specified type.\n *\n * @param string\t\ttype\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(type, target, payload = {}, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\t// Execute any \"keys\" traps, otherwise \"test\" the default way\n\tvar interceptors, defaultHandler = function(_val) {\n\t\treturn arguments.length ? _val : Reflect[type](target, ...Object.values(payload));\n\t};\n\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\treturn interceptors.fire({ type, ...payload }, defaultHandler);\n\t}\n\treturn defaultHandler();\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs an \"apply\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tthisArgument\n * @param array\t\t\targumentsList\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, thisArgument, argumentsList, params = {}) {\n\treturn _exec('apply', target, { thisArgument, argumentsList }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"construct\" operation on a target.\n *\n * @param array|object\ttarget\n * @param array\t\t\targumentsList\n * @param object\t\tnewTarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, argumentsList, newTarget = null, params = {}) {\n\treturn _exec('construct', target, arguments.length > 2 ? { argumentsList, newTarget } : { argumentsList }, params);\n}\n","\n/**\n * Converts a string to title case.\n *\n * @param string \tstr\n * @param bool \t\tstrict\n *\n * @return string\n */\nexport default function(str, strict) {\n\tif (typeof str !== 'string') {\n\t\treturn str;\n\t}\n\treturn str.replace(/\\w\\S*/g,  function(txt) { return txt.charAt(0).toUpperCase() + ((typeof strict !== undefined && strict) ? txt.substr(1).toLowerCase() : txt.substr(1)); })\n};\n","\n/**\n * @imports\n */\nimport { _isUndefined, _isObject } from '@webqit/util/js/index.js';\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The Event class\n * ---------------------------\n */\n\nexport default class Event {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return void\n\t */\n\tconstructor(target, cancellable = false) {\n\t\tthis._ = {};\n\t\tthis._.target = target;\n\t\tthis._.cancellable = cancellable;\n\t\tthis._.propagationStopped = false;\n\t\tthis._.defaultPrevented = false;\n\t\tthis._.promisesInstance = null;\n\t\tthis._.promises = [];\n\t}\n\n\t/**\n\t * Gets the \"target\" object.\n\t *\n\t * @return array|object\n\t */\n\tget target() {\n\t\treturn this._.target;\n\t}\n\n\t/**\n\t * Gets the \"cancellable\" flag.\n\t *\n\t * @return bool\n\t */\n\tget cancellable() {\n\t\treturn this._.cancellable;\n\t}\n\n\t/**\n\t * -----------------------\n\t * RESPONSE HANDLERS\n\t * -----------------------\n\t */\n\n\t/**\n\t * Stops the evnt from reaching other listeners.\n\t *\n\t * @return bool\n\t */\n\tstopPropagation() {\n\t\tthis._.propagationStopped = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if stopPropagation() has been called.\n\t *\n\t * @return bool\n\t */\n\tget propagationStopped() {\n\t\treturn this._.propagationStopped;\n\t}\n\t\t\n\t/**\n\t * Sets a disposition that asks event initiator not to\n\t * proceed with default action.\n\t *\n\t * @return void\n\t */\n\tpreventDefault() {\n\t\tthis._.defaultPrevented = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if preventDefault() has been called.\n\t *\n\t * @return bool\n\t */\n\tget defaultPrevented() {\n\t\treturn this._.defaultPrevented;\n\t}\n\t\t\n\t/**\n\t * Sets a Promise disposition.\n\t *\n\t * @param Promise\tpromise\n\t *\n\t * @return void\n\t */\n\twaitUntil(promise) {\n\t\tif (promise instanceof Promise) {\n\t\t\tthis._.promises.push(promise);\n\t\t\tthis._.promisesInstance = null;\n\t\t}\n\t}\n\t\t\n\t/**\n\t * (Readonly) returns all promises.\n\t *\n\t * @return Promise|null\n\t */\n\tget promises() {\n\t\tif (!this._.promisesInstance && this._.promises.length) {\n\t\t\tthis._.promisesInstance = Promise.all(this._.promises);\n\t\t}\n\t\treturn this._.promisesInstance;\n\t}\n\t\t\n\t/**\n\t * Evaluates the given disposition value and\n\t * calls an appropriate disposition method.\n\t *\n\t * @params mixed \trspns\n\t *\n\t * @return void\n\t */\n\trespondWith(rspns) {\n\t\tvar proms;\n\t\tvar isEvent = _isObject(rspns) && !_isUndefined(rspns.propagationStopped) && !_isUndefined(rspns.defaultPrevented)\n\t\tif ((rspns === false) || (isEvent && rspns.propagationStopped)) {\n\t\t\tthis.stopPropagation();\n\t\t} else if ((rspns === false) || (isEvent && rspns.defaultPrevented)) {\n\t\t\tthis.preventDefault();\n\t\t} else if ((rspns instanceof Promise && (proms = rspns))\n\t\t|| (isEvent && (proms = rspns.promises))) {\n\t\t\tthis.waitUntil(proms);\n\t\t}\n\t}\n}","\n/**\n * @imports\n */\nimport {\n\t_after as _arrAfter, _startsWith as _arrStartsWith,\n\t_any, _equals as _arrEquals,\n} from '@webqit/util/arr/index.js';\nimport { _isNumeric, _isFunction, _isObject } from '@webqit/util/js/index.js';\nimport { paths2D, pathsIs2D, pathsIsDynamic, paths2DIsDynamic } from './utils.js'\nimport Fireable from './Fireable.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Observer class\n * ---------------------------\n */\n\nexport default class Observer extends Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tsuper(target, dfn);\n\t\t// The rest of this code is designed for a 2-dimensional array.\n\t\tthis.filters2D = paths2D(this.filter);\n\t\tthis.filtersIsOriginally2D = pathsIs2D(this.filter);\n\t\tthis.filtersIsDynamic = paths2DIsDynamic(this.filters2D);\n\t\tif (this.filtersIsDynamic && this.filters2D.length > 1) {\n\t\t\tthrow new Error('Only one \"Dynamic Filter\" must be observed at a time! \"' + this.filters2D.map(pathArray => '[' + pathArray.join(', ') + ']').join(', ') + '\" have been bound together.');\n\t\t}\n\t}\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's filter.\n\t *\n\t * @param array\t\t\t \tchanges\n\t *\n\t * @return void\n\t */\n\tfire(changes) {\n\t\tif (this.disconnected || (this.params.type && !_any(changes, delta => this.params.type === delta.type))) {\n\t\t\treturn;\n\t\t}\n\t\tconst diff = delta => !['set', 'def'].includes(delta.type) || (\n\t\t\t!this.params.diff || (_isFunction(this.params.diff) ? this.params.diff(delta.value, delta.oldValue) : delta.value !== delta.oldValue)\n\t\t);\n\t\tvar evt = new Event(this.target);\n\t\tif (this.filters2D.length) {\n\t\t\tvar matches = changes.filter(delta => {\n\t\t\t\t// one observerPathArray can turn out to be two if dynamic\n\t\t\t\t// OR evt.originatingFields is multiple and this.params.subtree\n\t\t\t\treturn this.filters2D.filter((observerPathArray, i) => {\n\t\t\t\t\tvar observerPathArray_Resolved = observerPathArray.slice();\n\t\t\t\t\tif (this.filtersIsDynamic) {\n\t\t\t\t\t\t// Note that if we had tried to loop thru observerPathArray_Resolved,\n\t\t\t\t\t\t// we wouldn't be able tp access slots that are truly empty, as in: [ 'key', <1 empty item> ]\n\t\t\t\t\t\tdelta.path.forEach((_seg, i) => {\n\t\t\t\t\t\t\tobserverPathArray_Resolved[i] = observerPathArray_Resolved[i] || observerPathArray_Resolved[i] === 0 \n\t\t\t\t\t\t\t\t? observerPathArray_Resolved[i]\n\t\t\t\t\t\t\t\t: _seg;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn (!this.filtersIsDynamic || !pathsIsDynamic(observerPathArray_Resolved)) && diff(delta) && ((!this.params.subtree && _arrEquals(observerPathArray_Resolved, delta.path))\n\t\t\t\t\t\t|| (this.params.suptree && _arrStartsWith(observerPathArray_Resolved, delta.path) && (!_isNumeric(this.params.suptree) || _arrAfter(observerPathArray_Resolved, delta.path).length <= this.params.suptree))\n\t\t\t\t\t\t|| (this.params.subtree && delta.path.length >= observerPathArray_Resolved.length && _arrStartsWith(delta.path, observerPathArray_Resolved) && (!_isNumeric(this.params.subtree) || _arrAfter(delta.path, observerPathArray_Resolved).length <= this.params.subtree))\n\t\t\t\t\t);\n\t\t\t\t}).length;\n\t\t\t});\n\t\t\tif (matches.length) {\n\t\t\t\tif (this.filtersIsOriginally2D || this.params.subtree) {\n\t\t\t\t\tvar changesObject = matches;\n\t\t\t\t\tif (_isObject(this.filter)) {\n\t\t\t\t\t\tchangesObject = {...this.filter};\n\t\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\t\tchangesObject[e.name] = e;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tevt.respondWith(this.handler(changesObject, evt));\n\t\t\t\t} else {\n\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\tevt.respondWith(this.handler(e, evt));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ((this.params.subtree || changes.filter(delta => _arrEquals(delta.path, [delta.name])).length === changes.length) && changes.filter(delta => diff(delta)).length) {\n\t\t\tevt.respondWith(this.handler(changes, evt));\n\t\t}\n\t\treturn evt;\n\t}\n}\n","\n/**\n * Tells if ANY items pass the test.\n *\n * @param array \tarr\n * @param function \tcallback\n *\n * @return bool\n */\nexport default function(arr, callback) {\n\treturn arr.reduce((prevTest, itm, i) => prevTest || callback(itm, i), false);\n};\n","\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\nimport { DotSafePath } from './utils.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Mutation {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.originalSubject) {\n\t\t\tthis.originalSubject = target;\n\t\t}\n\t\tif (!('type' in dfn)) {\n\t\t\tthrow new Error('Mutation type must be given in definition!');\n\t\t}\n\t\tif (!('name' in dfn)) {\n\t\t\tthrow new Error('Property name must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tif (key === 'path') {\n\t\t\t\tvalue = DotSafePath.resolve(value);\n\t\t\t}\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tif (!this.path) {\n\t\t\tObject.defineProperty(this, 'path', {value: DotSafePath.resolve([dfn.name]), enumerable:true});\n\t\t}\n\t\tObject.seal(this);\n\t}\n}","\n/**\n * @imports\n */\nimport { _from as _arrFrom, _remove, _last } from '@webqit/util/arr/index.js';\nimport Firebase from './Firebase.js';\nimport Observer from './Observer.js';\nimport Mutation from './Mutation.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Observers extends Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tsuper(target);\n\t\tthis.buffers = [];\n\t}\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Observer(this.target, dfn));\n\t}\n\t\n\t/**\n\t * Fires all observers with the given evt (change).\n\t *\n\t * @param array|Mutation\t\tchanges\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return Event\n\t */\n\tfire(changes, cancellable) {\n\t\tvar evt = new Event(this.target, cancellable);\n\t\t// We accept multiple changes\n\t\tchanges = _arrFrom(changes, false).map(delta => !(delta instanceof Mutation) ? new Mutation(this.target, delta) : delta);\n\t\tif (this.buffers.length) {\n\t\t\t_last(this.buffers)(changes);\n\t\t\treturn evt;\n\t\t}\n\t\tif (this.currentlyFiring.filter(d => changes.filter(delta => d.type === delta.type && d.name === delta.name).length).length) {\n\t\t\t//return false;\n\t\t}\n\t\t//this.currentlyFiring.push(...changes);\n\t\tthis.fireables.forEach(observer => {\n\t\t\tif (evt.propagationStopped && cancellable) {\n\t\t\t\treturn evt;\n\t\t\t}\n\t\t\tevt.respondWith(observer.fire(changes));\n\t\t});\n\t\t//changes.forEach(delta => _remove(this.currentlyFiring, delta));\n\t\treturn evt;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('observer', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('observer', ...arguments);\n\t}\n}","\n/**\n * @imports\n */\nimport {\n\t_isArray, _isNumeric, _isClass,\n\t_isFunction, _isTypeObject, _internals\n} from '@webqit/util/js/index.js';\nimport { _from as _objFrom } from '@webqit/util/obj/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a \"get\" operation on a target.\n * Fires any such query observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return mixed\n */\nexport default function(target, keys, receiver = null, params = {}) {\n\ttarget = receiver || target;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\tvar _keys = _arrFrom(keys);\n\tvar values = _keys.map(key => {\n\t\t// Execute any \"get\" traps, otherwise \"get\" the default way\n\t\tvar interceptors, defaultGet = function(_value) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _value;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps').has(key) && _internals(target, 'accessorizedProps').get(key).touch(true)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).get();\n\t\t\t}\n\t\t\treturn receiver \n\t\t\t\t? Reflect.get(target, key, receiver) \n\t\t\t\t: Reflect.get(target, key);\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, true, params.namespace)) {\n\t\t\treturn interceptors.fire({type:'get', name: key, related: _keys, receiver}, defaultGet);\n\t\t}\n\t\treturn defaultGet();\n\t});\n\t// ---------------------------------\n\treturn _isArray(keys) ? values : values[0];\n}\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Adds an observer to an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\thandler\n * @param object\t\t\t\t\tparams\n *\n * @return Observer\n */\nexport default function(target, filter, handler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? handler : {};\n\t\thandler = filter;\n\t\tfilter = null;\n\t}\n\tif (!_isFunction(handler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(handler) + '\" given!');\n\t}\n\tvar existing, observers = Observers.getFirebase(target, true, params.namespace);\n\tvar dfn = {filter, handler, params,};\n\tif (dfn.filter || dfn.params.subtree === '*' || (dfn.params.subtree && isUserObject(target))) {\n\t\tbuild(target, dfn.filter, dfn.params.subtree, params.namespace);\n\t}\n\tif (dfn.params.unique && (existing = observers.match({filter, params})).length) {\n\t\tif (dfn.params.unique !== 'replace') {\n\t\t\treturn existing[0];\n\t\t}\n\t\tobservers.remove(existing[0]);\n\t}\n\treturn observers.add(dfn);\n}\n","\n/**\n * @imports\n */\nimport { _each, _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Mutation from '../core/Mutation.js';\nimport Observers from '../core/Observers.js';\nimport observe from '../reactions/observe.js';\n\n/**\n * Bubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tvalue\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tif (target === value) {\n\t\treturn;\n\t}\n\tvar observers;\n\tobserve(value, (changes, eventObject) => {\n\t\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\t\tvar _changes = changes.map(delta => {\n\t\t\t\t// ------------\n\t\t\t\t// Recursive events must not propagate\n\t\t\t\t// ------------\n\t\t\t\tvar d = delta;\n\t\t\t\tdo {\n\t\t\t\t\tif (d.target === target) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} while(d = d.src);\n\t\t\t\t// ------------\n\t\t\t\t// Create propagation\n\t\t\t\t// ------------\n\t\t\t\tvar dfn = {}; _each(delta, (key, value) => {\n\t\t\t\t\tif (key !== 'target' && key !== 'name' && key !== 'path' && key !== 'src') {\n\t\t\t\t\t\tdfn[key] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdfn.name = field;\n\t\t\t\tdfn.path = [field].concat(delta.path);\n\t\t\t\tdfn.originalSubject = delta.originalSubject;\n\t\t\t\tdfn.src = delta;\n\t\t\t\treturn new Mutation(target, dfn);\n\t\t\t}).filter(c => c);\n\t\t\tif (_changes.length) {\n\t\t\t\treturn observers.fire(_changes, eventObject.cancellable);\n\t\t\t}\n\t\t}\n\t}, {subtree: true, ...params, unique: true, tags: [linkTag, field, target]});\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'set',\n\t\t\tvalue,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tlet eventObject = observers.fire(_event, params.cancellable);\n\t\tif (params.eventTypeReturn) {\n\t\t\treturn eventObject;\n\t\t}\n\t}\n}\n\n/**\n * @var object\n */\nexport const linkTag = {};","\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _before, _after } from '@webqit/util/str/index.js';\nimport { paths2D } from '../core/utils.js';\nimport Observers from '../core/Observers.js';\nimport _get from '../actions/get.js';\nimport link from './link.js';\n\n/**\n * Recursively \"connects\" an object's members to the object\n * for observer actions.\n *\n * @param array|object\ttarget\n * @param string|array\tpaths\n * @param bool\t\t\tsubtree\n * @param String\t\tnamespace\n *\n * @return void\n */\nexport default function build(target, paths = null, subtree = false, namespace = null) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tvar observers = Observers.getFirebase(target, true, namespace);\n\tif (!observers || observers.build) {\n\t\treturn;\n\t}\n\tobservers.build = subtree;\n\t// ---------------------------------\n\t// For paths2D, refer to the comments at class Observer.\n\tvar _paths2D = paths2D(paths);\n\t// If any path starts with a dot, (a wild card path), all keys at this level is implied\n\tvar rootLevelKeysToObserve = !_paths2D.length || _paths2D.filter(path => /*Starts with an empty segment*/!path[0] && path[0] !== 0).length\n\t\t? Object.keys(target)\n\t\t: _paths2D.map(path => path[0]);\n\tvar subLevelKeysToObserve = _paths2D.length ? _paths2D.map(path => path.slice(1)).filter(p => p.length) : null;\n\tobservers.subBuild = subLevelKeysToObserve && subLevelKeysToObserve.length ? subLevelKeysToObserve : null;\n\trootLevelKeysToObserve.forEach(key => {\n\t\tvar value = _get(target, key, null, { namespace });\n\t\ttry {\n\t\t\tif (_isTypeObject(value)) {\n\t\t\t\tlink(target, key, value, null, params);\n\t\t\t\tif ((observers.subBuild && isUserObject(value)) \n\t\t\t\t|| (_isFunction(subtree) ? subtree(value) : (subtree && isUserObject(value)))) {\n\t\t\t\t\tbuild(value, observers.subBuild, subtree, namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {/* instanceof-ing certain primitives may throw */}\n\t});\n}\n\n/**\n * Tells if an object if a User Object.\n * \n * @param Object value\n * \n * @return Bool\n */\nexport const isUserObject = value => ((value instanceof Object) || (value instanceof Array) || (value instanceof Function))\n\t&& (typeof window === 'undefined' || value !== window);\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Removes observers from an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\toriginalHandler\n * @param object\t\t\t\t\tparams\n *\n * @return void\n */\nexport default function(target, filter, originalHandler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? originalHandler : {};\n\t\toriginalHandler = filter;\n\t\tfilter = null;\n\t}\n\tif (originalHandler && !_isFunction(originalHandler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(originalHandler) + '\" given!');\n\t}\n\tvar observers;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\treturn observers.removeMatches({filter, originalHandler, params});\n\t}\n}\n","\n/**\n * @imports\n */\nimport { _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Observers from '../core/Observers.js';\nimport unobserve from '../reactions/unobserve.js';\nimport { linkTag } from './link.js';\n\n/**\n * Unbubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tobject\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tunobserve(value, null, null, {...params, tags:[linkTag, field, target]});\n\tvar observers;\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'del',\n\t\t\toldValue: value,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tobservers.fire(_event, params.cancellable);\n\t}\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"has\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string\t\tname\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('has', target, { name }, params);\n}\n","\n/**\n * @imports\n */\nimport {\n\t_isObject, _isTypeObject, _internals,\n\t_isNumber, _isArray, _isString\n} from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport link from '../connectors/link.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"_setProp\" type of operation on a target.\n * Fires any observers for the specific type that may be bound to target.\n *\n * @param bool\t\t\tdefine\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param Object\t\tparams\n *\n * @return Event\n */\nexport default function(define, target, payload, params = {}) {\n\ttarget = payload.receiver || target;\n\tvar keysOrPayload = payload.keysOrPayload;\n\tvar value = payload.value;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tif (_isObject(keysOrPayload)) {\n\t\tparams = value || {};\n\t\tvalue = null;\n\t}\n\t// ----------\n\ttarget = _unproxy(target);\n\tvar interceptors = Interceptors.getFirebase(target, false, params.namespace),\n\t\tobservers = Observers.getFirebase(target, false, params.namespace);\n\t// ----------\n\tconst handleSet = (key, value, related, detail) => {\n\t\tvar type = 'set', descriptor;\n\t\tif (define) {\n\t\t\ttype = 'defineProperty';\n\t\t\tdescriptor = value || {};\n\t\t\tvalue = descriptor.value;\n\t\t}\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar isUpdate = false, oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\tisUpdate = true;\n\t\t\toldValue = _get(target, key, payload.receiver, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype,\n\t\t\tvalue,\n\t\t\treceiver: payload.receiver,\n\t\t\trelated,\n\t\t\tdetail,\n\t\t\tisUpdate,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// The set operation\n\t\tvar defaultSet = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\tif (descriptor) {\n\t\t\t\t\tdescriptor = _success;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = _success;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (descriptor) {\n\t\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tObject.defineProperty(target, key, descriptor);\n\t\t\t} else if (_internals(target, 'accessorizedProps', false).has(key)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).set(value);\n\t\t\t}\n\t\t\ttarget[key] = value;\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors) {\n\t\t\tvar eventObject = descriptor \n\t\t\t\t? {type: 'defineProperty', name: key, descriptor, receiver: payload.receiver, related, detail, isUpdate, oldValue} \n\t\t\t\t: {type: 'set', name: key, value, receiver: payload.receiver, related, detail, isUpdate, oldValue};\n\t\t\te.success = interceptors.fire(eventObject, defaultSet);\n\t\t} else {\n\t\t\te.success = defaultSet();\n\t\t}\n\t\t// ---------------------------------\n\t\tif (e.success && e.value !== e.oldValue) {\n\t\t\t// Unobserve outgoing value for bubbling\n\t\t\tif (_isTypeObject(e.oldValue)) {\n\t\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t\t}\n\t\t\t// Observe incoming value for bubbling\n\t\t\tif (_isTypeObject(e.value)) {\n\t\t\t\tlink(target, key, e.value, null, params);\n\t\t\t\tif (observers && (observers.subBuild || (observers.build && isUserObject(e.value)))) {\n\t\t\t\t\tbuild(e.value, observers.subBuild, observers.build, params.namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn e;\n\t};\n\t// ---------------------------------\n\tvar keys, events = [];\n\tif (_isArray(keysOrPayload) || ((_isString(keysOrPayload) || _isNumber(keysOrPayload)) && (keys = _arrFrom(keysOrPayload)))) {\n\t\tevents = keys.map(key => handleSet(key, value, keys, params.detail));\n\t} else if (_isObject(keysOrPayload) && (keys = Object.keys(keysOrPayload))) {\n\t\tevents = keys.map(key => handleSet(key, keysOrPayload[key], keys, params.detail));\n\t}\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar evt;\n\tif (observers) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n","\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"defineProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, params = {}) {\n\treturn _setOrDefine(true/*define*/, target, { keysOrPayload, value }, params);\n}\n","\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _isTypeObject, _internals } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"deleteProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return Event\n */\nexport default function(target, keys, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\tvar _keys = _arrFrom(keys);\n\tvar events = _keys.map(key => {\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\toldValue = _get(target, key, null, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype: 'deleteProperty',\n\t\t\trelated: _keys,\n\t\t\tdetail: params.detail,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// Execute any \"del\" traps, otherwise \"del\" the default way\n\t\tvar interceptors, defaultDel = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _success;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdelete target[key];\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\t\te.success = interceptors.fire({type: 'deleteProperty', name:key, oldValue, related: _keys}, defaultDel);\n\t\t} else {\n\t\t\te.success = defaultDel();\n\t\t}\n\t\t// ---------------------------------\n\t\t// Unobserve outgoing value for bubbling\n\t\tif (e.success && _isTypeObject(e.oldValue)) {\n\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t}\n\t\treturn e;\n\t});\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar observers, evt;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getOwnPropertyDescriptor\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string|number name\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('getOwnPropertyDescriptor', target, { name }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('getPrototypeOf', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"isExtensible\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('isExtensible', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"ownKeys\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('ownKeys', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"preventExtensions\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('preventExtensions', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"set\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, receiver = null, params = {}) {\n\treturn _setOrDefine(false/*define*/, target, arguments.length > 3 ? { keysOrPayload, value, receiver } : { keysOrPayload, value }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"setPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tprototype\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, prototype, params = {}) {\n\treturn _exec('setPrototypeOf', target, { prototype }, params);\n}\n","\n/**\n * @imports\n */\n// Actions\nimport apply from './actions/apply.js';\nimport construct from './actions/construct.js';\nimport defineProperty from './actions/defineProperty.js';\nimport deleteProperty from './actions/deleteProperty.js';\nimport get from './actions/get.js';\nimport getOwnPropertyDescriptor from './actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from './actions/getPrototypeOf.js';\nimport has from './actions/has.js';\nimport isExtensible from './actions/isExtensible.js';\nimport ownKeys from './actions/ownKeys.js';\nimport preventExtensions from './actions/preventExtensions.js';\nimport set from './actions/set.js';\nimport setPrototypeOf from './actions/setPrototypeOf.js';\n// Actors\nimport accessorize from './actors/accessorize.js';\nimport unaccessorize from './actors/unaccessorize.js';\nimport proxy from './actors/proxy.js';\nimport unproxy from './actors/unproxy.js';\n// Reactions\nimport observe from './reactions/observe.js';\nimport unobserve from './reactions/unobserve.js';\nimport intercept from './reactions/intercept.js';\nimport unintercept from './reactions/unintercept.js';\nimport closure from './reactions/closure.js';\n// Connectors\nimport build from './connectors/build.js';\nimport link from './connectors/link.js';\nimport unlink from './connectors/unlink.js';\n// Core\nimport Observers from './core/Observers.js';\nimport Interceptors from './core/Interceptors.js';\n\n/**\n * @exports\n */\nexport default {\n\t// Actions\n\tapply,\n\tconstruct,\n\tdefineProperty,\n\tdeleteProperty,\n\tget,\n\tgetOwnPropertyDescriptor,\n\tgetPrototypeOf,\n\thas,\n\tisExtensible,\n\townKeys,\n\tpreventExtensions,\n\tset,\n\tsetPrototypeOf,\n\t// Actors\n\taccessorize,\n\tunaccessorize,\n\tproxy,\n\tunproxy,\n\t// Reactions\n\tobserve,\n\tunobserve,\n\tintercept,\n\tunintercept,\n\tclosure,\n\t// Connectors\n\tbuild,\n\tlink,\n\tunlink,\n\t// Core\n\tObservers,\n\tInterceptors,\n}","\n/**\n * @imports\n */\nimport {\n    _isClass, _isFunction, _isTypeObject,\n    _getType, _internals,\n} from '@webqit/util/js/index.js';\nimport apply from '../actions/apply.js';\nimport construct from '../actions/construct.js';\nimport defineProperty from '../actions/defineProperty.js';\nimport deleteProperty from '../actions/deleteProperty.js';\nimport get from '../actions/get.js';\nimport getOwnPropertyDescriptor from '../actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from '../actions/getPrototypeOf.js';\nimport has from '../actions/has.js';\nimport isExtensible from '../actions/isExtensible.js';\nimport ownKeys from '../actions/ownKeys.js';\nimport preventExtensions from '../actions/preventExtensions.js';\nimport set from '../actions/set.js';\nimport setPrototypeOf from '../actions/setPrototypeOf.js';\n\n/**\n * Returns an object as a proxy and binds all instance methods\n * to the proxy instead of the object itself.\n *\n * @param Object|Array\t\ttarget\n * @param Object\t\t    params\n *\n * @return Proxy\n */\nexport default function(target, params = {}) {\n\tif (!_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(target) + '\" given!');\n    }\n    var proxy = new Proxy(target, {\n        apply:  (target, thisArgument, argumentsList) => apply(target, thisArgument, argumentsList, params),\n        construct:  (target, argumentsList, newTarget = null) => construct(target, argumentsList, newTarget, params),\n        defineProperty:  (target, propertyKey, attributes) => defineProperty(target, propertyKey, attributes, params),\n        deleteProperty: (target, propertyKey) => deleteProperty(target, propertyKey, params),\n        get: (target, propertyKey, receiver = null) => {\n            var val = get(target, propertyKey, receiver, params);\n            if (params.proxyAutoBinding !== false && _isFunction(val) && !_isClass(val)) {\n                return val.bind(proxy);\n            }\n            return val;\n        },\n        getOwnPropertyDescriptor: (target, propertyKey) => getOwnPropertyDescriptor(target, propertyKey, params),\n        getPrototypeOf: target => getPrototypeOf(target, params),\n        has: (target, propertyKey) => has(target, propertyKey, params),\n        isExtensible: target => isExtensible(target, params),\n        ownKeys: target => ownKeys(target, params),\n        preventExtensions: target => preventExtensions(target, params),\n        set: (target, propertyKey, value, receiver = null) => set(target, propertyKey, value, receiver, params),\n        setPrototypeOf: (target, prototype) => setPrototypeOf(target, prototype, params),\n    });\n    _internals(proxy).set(proxy, target);\n\treturn proxy;\n}\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"class\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) && /^class\\s?/.test(Function.prototype.toString.call(val));\n};\n","\nexport const _isTextMediaType = contentMediaType => contentMediaType && (\n    contentMediaType.startsWith('text/')\n    || contentMediaType === 'application/rtf'\n    || contentMediaType === 'application/xml'\n    || contentMediaType === 'application/xhtml+xml'\n    || contentMediaType === 'application/json'\n);\n\nexport const _isFileUpload = schema => {\n    return schema.format === 'data-url' \n    || schema.contentEncoding === 'base64';\n};","\n/**\n * @imports\n */\nimport { _difference, _intersect, _unique } from '@webqit/util/arr/index.js';\nimport { _isBoolean, _isNull, _isNumeric, _isString } from '@webqit/util/js/index.js';\n\n/**\n * @Schema Base Controller\n * @todo: anyOf, oneOf, allOf\n */\nexport const _Schema = __Schema => class extends (__Schema || class {}) {\n    \n    constructor(jsonSchema) {\n        super(jsonSchema);\n        // depreciated, readOnly, writeOnly, default, \n        // title, description, enum, const, examples, etc\n        Object.keys(jsonSchema).forEach(name => {\n            Object.defineProperty(this, name, { value: jsonSchema[name] });\n        });\n    }\n\n    validate(instance) {\n        return super.validate ? super.validate(instance) : { valid: true };\n    }\n\n}\n\n/**\n * @ObjectOrArray Base Controller\n */\nexport const _ObjectOrArray = __ObjectOrArray => class extends _Schema(__ObjectOrArray) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateMin(instance)).valid) {\n            return { valid: false, error: validity.error || `Minimum number of entries short of: ${validity.violation}.` };\n        }\n        if (!(validity = this._validateMax(instance)).valid) {\n            return { valid: false, error: validity.error || `Maximum number of entries exceeded by: ${validity.violation}.` };\n        }\n        return validity;\n    }\n\n}\n\n/**\n * @Object Controller\n */\nexport const _Object = __Object => class extends _ObjectOrArray(__Object) {\n\n    getPropertyNameSchema(instanceHint = null) {\n        var propertyNameSchema = this.propertyNames || { type: 'string' };\n        if (this.additionalProperties === false) {\n            propertyNameSchema.error = `Additional properties not allowed.`;\n        }\n        if (instanceHint) {\n            // With instanceHint as hint, consider assisting the caller with\n            // 1. Dynamically-generated names as options - names that aren't yet in the instance\n        }\n        propertyNameSchema.isRequired = true;\n        return propertyNameSchema;\n    }\n\n    getPropertySchema(propertyName, instanceHint = null) {\n        var propertySchema;\n        if ((!this.properties || !(propertySchema = this.properties[propertyName]))\n        && !(propertySchema = this._patternPropertiesMatch(propertyName))\n        && !(propertySchema = this.additionalProperties) && propertySchema !== false) {\n            propertySchema = { };\n        }\n        if (propertySchema) {\n            // Also use \"this.required\" to hint this property schema about requiredness\n            if ((this.required || []).includes(propertyName)) {\n                propertySchema.isRequired = true;\n            }\n            if (instanceHint) {\n                const instanceProperties = Object.keys(instanceHint);\n                // With instance as hint, consider assisting the caller with dynamically-generated hints\n                // 1. Use \"this.dependentRequired\" to hint this property schema about dependent-requiredness\n                var requiringProp;\n                if (!propertySchema.isRequired && (requiringProp = _intersect(this.dependentRequired || [], instanceProperties).reduce((masterHint, master) => masterHint || this.dependentRequired[master].includes(propertyName) ? master : null, null))) {\n                    propertySchema.isRequired = requiringProp;\n                }\n                // 2. Info about whether this proposed entry will validate against \"this.min/this.maxProperties\"\n                var validity;\n                if (!instanceProperties.includes(propertyName) && !(validity = this._validateMax(instanceHint)).valid || validity.violation === 0/* currently exact maximum reached */) {\n                    propertySchema.error = `This additional entry will violate the maximum number of entries allowed.`;\n                }\n                // 3. dynamic \"type\": the list of types in \"this.allOf\", \"this.anyOf\", \"this.oneOf\", not in \"this.not\"\n            }\n            return { ...propertySchema, name:propertyName };\n        }\n    }\n\n    _patternPropertiesMatch(propertyName) {\n        return Object.keys(this.patternProperties || {}).reduce((prev, pattern) => {\n            if (prev) return prev;\n            if ((new RegExp(pattern)).test(propertyName)) {\n                return this.patternProperties[pattern];\n            }\n        }, null);\n    }\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateRequired(instance)).valid) {\n            return { valid: false, error: validity.error || `Required entries still empty: ${validity.violation.join(', ')}.` };\n        }\n        if (!(validity = this._validateDependentRequired(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries associated with \"${validity.master}\" still empty: ${validity.violation.join(', ')}.` };\n        }\n        return validity;\n    }\n\n    _validateMax(instance) {\n        if (!this.maxProperties) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = instanceProperties.length - this.maxProperties;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateMin(instance) {\n        if (!this.minProperties) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = this.minProperties - instanceProperties.length;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateRequired(instance) {\n        if (!this.required) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = _difference(this.required, instanceProperties);\n        return { valid: violation.length === 0, violation };\n    }\n\n    _validateDependentRequired(instance) {\n        if (!this.dependentRequired) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const [ master, violation ] = Object.keys(this.dependentRequired).reduce((prev, key) => {\n            if (prev) return prev;\n            if (instanceProperties.includes(key)) {\n                const violation = _difference(this.dependentRequired[key], instanceProperties);\n                if (violation.length) return [ key, violation ];\n            }\n        }, null) || [];\n        return { valid: !master, master, violation };\n    }\n}\n\n/**\n * @Array Controller\n */\n export const _Array = __Array => class extends _ObjectOrArray(__Array) {\n\n    getItemSchema(itemIndex, instanceHint = null) {\n        var itemSchema;\n        if ((!this.prefixItems || !(itemSchema = this.prefixItems[itemIndex]))\n        && !(itemSchema = this.items) && itemSchema !== false) {\n            itemSchema = { };\n        }\n        if (itemSchema) {\n            if (instanceHint) {\n                // With instance as hint, consider assisting the caller with dynamically-generated hints\n                // 1. Info about whether this proposed entry will validate against \"this.min/this.maxProperties\"\n                var validity;\n                if (!(itemIndex in instanceHint) && !(validity = this._validateMax(instanceHint)).valid || validity.violation === 0/* currently exact maximum reached */) {\n                    itemSchema.error = `This additional entry will violate the maximum number of entries allowed.`;\n                }\n                // 2. \"this.contains\"\n            }\n            return { ...itemSchema, name:itemIndex };\n        }\n    }\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateUnique(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries must be unique` };\n        }\n        if (!(validity = this._validateContains(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries must contain ${validity.min > 0 ? `at least ${validity.min} ` + (validity.max > 1 ? 'and ' : '') : ''} ${validity.max > 1 ? `at most ${validity.max} ` : ''}of ${validity.desc}.` };\n        }\n        return validity;\n    }\n\n    _validateMax(instance) {\n        if (!this.maxItems) return { valid: true };\n        const violation = instance.length - this.maxItems;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateMin(instance) {\n        if (!this.minItems) return { valid: true };\n        const violation = this.minItems - instance.length;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateUnique(instance) {\n        if (!this.uniqueItems) return { valid: true };\n        return { valid: _unique(instance).length === instance.length };\n    }\n\n    _validateContains(instance) {\n        if (!this.contains) return { valid: true };\n        const passes = instance.filter(item => this.__validateContains(this.contains, item));\n        if (passes.length < (this.minContains || 1)) {\n            return { valid: false, min: this.minContains || 1, max: this.maxContains, desc };\n        }\n        if (this.maxContains && passes.length > this.maxContains) {\n            return { valid: false, min: this.minContains || 1, max: this.maxContains, desc };\n        }\n        return { valid: true };\n    }\n}\n\n/**\n * @String Controller\n */\nexport const _String = __String => class extends _Schema(__String) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isString(instance) };\n    }\n\n}\n\n/**\n * @Num Controller\n */\nexport const _Num = __Num => class extends _Schema(__Num) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return validity;\n    }\n\n}\n\n/**\n * @Number Controller\n */\nexport const _Number = __Number => class extends _Num(__Number) {\n    \n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isNumeric(instance) };\n    }\n\n}\n\n/**\n * @Integer Controller\n */\nexport const _Integer = __Integer => class extends _Num(__Integer) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: Number.isInteger(instance) };\n    }\n\n}\n\n/**\n * @Boolean Controller\n */\nexport const _Boolean = __Boolean => class extends _Schema(__Boolean) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isBoolean(instance) };\n    }\n\n}\n\n/**\n * @Null Controller\n */\nexport const _Null = __Null => class extends _Schema(__Null) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isNull(instance) };\n    }\n\n}","\n/**\n * @imports\n */\nimport Observer from '@webqit/observer';\nimport { _toTitle } from '@webqit/util/str/index.js';\nimport { _from as _arrFrom, _intersect } from '@webqit/util/arr/index.js';\nimport { _getType, _isBoolean, _isEmpty, _isTypeObject, _isArray, _isFunction, _isUndefined, _isObject } from '@webqit/util/js/index.js';\nimport { _isTextMediaType, _isFileUpload } from './utils/util.js';\nimport * as Schemas from './schema-mixins.js';\n\n/**\n * @Root Base Controller\n */\nexport const _Root = __Root => class extends (__Root || class {}) {\n\n    static getSchemaName(type) {\n        type = _arrFrom(type || 'string');\n        return [\n            ['object', '_Object'],\n            ['array', '_Array'],\n            ['string', '_String'],\n            ['number', '_Number'],\n            ['integer', '_Integer'],\n            ['boolean', '_Boolean'],\n            ['null', '_Null']\n        ].reduce((name, pair) => name || (type.includes(pair[0]) ? pair[1] : null), null);\n    }\n\n    setSchema(schema, parentWidget = null) {\n        Observer.set(this, 'schema', Observer.proxy(schema));\n        Observer.set(this, 'parentWidget', parentWidget);\n        Observer.set(this, 'attrs', Observer.proxy({\n            name: this.parentWidget && this.parentWidget.attrs.name ? `${this.parentWidget.attrs.name}[${this.schema.name}]` : this.schema.name\n        }));\n        if (!this.schema.title) {\n            this.schema.title = _toTitle(((this.schema.name || '') + '').replaceAll('_', ' '));\n        }\n        if (this.schema.isRequired) {\n            this.attrs.required = true;\n        }\n        if (!_isUndefined(this.schema.const) || !_isUndefined(this.schema.default)) {\n            this.attrs.value = !_isUndefined(this.schema.const) ? this.schema.const : this.schema.default;\n        }\n        if (this.schema.readOnly || !_isUndefined(this.schema.const)) {\n            this.attrs.readonly = true;\n        }\n    }\n\n};\n\n/**\n * @ParentRoot Base Controller\n */\nexport const _ParentRoot = __ParentRoot => class extends _Root(__ParentRoot) {\n\n    deriveChildWidget(childSchema) {}\n\n    renderChildWidget(childWidget, childSchema, removeCallback = null) {}\n\n};\n\n/**\n * @Collection Controller\n */\nexport const _Collection = __Collection => class extends _ParentRoot(__Collection) {\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('object');\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._Object())(jsonSchema), parentWidget);\n        Observer.set(this, 'entries', Observer.proxy({}));\n        Object.keys(this.schema.properties || {}).forEach(propertyName => {\n            const propertySchema = this.schema.getPropertySchema(propertyName);\n            this.addResolvedEntry(propertyName, propertySchema);\n        });\n    }\n\n    addResolvedEntry(propertyName, propertySchema) {\n        const childWidget = this.renderChildWidget(this.deriveChildWidget(propertySchema), propertySchema, () => {\n            if (this.entries[propertyName] === childWidget)\n            delete this.entries[propertyName];\n        });\n        if (childWidget) {\n            this.entries[propertyName] = childWidget;\n        } else {\n            console.warn(`No widget type defined for entry \"${propertyName}\" of schema type \"${_arrFrom(propertySchema.type || 'string').join(', ')}\".`);\n        }\n        return childWidget;\n    }\n\n    extend(propertyName, callback = null) {\n        if (_isFunction(propertyName)) {\n            const promptPropertyName = () => {\n                const propertyNameSchema = this.schema.getPropertyNameSchema(this.json());\n                propertyName(propertyNameSchema, _propertyName => {\n                    if (propertyNameSchema.validate(_propertyName)) {\n                        extend(_propertyName, callback);\n                    } else {\n                        promptPropertyName();\n                    }\n                });\n            }\n            promptPropertyName();\n        } else if (propertyName) {\n            const instanceHint = this.json();\n            const propertySchema = this.schema.getPropertySchema(propertyName, instanceHint);\n            const childWidget = this.addResolvedEntry(propertyName, propertySchema);\n            if (callback) {\n                callback(childWidget);\n            }\n        }\n    }\n\n    json(data = {}) {\n        if (arguments.length) {\n            if (!_isObject(data)) throw new Error(`Data must be a valid JSON object.`);\n            Object.keys(data).forEach(name => {\n                if (!this.entries[name]) throw new Error(`Entry \"${name}\" not in collection.`);\n                this.entries[name].json(data[name]);\n            });\n            return;\n        }\n        // ------------------\n        const _data = {};\n        Object.keys(this.entries).forEach(name => {\n            _data[name] = this.entries[name].json();\n        });\n        return _data;\n    }\n    \n};\n    \n/**\n * @Multiple Controller\n */\nexport const _Multiple = __Multiple => class extends _ParentRoot(__Multiple) {\n     \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('array');\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._Array())(jsonSchema), parentWidget);\n        Observer.set(this, 'entries', Observer.proxy([]));\n        if (!_isEmpty(this.schema.prefixItems)) {\n            this.schema.prefixItems.forEach(itemIndex => {\n                const itemSchema = this.schema.getItemSchema(itemIndex);\n                this.addResolvedEntry(itemIndex, itemSchema);\n            });\n        }\n        if (this.schema.autoExtend === true) {\n            this.extend();\n        }\n    }\n\n    addResolvedEntry(itemIndex, itemSchema) {\n        const childWidget = this.renderChildWidget(this.deriveChildWidget(itemSchema), itemSchema, () => {\n            if (this.entries[itemIndex] === childWidget)\n            delete this.entries[itemIndex];\n        });\n        if (childWidget) {\n            this.entries[itemIndex] = childWidget;\n        } else {\n            console.warn(`No widget type defined for entry \"${itemIndex}\" of schema type \"${_arrFrom(itemSchema.type || 'string').join(', ')}\".`);\n        }\n        return childWidget;\n    }\n\n    extend(callback = null) {\n        const instanceHint = this.json();\n        const itemIndex = instanceHint.length;\n        const itemSchema = this.schema.getItemSchema(itemIndex, instanceHint);\n        const childWidget = this.addResolvedEntry(itemIndex, itemSchema);\n        if (callback) {\n            callback(childWidget);\n        }\n    }\n\n    json(data = []) {\n        if (arguments.length) {\n            if (!_isArray(data)) throw new Error(`Data must be a valid JSON array.`);\n            data.forEach((value, itemIndex) => {\n                if (!this.entries[itemIndex]) throw new Error(`Entry \"${itemIndex}\" not in collection.`);\n                this.entries[itemIndex].json(value);\n            });\n            return;\n        }\n        // ------------------\n        return this.entries.filter(entry => entry).map(entry => entry.json());\n    }\n\n};\n\n/**\n * @Multiple Controller\n */\nexport const _Multiple2 = __Multiple2 => class extends _Multiple(__Multiple2) {\n            \n    static testSchema(jsonSchema) {\n        if (!super.testSchema(jsonSchema)) return;\n        // Any enum is going to be array items each\n        if (jsonSchema.enum) return;\n        var entries = [],\n            widgetLineContentLengthLimit = this.lineContentLengthLimit || 50;\n        if (jsonSchema.prefixItems) {\n            // super.testSchema() plus only \"const\" or \"single-item enum\", plus, nothing object-like, nor a string that execeeds widget line limit\n            if (jsonSchema.prefixItems.some(item => (!('const' in item) && (item.enum || []).length !== 1) || _intersect(_arrFrom(item.type), ['array', 'object']).length || Math.max(item.minLength, item.maxLength, 0) > widgetLineContentLengthLimit)) return;\n            entries = jsonSchema.prefixItems.map(item => ('const' in item) ? item.const : item.enum[0]);\n        }\n        if (jsonSchema.items) {\n            // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n            if (_intersect(_arrFrom(jsonSchema.items.type), ['array', 'object']).length || Math.max(jsonSchema.items.minLength, jsonSchema.items.maxLength, 0) > widgetLineContentLengthLimit) return;\n            entries = entries.concat(jsonSchema.items.enum || /* may not always be enum */[]);\n        }\n        return !entries.some(item => _isTypeObject(item) || (item + '').length > widgetLineContentLengthLimit);\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(...arguments);\n        if (this.schema.autoExtend !== false) {\n            this.extend();\n        }\n    }\n    \n}\n\n/**\n * @Enum Controller\n */\nexport const _Enum = __Enum => class extends _Root(__Enum) {\n\n    static testSchema(jsonSchema) {\n        return _isArray(jsonSchema.enum) || (\n            // Or where an array with the following conditions that completely eliminates the idea of a schema-based items list:\n            _arrFrom(jsonSchema.type).includes('array') && (\n                // 1. where no jsonSchema.prefixItems (which would have been a schema) or where jsonSchema.prefixItems bundles its \"const\"s\n                (_isEmpty(jsonSchema.prefixItems) || jsonSchema.prefixItems.every(item => ('const' in item) || (item.enum || []).length === 1))\n                // 2. where no .items (meaning: \"won't grow\") or where .items bundles its \"enums\" which are themselves expected to be final as specified by .uniqueItems\n                && (jsonSchema.items === false || (_isArray((jsonSchema.items || {}).enum) && jsonSchema.uniqueItems))\n            )\n        );\n    }\n\n    constructor() {\n        super();\n        Observer.set(this, 'entries', Observer.proxy([]));\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        // Enums can be any type\n        const schemaName = this.constructor.getSchemaName(jsonSchema.type);\n        super.setSchema(new (Schemas[schemaName]())(jsonSchema), parentWidget);\n        // -------------\n        // Mine items...\n        // -------------\n        var entries = [];\n        if (this.schema.enum) {\n            entries = this.schema.enum.map((value, i) => ({ value, label: (this.schema.enumNames || {})[i] }));\n        } else if (_arrFrom(this.schema.type || 'string').includes('array')) {\n            // Array case 1:\n            if (this.schema.prefixItems) {\n                entries = this.schema.prefixItems.map(item => (\n                    ('const' in item) ? { value: item.const, label: item.title } : { value: item.enum[0], label: item.title || (item.enumNames || [])[0] }\n                ));\n            }\n            // Array case 2:\n            if (this.schema.items) {\n                this.schema.items.enum.forEach((item, i) => {\n                    entries.push({ value: item, label: (this.schema.items.enumNames || [])[i] });\n                });\n            }\n            // Expecting type array means \"multiple\"\n            this.attrs.multiple = true;\n            this.attrs.name += '[]';\n            entries.forEach(item => {\n                item.selected = true;\n            });\n        }\n        if (_arrFrom(this.schema.type).includes('null')) {\n            entries = [{ value: null }].concat(entries);\n        }\n        // ------------------\n        entries.forEach((itemData, itemIndex) => {\n            const itemWidget = this.renderItemWidget(this.deriveItemWidget(itemData, itemIndex), itemData, itemIndex, () => {\n                if (this.entries[itemIndex] === itemWidget)\n                delete this.entries[itemIndex];\n            });\n            if (itemWidget) {\n                this.entries[itemIndex] = itemWidget;\n            }\n        });\n    }\n\n    deriveItemWidget(entry, itemIndex) {}\n\n    renderItemWidget(enumItem, entry, itemIndex, removeCallback = null) {}\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n};\n\n/**\n * @Enum2 Controller\n */\nexport const _Enum2 = __Enum2 => class extends _Enum(__Enum2) {\n    \n    static testSchema(jsonSchema) {\n        if (!super.testSchema(jsonSchema)) return;\n        var entries = [],\n            widgetLineContentLengthLimit = this.lineContentLengthLimit || 50;\n        if (jsonSchema.enum) {\n            // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n            if (_intersect(_arrFrom(jsonSchema.type), ['array', 'object']).length || Math.max(jsonSchema.minLength, jsonSchema.maxLength, 0) > widgetLineContentLengthLimit) return;\n            entries = jsonSchema.enum;\n        } else {\n            if (jsonSchema.prefixItems) {\n                // Only \"const\" or \"single-item enum\" - as ensured by super.testSchema(), plus, none should be object-like, nor a string that execeeds widget line limit\n                if (jsonSchema.prefixItems.some(item => _intersect(_arrFrom(item.type), ['array', 'object']).length || Math.max(item.minLength, item.maxLength, 0) > widgetLineContentLengthLimit)) return;\n                entries = jsonSchema.prefixItems.map(item => ('const' in item) ? item.const : item.enum[0]);\n            }\n            if (jsonSchema.items) {\n                // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n                if (_intersect(_arrFrom(jsonSchema.items.type), ['array', 'object']).length || Math.max(jsonSchema.items.minLength, jsonSchema.items.maxLength, 0) > widgetLineContentLengthLimit) return;\n                entries = entries.concat(jsonSchema.items.enum);\n            }\n        }\n        return !entries.some(item => _isTypeObject(item) || (item + '').length > widgetLineContentLengthLimit);\n    }\n\n}\n\n/**\n * @File Controller\n */\nexport const _File = __File => class extends _Root(__File) {\n\n    static testSchema(jsonSchema) {\n        const _isFileSchema = _jsonSchema => {\n            const schemaType = _arrFrom(_jsonSchema.type || 'string');\n            return (schemaType.includes('string') && (_isFileUpload(_jsonSchema) || (_jsonSchema.contentMediaType && !_isTextMediaType(_jsonSchema.contentMediaType))));\n        };\n        return _isFileSchema(jsonSchema) || (\n            _arrFrom(jsonSchema.type).includes('array') && jsonSchema.uniqueItems && _isEmpty(jsonSchema.prefixItems) && _isFileSchema(jsonSchema.items || {})\n        );\n    }\n\n    constructor() {\n        super();\n        Observer.set(this, 'filesList', Observer.proxy([]));\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        const schemaType = _arrFrom(jsonSchema.type);\n        const $schema = schemaType.includes('array') ? Schemas._Array() : Schemas._String();\n        super.setSchema(new $schema(jsonSchema), parentWidget);\n        this.attrs.type = 'file';\n        if (schemaType.includes('array')) {\n            this.attrs.name += '[]';\n            this.attrs.multiple = true;\n        }\n    }\n\n    deriveItemWidget(entry, itemIndex) {}\n\n    renderItemWidget(previewItem, entry, itemIndex) {}\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n\n};\n\n/**\n * @InputRoot Base Controller\n */\nexport const _Input = __Input => class extends _Root(__Input) {\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(...arguments);\n        if (!_isUndefined(this.schema.default) || this.schema.examples) {\n            this.attrs.placeholder = `E.g.: ${!_isUndefined(this.schema.default) ? this.schema.default : this.schema.examples[0]}`;\n        }\n    }\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n\n};\n\n/**\n * @Editor Controller\n */\nexport const _Editor = __Editor => class extends _Input(__Editor) {\n        \n    static testSchema(jsonSchema) {\n        const schemaType = _arrFrom(jsonSchema.type || 'string');\n        return schemaType.includes('string') && ((jsonSchema.contentMediaType && _isTextMediaType(jsonSchema.contentMediaType)) || (\n            Math.max(jsonSchema.maxLength, jsonSchema.minLength) >= 1024\n        ));\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._String())(jsonSchema), parentWidget);\n    }\n\n};\n\n/**\n * @Input Controller\n */\nexport const _Text = __Text => class extends _Input(__Text) {\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type || 'string').includes('string');\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._String())(jsonSchema), parentWidget);\n        this.attrs.type = 'text';\n        if (this.schema.format === 'date') {\n            this.attrs.type = 'date';\n        } else if (this.schema.format === 'time') {\n            this.attrs.type = 'time';\n        } else if (this.schema.format === 'date-time') {\n            this.attrs.type = 'datetime-local';\n        } else if (this.schema.format === 'duration') {\n            this.attrs.type = ''; // ?\n        } else if (['uri', 'uri-reference', 'iri', 'iri-reference', 'uuid'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (['hostname', 'idn-hostname'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (['email', 'idn-email'].includes(this.schema.format)) {\n            this.attrs.type = 'email';\n        } else if (['ipv4', 'ipv6'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (this.schema.format === 'password') {\n            this.attrs.type = 'password';\n        } else if (this.schema.format === 'color') {\n            this.attrs.type = 'color';\n        } else if (this.schema.format === 'phone') {\n            this.attrs.pattern = '^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$';\n        } else if (this.schema.format === 'postal-code') {\n            this.attrs.pattern = '^[0-9]{5}(?:-[0-9]{4})?$';\n        }\n        // -----\n        if (this.schema.maxLength) {\n            this.attrs.maxlength = this.schema.maxLength;\n        }\n        if (this.schema.minLength) {\n            this.attrs.minlength = this.schema.minLength;\n        }\n        if (this.schema.pattern) {\n            this.attrs.pattern = this.schema.pattern;\n        }\n        if (!this.schema.col) {\n            const col = this.schema.maxLength || 150;\n            this.schema.col = Math.max(1, parseInt(col / (300 / 12)));\n        }\n        // -----\n    }\n    \n};\n\n/**\n * @Number Controller\n */\nexport const _Number = __Number => class extends _Input(__Number) {\n        \n    static testSchema(jsonSchema) {\n        const schemaType = _arrFrom(jsonSchema.type);\n        return schemaType.includes('integer') || schemaType.includes('number');\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._Number())(jsonSchema), parentWidget);\n        this.attrs.type = 'number';\n        if (this.schema.exclusiveMaximum) {\n            this.attrs.max = this.schema.exclusiveMaximum - 0.0001;\n        } else if (this.schema.maximum) {\n            // date, month, week, time, datetime-local, number, and range\n            this.attrs.max = this.schema.maximum;\n        }\n        if (this.schema.exclusiveMinimum) {\n            this.attrs.min = this.schema.exclusiveMinimum + 0.0001;\n        } else if (this.schema.minimum) {\n            // date, month, week, time, datetime-local, number, and range\n            this.attrs.min = this.schema.minimum;\n        }\n        if (this.schema.multipleOf) {\n            // number, date/time input types, and range\n            this.attrs.step = this.schema.multipleOf;\n        }\n        if (!this.schema.col) {\n            const col = this.schema.maxLength /* char width in sql */ || 50;\n            this.schema.col = Math.max(1, parseInt(col / (300 / 12)));\n        }\n        // ------\n    }\n    \n};\n\n/**\n * @State Controller\n */\nexport const _State = __State => class extends _Root(__State) {\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('boolean');\n    }\n\n    setSchema(jsonSchema, parentWidget = null) {\n        super.setSchema(new (Schemas._Boolean())(jsonSchema), parentWidget);\n        this.attrs.type = 'checkbox';\n        if (this.schema.const === true || this.schema.default === true) {\n            this.attrs.checked = true;\n        }\n    }\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n    \n};","\n/**\n * @imports\n */\nimport Observer from '@webqit/observer';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _toTitle } from '@webqit/util/str/index.js';\nimport * as Roots from './playui-mixins.js';\n\n/**\n * ---------------------------\n * Root Elements\n * ---------------------------\n */\n\n/**\n * @Root Element\n * @extends __Root\n */\nexport const _Root = __Root => class extends (__Root || HTMLElement) {\n\n    static get subscriptBlocks() {\n        return [ 'renderBasic', 'render' ];\n    }\n\n    renderBasic() {\n        //if (typeof $ === 'undefined') return;\n        if (this.schema.title && this.namespace.title) {\n            $(this.namespace.title).html(this.schema.title);\n        }\n        if (this.schema.col) {\n            $(this).class({\n                ['col-' + this.schema.col]: true,\n                'col-12': false,\n            });\n        } else {\n            $(this).class('col-12', true);\n        }\n    }\n\n    render() {}\n\n};\n\n/**\n * @ParentRoot Element\n * @extends _Root() -> __ParentRoot\n */\nexport const _ParentRoot = __ParentRoot => class extends _Root(__ParentRoot) {\n\n    deriveChildWidget(childSchema) {\n        if (!this.template) return;\n        return Reflect.ownKeys(this.template.exports).map(key => this.template.exports[key][0]).reduce((match, item) => {\n            if (match) return match;\n            const constructor = item.hasAttribute('is') \n                ? customElements.get(item.getAttribute('is'))\n                : customElements.get(item.localName);\n            return constructor && constructor.testSchema(childSchema) ? item : null;\n        }, null);\n    }\n    \n    renderChildWidget(childWidget, childSchema, disconnectedCallback = null) {\n        if (!childWidget) return;\n        // ------------\n        childWidget = childWidget.cloneNode(true);\n        if (this.namespace.content) {\n            this.namespace.content.append(childWidget);\n        } else {\n            this.append(childWidget);\n        }\n        // ------------\n        try {\n            childWidget.setSchema(childSchema, this);\n        } catch(e) {\n            console.warn(`Error calling element.setSchema();`, e, this);\n        }\n        if (disconnectedCallback) {\n            //this.bindDisconnectedCallback(disconnectedCallback);\n        }\n        return childWidget;\n    }\n\n};\n\n/**\n * @Collection Element\n * @extends _ParentRoot() -> Roots._Collection() -> __Collection\n */\nexport const _Collection = __Collection => class extends _ParentRoot(Roots._Collection(__Collection || HTMLElement)) {\n};\n\n/**\n * @MultipleRoot Element\n * @extends _ParentRoot() -> __MultipleRoot\n */\nexport const _MultipleRoot = __MultipleRoot => class extends _ParentRoot(__MultipleRoot) {\n};\n\n/**\n * @Multiple Element\n * @extends _MultipleRoot() -> Roots._Multiple() -> __Multiple\n */\nexport const _Multiple = __Multiple => class extends _MultipleRoot(Roots._Multiple(__Multiple || HTMLElement)) {\n};\n\n/**\n * @Multiple2 Element\n * @extends _MultipleRoot() -> Roots._Multiple2() -> __Multiple2\n */\nexport const _Multiple2 = __Multiple2 => class extends _MultipleRoot(Roots._Multiple2(__Multiple2 || HTMLElement)) {\n\n    render() {\n        if (this.namespace.input && this.attrs.name) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n    extend(callback = null) {\n        if (this.entries.length && !this.entries[this.entries.length - 1].namespace.input.value) {\n            return;\n        }\n        return super.extend(callback);\n    }\n\n};\n\n/**\n * @EnumRoot Element\n * @extends _Root() -> __EnumRoot\n */\nexport const _EnumRoot = __EnumRoot => class extends _Root(__EnumRoot) {\n\n    deriveItemWidget(entry, itemIndex) {\n        if (!this.template) {\n            if (this.namespace.input instanceof HTMLSelectElement) {\n                return document.createElement('option');\n            }\n        }\n        return Reflect.ownKeys(this.template.exports).map(key => this.template.exports[key][0]).reduce((match, item) => {\n            if (match) return match;\n            const constructor = item.hasAttribute('is') \n                ? customElements.get(item.getAttribute('is'))\n                : customElements.get(item.localName);\n            return constructor && constructor.testSchema(this.schema, entry) ? item : null;\n        }, null);\n    }\n    \n    renderItemWidget(enumWidget, entry, itemIndex, disconnectedCallback = null) {\n        if (!enumWidget) return;\n        // ------------\n        enumWidget = enumWidget.cloneNode(true);\n        if (this.namespace.input instanceof HTMLSelectElement) {\n            this.namespace.input.options.add(enumWidget);\n            enumWidget.setAttribute('label', entry.label || _toTitle(entry.value));\n            enumWidget.value = entry.value;\n            enumWidget.selected = entry.selected;\n        } else {\n            this.namespace.input.append(enumWidget);\n            enumWidget.setAttribute('data-index', itemIndex);\n        }\n        // ------------\n        if (disconnectedCallback) {\n            //this.bindDisconnectedCallback(disconnectedCallback);\n        }\n        return enumWidget;\n    }\n\n    json(data = null) {\n        if (arguments.length) {\n            if (this.namespace.input instanceof HTMLSelectElement) {\n                if (this.attrs.multiple) {\n                    if (!_isArray(data)) throw new Error(`Data must be a valid JSON array.`);\n                    Array.from(this.namespace.input.options).forEach(option => {\n                        option.selected = false;\n                        data.forEach(value => {\n                            if (option.value === value) {\n                                option.selected = true;\n                            }\n                        });\n                    });\n                } else {\n                    this.namespace.input.value = data;\n                }\n                return;\n            }\n            if (this.attrs.multiple) {\n            } else {\n            }\n            return;\n        }\n        // ------------------\n        if (this.namespace.input instanceof HTMLSelectElement) {\n            return this.attrs.multiple ? this.namespace.input.selectedOptions : this.namespace.input.value;\n        }\n        return this.attrs.multiple ? [] : this.namespace.input.value;\n    }\n\n    render() {\n        if (this.namespace.input && this.attrs.name) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @Enum Element\n * @extends _EnumRoot() -> Roots._Enum() -> __Enum\n */\nexport const _Enum = __Enum => class extends _EnumRoot(Roots._Enum(__Enum || HTMLElement)) {\n}\n\n/**\n * @Enum2 Element\n * @extends _EnumRoot() -> Roots._Enum2() -> __Enum2\n */\nexport const _Enum2 = __Enum2 => class extends _EnumRoot(Roots._Enum2(__Enum2 || HTMLElement)) {\n}\n\n/**\n * @File Element\n * @extends _Root() -> Roots._File() -> __FileRoot\n */\nexport const _File = __File => class extends _Root(Roots._File(__File || HTMLElement)) {\n\n    setSchema(jsonSchema, parentwidget = null) {\n        super.setSchema(...arguments);\n        const schemaType = _arrFrom(this.schema.type);\n        if (schemaType.includes('array')) {\n            this.attrs.name += '[]';\n        }\n    }\n\n    constructor() {\n        super();\n        this._dataTransfer = new DataTransfer;\n        Observer.observe(this.filesList, mutations => {\n            mutations.forEach(m => {\n                if (m.type === 'deleteProperty' && m.oldValue.previewElement) m.oldValue.previewElement.remove();\n                if (m.type === 'set' && m.isUpdate && m.oldValue && m.oldValue.previewElement) m.oldValue.previewElement.remove();\n            });\n        });\n        // ------------------\n        // On-direct choosing\n        // ------------------\n        this.addEventListener('change', e => {\n            if (this.namespace.dropArea) {\n                this.addFiles(e.target.files, true);\n            }\n        });\n        this._handlerDrag = e => {\n            if (e.type === 'dragover' || e.type === 'dragenter') {\n                if (this.state) {\n                    this.state.dragging = true;\n                }\n            } else if (e.type === 'dragleave' || e.type === 'dragend' || e.type === 'drop') {\n                e.preventDefault();\n                if (this.state) {\n                    this.state.dragging = false;\n                }\n                if (e.type === 'drop') {\n                    this.addFiles(e.dataTransfer.files);\n                }\n            }\n        };\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.namespace.dropArea) {\n            // On drag-and-drop\n            [ 'drag', 'dragstart', 'dragend', 'dragover', 'dragenter', 'dragleave', 'drop' ].forEach(eventName => {\n                this.namespace.dropArea.removeEventListener(eventName, this._handlerDrag);\n                this.namespace.dropArea.addEventListener(eventName, this._handlerDrag);\n            });\n        }\n    }\n\n    addFiles(files, isDirectSelection = false) {\n        const filesListAdd = file => {\n            if (!file) return;\n            const entry = { file, isDirectSelection, remove: () => {\n                this._dataTransfer.items.remove(file);\n                this.filesList.splice(this.filesList.indexOf(entry), 1);\n            } };\n            this._dataTransfer.items.add(file);\n            this.filesList.push(entry);\n            // -----------------------\n            const itemIndex = this.filesList.length - 1;\n            entry.previewElement = this.renderPreviewElement(this.derivePreviewElement(file, itemIndex), file, itemIndex, () => {\n                entry.remove();\n            });\n        };\n        if (this.schema.multiple) {\n            // Add new files each time\n            if (isDirectSelection) {\n                this.filesList\n                    .filter(entry => entry.isDirectSelection)\n                    .forEach(entry => entry.remove());\n            }\n            for (let i = 0; i < files.length; i++) {\n                filesListAdd(files[i]);\n            }\n        } else {\n            // Clear existing\n            this._dataTransfer.items.clear();\n            this.filesList.splice(0);\n            filesListAdd(files[0]);\n        }\n        if (this.namespace.input) {\n            // Assign the files to the input element\n            this.namespace.input.files = this._dataTransfer.files;\n        }\n    }\n\n    derivePreview(file) {\n        // Show thumnails\n        var desc = `${file.name}: ${file.size / 1024}KB`;\n        var revokeURL = el => window.URL.revokeObjectURL(el.src);\n        if (/^image\\//.test(file.type)) {\n            var img = document.createElement('img');\n            img.onload = e => { revokeURL(img); };\n            img.src = window.URL.createObjectURL(file);\n            return { el: img, type:'image', mime: file.type, desc, };\n        }\n        if (/^video\\//.test(file.type)) {\n            var media = document.createElement('video');\n            media.onloadstart/*canplay*/ = e => { revokeURL(media); media.play(); };\n            media.src = window.URL.createObjectURL(file);\n            media.muted = true;\n            return { el: media, type: 'video', mime: file.type, desc, };\n        }\n        const el = document.createElement('i');\n        el.classList.add('bi');\n        var type = 'file';\n        if (/^audio\\//.test(file.type)) {\n            type = 'audio';\n        } else if (/msword|ms-word|wordprocessing/.test(file.type)) {\n            type = 'word';\n        } else if (/powerpoint|presentation/.test(file.type)) {\n            type = 'powerpoint';\n        } else if (/excel|spreadsheet/.test(file.type)) {\n            type = 'excel';\n        } else if (/^text\\//.test(file.type)) {\n            type = 'text';\n        } else if (/\\/pdf/.test(file.type)) {\n            type = 'pdf';\n        } else if (/\\/zip/.test(file.type)) {\n            type = 'zip';\n        }\n        el.classList.add('bi-file-' + type);\n        return { el, type, mime: file.type, desc, };\n    }\n\n    derivePreviewElement(file, itemIndex) {\n        if (!this.template) return;\n        return (this.template.exports.default || [])[0];\n    }    \n\n    renderPreviewElement(previewElement, file, itemIndex, disconnectedCallback = null) {\n        const previewData = this.derivePreview(file);\n        if (previewElement) {\n            previewElement = previewElement.cloneNode(true);\n            previewElement.append(previewData.el);\n        } else {\n            previewElement = previewData.el;\n        }\n        // ------------\n        if (this.namespace.preview) {\n            this.namespace.preview.append(previewElement);\n        } else {\n            this.append(previewElement);\n        }\n        // ------------\n        if (disconnectedCallback) {\n            //this.bindDisconnectedCallback(disconnectedCallback);\n        }\n        return previewElement;\n    }\n\n    json(data = null) {\n        if (arguments.length) {\n            this.filesList.forEach(entry => {\n                entry.remove();\n            });\n            if (this.attrs.multiple) {\n                if (!_isArray(data)) throw new Error(`Data must be a valid JSON array.`);\n            } else {\n                data = [ data ];\n            }\n            this.addFiles(data);\n            return;\n        }\n        // ------------------\n        return this.attrs.multiple \n            ? this.namespace.input.files \n            : this.namespace.input.files[0];\n    }\n\n    render() {\n        if (this.namespace.input && (this.attrs.type || this.attrs.name)) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @Input Element\n * @extends _Root() -> __Input\n */\nexport const _Input = __Input => class extends _Root(__Input) {\n\n    json(data = null) {\n        if (arguments.length) {\n            this.namespace.input.value = data;\n            return;\n        }\n        return this.namespace.input.value;\n    }\n\n    render() {\n        if (this.namespace.input && (this.attrs.type || this.attrs.name)) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @Editor Element\n * @extends _Input() -> Roots._Editor() -> __Editor\n */\nexport const _Editor = __Editor => class extends _Input(Roots._Editor(__Editor || HTMLElement)) {\n};\n\n/**\n * @Text Element\n * @extends _Input() -> Roots._Text() -> __Text\n */\nexport const _Text = __Text => class extends _Input(Roots._Text(__Text || HTMLElement)) {\n};\n\n/**\n * @Number Element\n * @extends _Input() -> Roots._Number() -> __Number\n */\nexport const _Number = __Number => class extends _Input(Roots._Number(__Number || HTMLElement)) {\n};\n\n/**\n * @State Element\n * @extends _Input() -> Roots._State() -> __State\n */\nexport const _State = __State => class extends _Input(Roots._State(__State || HTMLElement)) {\n\n    json(data = null) {\n        if (arguments.length) {\n            this.namespace.input.value = data;\n            return;\n        }\n        return this.namespace.input.checked ? this.namespace.input.value : null;\n    }\n\n};\n","\n/**\n * @imports\n */\nimport * as WidgetElements from './playui-element-mixins.js';\n\n/**\n * ---------------------------\n * @playui widgets\n * ---------------------------\n */\n\nconst FormWidget = class extends WebQit.SubscriptElement(WidgetElements._Collection(HTMLFormElement)) {};\nconst CollectionWidget = class extends WebQit.SubscriptElement(WidgetElements._Collection(HTMLFieldSetElement)) {};\nconst MultipleWidget = class extends WebQit.SubscriptElement(WidgetElements._Multiple(HTMLFieldSetElement)) {};\nconst Multiple2Widget = class extends WebQit.SubscriptElement(WidgetElements._Multiple2(HTMLFieldSetElement)) {};\nconst EnumWidget = class extends WebQit.SubscriptElement(WidgetElements._Enum(HTMLLabelElement)) {};\nconst Enum2Widget = class extends WebQit.SubscriptElement(WidgetElements._Enum2(HTMLLabelElement)) {};\nconst FileWidget = class extends WebQit.SubscriptElement(WidgetElements._File(HTMLLabelElement)) {};\nconst EditorWidget = class extends WebQit.SubscriptElement(WidgetElements._Editor(HTMLLabelElement)) {};\nconst TextWidget = class extends WebQit.SubscriptElement(WidgetElements._Text(HTMLLabelElement)) {};\nconst NumberWidget = class extends WebQit.SubscriptElement(WidgetElements._Number(HTMLLabelElement)) {};\nconst StateWidget = class extends WebQit.SubscriptElement(WidgetElements._State(HTMLLabelElement)) {};\ncustomElements.define('playui-form-widget', FormWidget, { extends: 'form' });\ncustomElements.define('playui-collection-widget', CollectionWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple-widget', MultipleWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple2-widget', Multiple2Widget, { extends: 'fieldset' });\ncustomElements.define('playui-enum-widget', EnumWidget, { extends: 'label' });\ncustomElements.define('playui-enum2-widget', Enum2Widget, { extends: 'label' });\ncustomElements.define('playui-file-widget', FileWidget, { extends: 'label' });\ncustomElements.define('playui-editor-widget', EditorWidget, { extends: 'label' });\ncustomElements.define('playui-text-widget', TextWidget, { extends: 'label' });\ncustomElements.define('playui-number-widget', NumberWidget, { extends: 'label' });\ncustomElements.define('playui-state-widget', StateWidget, { extends: 'label' });\n"],"sourceRoot":""}