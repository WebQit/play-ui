{"version":3,"file":"main.js","mappings":"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","sources":["webpack://@webqit/playui-form/webpack/bootstrap","webpack://@webqit/playui-form/webpack/runtime/define property getters","webpack://@webqit/playui-form/webpack/runtime/hasOwnProperty shorthand","webpack://@webqit/playui-form/webpack/runtime/make namespace object","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/getType.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/internals.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isArray.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isTypeFunction.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isNull.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isUndefined.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isTypeObject.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isEmpty.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isFunction.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isNumber.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isNumeric.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isObject.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isString.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/from.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isTypeArray.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/equals.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/intersect.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/utils.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/mixin.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Firebase.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Fireable.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Interceptor.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/each.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Action.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Interceptors.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actors/unproxy.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/_exec.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/apply.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/construct.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/first.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/startsWith.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/after.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/indexOfSet.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Event.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Observer.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/any.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Mutation.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/core/Observers.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/last.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/get.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/mergeCallback.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/getAllPropertyNames.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/getPrototypeChain.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/pushUnique.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/merge.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/reactions/observe.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/connectors/link.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/connectors/build.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/reactions/unobserve.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/connectors/unlink.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/has.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/_setOrDefine.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/defineProperty.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/deleteProperty.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/getOwnPropertyDescriptor.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/getPrototypeOf.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/isExtensible.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/ownKeys.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/preventExtensions.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/set.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actions/setPrototypeOf.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/obj/copy.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/unique.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/index.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actors/accessorize.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actors/unaccessorize.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/actors/proxy.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isClass.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/reactions/intercept.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/reactions/unintercept.js","webpack://@webqit/playui-form/./node_modules/@webqit/observer/src/reactions/closure.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/str/toTitle.js","webpack://@webqit/playui-form/./src/utils/util.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/arr/difference.js","webpack://@webqit/playui-form/./src/schema-mixins.js","webpack://@webqit/playui-form/./node_modules/@webqit/util/js/isBoolean.js","webpack://@webqit/playui-form/./src/playui-mixins.js","webpack://@webqit/playui-form/./src/playui-element-mixins.js","webpack://@webqit/playui-form/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\n/**\n * Returns the val's type.\n *\n * @param string \tval\n *\n * @return string\n */\nexport default function(val) {\n\treturn typeof val;\n};\n","\n/**\n * Creates and/or returns an \"internals\" object for the given object.\n * \n * @param Any obj\n * @param String namespace\n * \n * @return Object\n */\nexport default function internals(obj, ...namespaces) {\n    if (!globalThis.WebQitInternalsRegistry) {\n        globalThis.WebQitInternalsRegistry = new Map;\n    }\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\n    if (!itnls) {\n        itnls = new Map;\n        if (namespaces[0] === false) {\n            // FALSE means: Return orphan Map if not exists\n            return itnls;\n        }\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\n    }\n    var _ns, _itnls;\n    while ((_ns = namespaces.shift())) {\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\n            itnls = new Map;\n            if (namespaces[0] === false) {\n                // FALSE means: Return orphan Map if not exists\n                return itnls;\n            }\n            _itnls.set(_ns, itnls);\n        }\n    }\n    return itnls;\n}","\n/**\n * Tells if val is of type \"array\".\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val);\n};\n","\n/**\n * Tells if val is of type \"function\".\n * This holds true for both regular functions and classes.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn typeof val === 'function';\n};\n","\n/**\n * Tells if val is undefined or is null.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === null || val === '';\n};\n","\n/**\n * Tells if val is undefined or is of type \"undefined\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\n};\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"object\".\n * This holds true for anything object, including built-ins.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\n};\n","\n/**\n * @imports\n */\nimport _isNull from './isNull.js';\nimport _isUndefined from './isUndefined.js';\nimport _isTypeObject from './isTypeObject.js';\n\n/**\n * Tells if val is empty in its own type.\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\n * objects without keys, empty arrays.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\n};\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"function\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\n};\n","\n/**\n * Tells if val is of type \"number\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof Number || (typeof val === 'number');\n};\n","\n/**\n * @imports\n */\nimport _isNumber from './isNumber.js';\n/**\n * Tells if val is of type \"string\" or a numeric string.\n * This holds true for both numbers and numeric strings.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\n};\n","\n/**\n * Tells if val is pure object.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\n};\n","\n/**\n * Tells if val is of type \"string\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isTypeArray from '../js/isTypeArray.js';\nimport _isEmpty from '../js/isEmpty.js';\nimport _isObject from '../js/isObject.js';\n\n/**\n * Casts an array-like object to an array.\n *\n * @param mixed \tval\n * @param bool\t \tcastObject\n *\n * @return array\n */\nexport default function(val, castObject = true) {\n\tif (_isArray(val)) {\n\t\treturn val;\n\t};\n\tif (!castObject && _isObject(val)) {\n\t\treturn [val];\n\t};\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\n\t\treturn [];\n\t};\n\tif (_isTypeArray(val)) {\n\t\treturn Array.prototype.slice.call(val);\n\t};\n\tif (_isObject(val)) {\n\t\treturn Object.values(val);\n\t};\n\treturn [val];\n};\n","\n/**\n * @imports\n */\nimport _isString from './isString.js';\nimport _isUndefined from './isUndefined.js';\n\n/**\n * Tells if val is \"array-like\".\n * This holds true for anything that has a length property.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !_isString(val) && !_isUndefined(val.length);\n};\n","\n/**\n * Tells if two arrays are shallow equals.\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe\n * \n * @returns Bool\n */\nexport default function equals(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? a.join('.') === b.join('.') \n\t\t: a.length === b.length && a.reduce((prev, value, i) => prev && value === b[i], true);\n}","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the intersection of two arrays;\n * optionally using a custom matching function.\n *\n * @param array \tarr\n * @param array\t \tarr2\n * @param function \tcallback\n *\n * @return array\n */\nexport default function(arr, arr2, callback = null) {\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \n\t\t? arr2.filter(val2 => callback(val1, val2)).length \n\t\t: arr2.indexOf(val1) !== -1\n\t);\n};\n","\n/**\n * @imports\n */\nimport { _isArray } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _all } from '@webqit/util/arr/index.js';\n\n\n/**\n *  Returns paths in 2-dimensional form.\n * \n * - key                    => [ [key] ]\n * - [key]                  => [ [key] ]\n * - [key, key2]            => [ [key, key2] ]\n * - [ [key] ]              => [ [key] ]\n * - [ [key1, key2] ]       => [ [key1, key2] ]\n * \n * @param Array|String paths\n * \n * @return Array\n */\nexport function paths2D(paths) {\n\treturn (pathsIs2D(paths) ? paths : (_arrFrom(paths).length ? [paths] : []))\n\t\t.reduce((multiple, path) => multiple.concat([_arrFrom(path)]), [])\n\t\t.map(path => DotSafePath.resolve(path));\n}\nexport class DotSafePath extends Array {\n\tstatic resolve(path) {\n\t\t// Note the concat() below...\n\t\t// the spread operator: new DotSafePath(...path) doesn't work when path is [0].\n\t\treturn path.every(v => !(v + '').includes('.')) ? (new DotSafePath).concat(path) : path;\n\t}\n\tget dotSafe() { return true }\n}\n\n/**\n * OTHER HELPERS\n */\n\nexport function pathsIs2D(paths) {\n\treturn _arrFrom(paths).reduce((yes, path) => yes || _isArray(path), false);\n}\nexport function pathsIsDynamic(pathArray) {\n\t// Note that trying to simply match empty slots, as in: pathArray.filter(seg => !seg && seg !== 0).length\n\t// doesn't work when the empty slots are really empty slote, as in: [ 'key', <1 empty item> ]\n\treturn pathArray.filter(seg => seg || seg === 0).length !== pathArray.length;\n}\nexport function paths2DIsDynamic(paths) {\n\treturn paths.filter(pathArray => pathsIsDynamic(_arrFrom(pathArray))).length > 0;\n}\n\n","\n/**\n * @imports\n */\nimport _isArray from './isArray.js';\nimport _isFunction from './isFunction.js';\nimport _arrLast from '../arr/last.js';\nimport _mergeCallback from '../obj/mergeCallback.js';\nimport _each from '../obj/each.js';\n\n/**\n * A multi-inheritance implementstion.\n *\n * @param array\t \t...classes\n *\n * @return object\n */\nconst Implementations = new Map;\nexport default function mixin(...classes) {\n\t\n\tvar Traps = {};\n\tvar RetrnDirective = 'last';\n\tif (_isArray(arguments[0])) {\n\t\tclasses = arguments[0];\n\t\tTraps = arguments[1];\n\t\tif (arguments[2]) {\n\t\t\tRetrnDirective = arguments[2];\n\t\t}\n\t}\n\t// -----------------------\n\tvar Base = _arrLast(classes);\n\tvar supersMap = {};\n\t// -----------------------\n\t// Create the Mixin\n\t// ...with a special constructor.\n\t// -----------------------\n\tvar Mixin = class {\n\t\tconstructor(...args) {\n\t\t\tclasses.forEach((_class, i) => {\n\t\t\t\tReflect.construct(_class, args, this.constructor);\n\t\t\t});\n\t\t}\n\t};\n\t// -----------------------\n\t// Implement a special handler of the \"instanceof\" operator.\n\t// -----------------------\n\tclasses.forEach((_class, i) => {\n\t\tif (!Implementations.has(_class)) {\n\t\t\tImplementations.set(_class, []);\n\t\t\ttry {\n\t\t\t\tvar originalInstanceChecker = _class[Symbol.hasInstance];\n\t\t\t\tObject.defineProperty(_class, Symbol.hasInstance, {value: function(instance) {\n\t\t\t\t\tif (originalInstanceChecker.call(this, instance)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif (Implementations.has(this)) {\n\t\t\t\t\t\treturn Implementations.get(this).reduce((yes, _mixin) => yes || (instance instanceof _mixin), false);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}});\n\t\t\t} catch (e) {\n\t\t\t\tthrow new Error('Cannot mixin the class at index ' + i + '. Class may already have been configured for instance checks somewhere.');\n\t\t\t}\n\t\t}\n\t\tImplementations.get(_class).push(Mixin);\n\t});\n\t// ---------------------\n\t// Mixin both static and instance properties and methods\n\t// ---------------------\n\tclasses.forEach(_class => {\n\t\t// Copy const members\n\t\t_mergeCallback([Mixin, _class], (key, obj1, obj2) => ![\n\t\t\t'name', 'prototype', 'prototypes', 'length', 'caller', 'callee', 'arguments', 'constructor', 'apply', \"bind\", 'call', 'toString',/**/\n\t\t].includes(key), true/*deepProps*/);\n\t\t_mergeCallback([Mixin.prototype, _class.prototype], (key, obj1, obj2) => {\n\t\t\tif (!['prototype', 'prototypes'].includes(key)) {\n\t\t\t\tif (_isFunction(obj2[key])) {\n\t\t\t\t\tif (_isArray(supersMap[key])) {\n\t\t\t\t\t\tsupersMap[key].push(obj2[key]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsupersMap[key] = [obj2[key]];\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}, true/*deepProps*/);\n\t});\n\t// Extend (proxy) methods\n\t_each(supersMap, (name, supers) => {\n\t\tif (name === 'constructor') {\n\t\t\treturn;\n\t\t}\n\t\t// NOTE: this must not be defined as an arrow function\n\t\t// for the benefit of the \"this\".\n\t\tMixin.prototype[name] = function(...args) {\n\t\t\tif (Object.hasOwnProperty(Traps, name) && _isFunction(Traps[name])) {\n\t\t\t\t// Wrap a call to the trap...\n\t\t\t\t// So mixin supers are passed to traps\n\t\t\t\treturn Traps[name].call(this, supers, ...args);\n\t\t\t} else {\n\t\t\t\t// Call each super and return\n\t\t\t\t// the last one's return value\n\t\t\t\tvar supersReturnValues = [];\n\t\t\t\tsupers.forEach(supr => {\n\t\t\t\t\tsupersReturnValues.push(supr.call(this, ...args));\n\t\t\t\t})\n\t\t\t\treturn _arrLast(supersReturnValues);\n\t\t\t}\n\t\t};\n\t});\n\treturn Mixin;\n};","\n/**\n * @imports\n */\nimport { _isTypeObject, _isFunction, _getType, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _intersect, _equals as _arrEquals } from '@webqit/util/arr/index.js';\nimport { paths2D } from './utils.js'\n\n/**\n * ---------------------------\n * The Firebase class\n * ---------------------------\n */\n\nexport default class Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tthis.target = target;\n\t\tthis.fireables = [];\n\t\tthis.currentlyFiring = [];\n\t}\n\t\n\t/**\n\t * Adds an Fireable instance\n\t * with optional tags.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return Fireable\n\t */\n\tadd(fireable) {\n\t\tthis.fireables.push(fireable);\n\t\treturn fireable;\n\t}\n\t\n\t/**\n\t * Removes fireables by instance.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return void\n\t */\n\tremove(fireable) {\n\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t}\n\t\n\t/**\n\t * Removes fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tremoveMatches(dfn) {\n\t\tthis.match(dfn).forEach(fireable => {\n\t\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t\t});\n\t}\n\t\n\t/**\n\t * Finds fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return array\n\t */\n\tmatch(dfn) {\n\t\treturn this.fireables.filter(fireable => {\n\t\t\tvar fireableFilter = paths2D(fireable.filter);\n\t\t\tvar fireableTags = _arrFrom((fireable.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\tvar dfnFilter = paths2D(dfn.filter);\n\t\t\tvar dfnTags = _arrFrom((dfn.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\treturn (!dfn.originalHandler || fireable.handler === dfn.originalHandler)\n\t\t\t\t&& (!dfnFilter.length || _arrEquals(dfnFilter, fireableFilter))\n\t\t\t\t&& (!dfnTags.length || (dfnTags.length === fireableTags.length && _intersect(fireableTags, dfnTags).length === dfnTags.length));\n\t\t});\n\t}\n\t\t\n\t/**\n\t * Returns a observer-specific object embedded on an element.\n\t *\n\t * @param string\t\ttype\n\t * @param array|object\ttarget\n\t * @param bool      \tcreateIfNotExists\n\t * @param string      \tnamespace\n\t *\n\t * @return Firebase\n\t */\n\tstatic _getFirebase(type, target, createIfNotExists = true, namespace = this.__namespace) {\n\t\tif (!_isTypeObject(target)) {\n\t\t\tthrow new Error('Subject must be of type object; \"' + _getType(target) + '\" given!');\n\t\t}\n\t\tvar ImplementationClass = this;\n\t\tif (namespace && globalThis.WebQitObserverNamespaceRegistry.has(type + '-' + namespace)) {\n\t\t\tImplementationClass = globalThis.WebQitObserverNamespaceRegistry.get(type + '-' + namespace);\n\t\t\ttype += '-' + namespace\n\t\t}\n\t\tif (!_internals(target, 'firebases').has(type) && createIfNotExists) {\n\t\t\t_internals(target, 'firebases').set(type, new ImplementationClass(target));\n\t\t}\n\t\treturn _internals(target, 'firebases').get(type);\n\t}\n\n\t/**\n\t * Extend a Fireable Class with a namespace.\n\t *\n\t * @param string\t\tnamespace\n\t * @param class      \tImplementationClass\n\t *\n\t * @return void|class\n\t */\n\tstatic _namespace(type, namespace, ImplementationClass = null) {\n\t\ttype += '-' + namespace;\n\t\tif (arguments.length === 2) {\n\t\t\treturn globalThis.WebQitObserverNamespaceRegistry.get(type);\n\t\t}\n\t\tif (!(ImplementationClass.prototype instanceof this)) {\n\t\t\tthrow new Error(`The implementation of the namespace ${this.name}.${namespace} must be a subclass of ${this.name}.`);\n\t\t}\n\t\tglobalThis.WebQitObserverNamespaceRegistry.set(type, ImplementationClass);\n\t\tImplementationClass.__namespace = namespace;\n\t}\n}\n\nif (!globalThis.WebQitObserverNamespaceRegistry) {\n\tglobalThis.WebQitObserverNamespaceRegistry = new Map();\n}\n","\n/**\n * ---------------------------\n * The Fireable class\n * ---------------------------\n */\n\nexport default class Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object|array\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tthis.handler = dfn.handler;\n\t\tthis.filter = dfn.filter;\n\t\tthis.params = dfn.params;\n\n\t}\n\n\t/**\n\t * Sets a \"disconnected\" flag on the Fireable.\n\t *\n\t * @return void\n\t */\n\tdisconnect() {\n\t\tthis.disconnected = true;\n\t}\n}","\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _intersect } from '@webqit/util/arr/index.js';\nimport Fireable from './Fireable.js';\n\n/**\n * ---------------------------\n * The Trap class\n * ---------------------------\n */\n\nexport default class Interceptor extends Fireable {\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's fields.\n\t *\n\t * @param Event\t\t\t \t\t\tevent\n\t * @param function\t\t\t\t\tnext\n\t * @param mixed\t\t\t\t\t \trecieved\n\t *\n\t * @return void\n\t */\n\tfire(event, next, recieved) {\n\t\tif (this.disconnected || (this.filter && !_intersect(_arrFrom(this.filter), [event.type]).length)) {\n\t\t\treturn next(...Array.prototype.slice.call(arguments, 2));\n\t\t}\n\t\treturn this.handler(event, recieved, next);\n\t}\n}","\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\n\n/**\n * Loops thru obj flatly with a callback function.\n * Stops when callback returns a non-undefined value.\n *\n * @param array|object \t\t\tobj \t\t\tThe array or object to iterate.\n * @param function \t\t\t\tcallback \t\tThe callback function.\n *\n * @return mixed|null\t\t\tAny non-null return from callback\n */\nexport default function(obj, callback) {\n\tvar returnValue = undefined;\n\tif (_isTypeObject(obj)) {\n\t\tObject.keys(obj).forEach((k, i) => {\n\t\t\tif (returnValue !== false) {\n\t\t\t\treturnValue = callback(_isNumeric(k) ? parseFloat(k) : k, obj[k], i);\n\t\t\t}\n\t\t});\n\t}\n\treturn returnValue;\n};\n","\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Action {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.type) {\n\t\t\tthrow new Error('Action type must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tObject.seal(this);\n\t}\n}","\n/**\n * @imports\n */\nimport Firebase from './Firebase.js';\nimport Interceptor from './Interceptor.js';\nimport Action from './Action.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Interceptors extends Firebase {\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Interceptor(this.target, dfn));\n\t}\n\n\t/**\n\t * Fires all interceptors with the given action.\n\t *\n\t * @param Action\t\t\taction\n\t * @param function\t\t\tdefaultHandler\n\t *\n\t * @return mixed\n\t */\n\tfire(action, defaultHandler = null) {\n\t\tif (!(action instanceof Action)) {\n\t\t\taction = new Action(this.target, action);\n\t\t}\n\t\tif (this.currentlyFiring.filter(a => a.type === action.type && a.name === action.name).length) {\n\t\t\treturn defaultHandler ? defaultHandler() : undefined;\n\t\t}\n\t\tthis.currentlyFiring.push(action);\n\t\tconst next = (index, ..._args) => {\n\t\t\tvar interceptor = this.fireables[index];\n\t\t\tif (interceptor) {\n\t\t\t\treturn interceptor.fire(action, (...args) => {\n\t\t\t\t\treturn next(index + 1, ...args);\n\t\t\t\t}/*next*/, ..._args);\n\t\t\t}\n\t\t\treturn defaultHandler ? defaultHandler(..._args) : _args[0];\n\t\t};\n\t\tvar value = next(0);\n\t\tthis.currentlyFiring.pop();\n\t\treturn value;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('interceptor', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('interceptor', ...arguments);\n\t}\n}","\n/**\n * @imports\n */\nimport { _internals } from '@webqit/util/js/index.js';\n\n/**\n * Returns the original object earlier proxied by proxy().\n *\n * @param Proxy|Any\t\ttarget\n *\n * @return Any\n */\nexport default function(target) {\n    // Proxy targets are mapped to their own instances internally\n    return _internals(target, false).get(target) || target;\n}\n","\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a Reflect operation of the specified type.\n *\n * @param string\t\ttype\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(type, target, payload = {}, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\t// Execute any \"keys\" traps, otherwise \"test\" the default way\n\tvar interceptors, defaultHandler = function(_val) {\n\t\treturn arguments.length ? _val : Reflect[type](target, ...Object.values(payload));\n\t};\n\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\treturn interceptors.fire({ type, ...payload }, defaultHandler);\n\t}\n\treturn defaultHandler();\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs an \"apply\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tthisArgument\n * @param array\t\t\targumentsList\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, thisArgument, argumentsList, params = {}) {\n\treturn _exec('apply', target, { thisArgument, argumentsList }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"construct\" operation on a target.\n *\n * @param array|object\ttarget\n * @param array\t\t\targumentsList\n * @param object\t\tnewTarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, argumentsList, newTarget = null, params = {}) {\n\treturn _exec('construct', target, arguments.length > 2 ? { argumentsList, newTarget } : { argumentsList }, params);\n}\n","\n/**\n * Returns THE FIRST ENTRY OR A NUMBER OF ENTRIES counting forward from the begining.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\tvar count = 0;\n\tarr.forEach(itm => {\n\t\tcount ++;\n\t});\n\tvar firsts = arr.slice(arr.length - count, amount);\n\treturn arguments.length > 1 ? firsts : firsts[0];\n};\n","\n/**\n * Tells if the array \"a\" starts with array \"b\".\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe \n * \n * @returns Bool\n */\nexport default function startsWith(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? (a.join('.') + '.').startsWith(b.join('.') + '.') \n\t\t: b.reduce((prev, value, i) => prev && value === a[i], true);\n}","\n/**\n * @imports\n */\nimport _after from '../str/after.js';\nimport _indexOfSet from './indexOfSet.js';\n\n/**\n * Returns members of array \"a\" after the array \"b\" subset.\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last \n * \n * @returns Bool\n */\nexport default function after(a, b, fromInex = null, last = false) {\n\tvar subsetIndex = _indexOfSet(a, b, fromInex, last);\n\treturn subsetIndex === -1 ? [] : a.slice(subsetIndex + b.length);\n}","\n/**\n * Returns the index of subset array \"b\" in array \"a\".\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last\n * \n * @returns Int\n */\nexport default function indexOfSet(a, b, fromInex = null, last = false) {\n    if (b.length > a.length) return -1;\n\treturn (typeof fromInex === 'number' ? (last ? a.slice(0, (fromInex + 1) + (fromInex < 0 ? a.length : 0)) : a.slice(fromInex)) : a).reduce((cursors, value, i) => {\n        var [ index, cursorA, cursorB ] = cursors;\n        if (!last && index > -1) {\n            return [index, cursorA, cursorB];\n        }\n        var _cursorB = cursorB + 1;\n        var _cursors = value === b[_cursorB] ? (_cursorB === 0 ? [i, 0] : [cursorA, _cursorB]) : [-1, -1];\n        if (_cursors[1] === b.length - 1) {\n            // Reset B cursor\n            _cursors[1] = -1;\n            if (_cursors[0] > -1) {\n                return [_cursors[0]].concat(_cursors);\n            }\n        }\n        return [index].concat(_cursors);\n    }, [-1, -1, -1])[0] + (last || typeof fromInex !== 'number' ? 0 : (fromInex > -1 ? fromInex : a.length - fromInex));\n}","\n/**\n * @imports\n */\nimport { _isUndefined, _isObject } from '@webqit/util/js/index.js';\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The Event class\n * ---------------------------\n */\n\nexport default class Event {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return void\n\t */\n\tconstructor(target, cancellable = false) {\n\t\tthis._ = {};\n\t\tthis._.target = target;\n\t\tthis._.cancellable = cancellable;\n\t\tthis._.propagationStopped = false;\n\t\tthis._.defaultPrevented = false;\n\t\tthis._.promisesInstance = null;\n\t\tthis._.promises = [];\n\t}\n\n\t/**\n\t * Gets the \"target\" object.\n\t *\n\t * @return array|object\n\t */\n\tget target() {\n\t\treturn this._.target;\n\t}\n\n\t/**\n\t * Gets the \"cancellable\" flag.\n\t *\n\t * @return bool\n\t */\n\tget cancellable() {\n\t\treturn this._.cancellable;\n\t}\n\n\t/**\n\t * -----------------------\n\t * RESPONSE HANDLERS\n\t * -----------------------\n\t */\n\n\t/**\n\t * Stops the evnt from reaching other listeners.\n\t *\n\t * @return bool\n\t */\n\tstopPropagation() {\n\t\tthis._.propagationStopped = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if stopPropagation() has been called.\n\t *\n\t * @return bool\n\t */\n\tget propagationStopped() {\n\t\treturn this._.propagationStopped;\n\t}\n\t\t\n\t/**\n\t * Sets a disposition that asks event initiator not to\n\t * proceed with default action.\n\t *\n\t * @return void\n\t */\n\tpreventDefault() {\n\t\tthis._.defaultPrevented = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if preventDefault() has been called.\n\t *\n\t * @return bool\n\t */\n\tget defaultPrevented() {\n\t\treturn this._.defaultPrevented;\n\t}\n\t\t\n\t/**\n\t * Sets a Promise disposition.\n\t *\n\t * @param Promise\tpromise\n\t *\n\t * @return void\n\t */\n\twaitUntil(promise) {\n\t\tif (promise instanceof Promise) {\n\t\t\tthis._.promises.push(promise);\n\t\t\tthis._.promisesInstance = null;\n\t\t}\n\t}\n\t\t\n\t/**\n\t * (Readonly) returns all promises.\n\t *\n\t * @return Promise|null\n\t */\n\tget promises() {\n\t\tif (!this._.promisesInstance && this._.promises.length) {\n\t\t\tthis._.promisesInstance = Promise.all(this._.promises);\n\t\t}\n\t\treturn this._.promisesInstance;\n\t}\n\t\t\n\t/**\n\t * Evaluates the given disposition value and\n\t * calls an appropriate disposition method.\n\t *\n\t * @params mixed \trspns\n\t *\n\t * @return void\n\t */\n\trespondWith(rspns) {\n\t\tvar proms;\n\t\tvar isEvent = _isObject(rspns) && !_isUndefined(rspns.propagationStopped) && !_isUndefined(rspns.defaultPrevented)\n\t\tif ((rspns === false) || (isEvent && rspns.propagationStopped)) {\n\t\t\tthis.stopPropagation();\n\t\t} else if ((rspns === false) || (isEvent && rspns.defaultPrevented)) {\n\t\t\tthis.preventDefault();\n\t\t} else if ((rspns instanceof Promise && (proms = rspns))\n\t\t|| (isEvent && (proms = rspns.promises))) {\n\t\t\tthis.waitUntil(proms);\n\t\t}\n\t}\n}","\n/**\n * @imports\n */\nimport {\n\t_after as _arrAfter, _startsWith as _arrStartsWith,\n\t_any, _equals as _arrEquals,\n} from '@webqit/util/arr/index.js';\nimport { _isNumeric, _isFunction, _isObject } from '@webqit/util/js/index.js';\nimport { paths2D, pathsIs2D, pathsIsDynamic, paths2DIsDynamic } from './utils.js'\nimport Fireable from './Fireable.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Observer class\n * ---------------------------\n */\n\nexport default class Observer extends Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tsuper(target, dfn);\n\t\t// The rest of this code is designed for a 2-dimensional array.\n\t\tthis.filters2D = paths2D(this.filter);\n\t\tthis.filtersIsOriginally2D = pathsIs2D(this.filter);\n\t\tthis.filtersIsDynamic = paths2DIsDynamic(this.filters2D);\n\t\tif (this.filtersIsDynamic && this.filters2D.length > 1) {\n\t\t\tthrow new Error('Only one \"Dynamic Filter\" must be observed at a time! \"' + this.filters2D.map(pathArray => '[' + pathArray.join(', ') + ']').join(', ') + '\" have been bound together.');\n\t\t}\n\t}\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's filter.\n\t *\n\t * @param array\t\t\t \tchanges\n\t *\n\t * @return void\n\t */\n\tfire(changes) {\n\t\tif (this.disconnected || (this.params.type && !_any(changes, delta => this.params.type === delta.type))) {\n\t\t\treturn;\n\t\t}\n\t\tconst diff = delta => !['set', 'def'].includes(delta.type) || (\n\t\t\t!this.params.diff || (_isFunction(this.params.diff) ? this.params.diff(delta.value, delta.oldValue) : delta.value !== delta.oldValue)\n\t\t);\n\t\tvar evt = new Event(this.target);\n\t\tif (this.filters2D.length) {\n\t\t\tvar matches = changes.filter(delta => {\n\t\t\t\t// one observerPathArray can turn out to be two if dynamic\n\t\t\t\t// OR evt.originatingFields is multiple and this.params.subtree\n\t\t\t\treturn this.filters2D.filter((observerPathArray, i) => {\n\t\t\t\t\tvar observerPathArray_Resolved = observerPathArray.slice();\n\t\t\t\t\tif (this.filtersIsDynamic) {\n\t\t\t\t\t\t// Note that if we had tried to loop thru observerPathArray_Resolved,\n\t\t\t\t\t\t// we wouldn't be able tp access slots that are truly empty, as in: [ 'key', <1 empty item> ]\n\t\t\t\t\t\tdelta.path.forEach((_seg, i) => {\n\t\t\t\t\t\t\tobserverPathArray_Resolved[i] = observerPathArray_Resolved[i] || observerPathArray_Resolved[i] === 0 \n\t\t\t\t\t\t\t\t? observerPathArray_Resolved[i]\n\t\t\t\t\t\t\t\t: _seg;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn (!this.filtersIsDynamic || !pathsIsDynamic(observerPathArray_Resolved)) && diff(delta) && ((!this.params.subtree && _arrEquals(observerPathArray_Resolved, delta.path))\n\t\t\t\t\t\t|| (this.params.suptree && _arrStartsWith(observerPathArray_Resolved, delta.path) && (!_isNumeric(this.params.suptree) || _arrAfter(observerPathArray_Resolved, delta.path).length <= this.params.suptree))\n\t\t\t\t\t\t|| (this.params.subtree && delta.path.length >= observerPathArray_Resolved.length && _arrStartsWith(delta.path, observerPathArray_Resolved) && (!_isNumeric(this.params.subtree) || _arrAfter(delta.path, observerPathArray_Resolved).length <= this.params.subtree))\n\t\t\t\t\t);\n\t\t\t\t}).length;\n\t\t\t});\n\t\t\tif (matches.length) {\n\t\t\t\tif (this.filtersIsOriginally2D || this.params.subtree) {\n\t\t\t\t\tvar changesObject = matches;\n\t\t\t\t\tif (_isObject(this.filter)) {\n\t\t\t\t\t\tchangesObject = {...this.filter};\n\t\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\t\tchangesObject[e.name] = e;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tevt.respondWith(this.handler(changesObject, evt));\n\t\t\t\t} else {\n\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\tevt.respondWith(this.handler(e, evt));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ((this.params.subtree || changes.filter(delta => _arrEquals(delta.path, [delta.name])).length === changes.length) && changes.filter(delta => diff(delta)).length) {\n\t\t\tevt.respondWith(this.handler(changes, evt));\n\t\t}\n\t\treturn evt;\n\t}\n}\n","\n/**\n * Tells if ANY items pass the test.\n *\n * @param array \tarr\n * @param function \tcallback\n *\n * @return bool\n */\nexport default function(arr, callback) {\n\treturn arr.reduce((prevTest, itm, i) => prevTest || callback(itm, i), false);\n};\n","\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\nimport { DotSafePath } from './utils.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Mutation {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.originalSubject) {\n\t\t\tthis.originalSubject = target;\n\t\t}\n\t\tif (!('type' in dfn)) {\n\t\t\tthrow new Error('Mutation type must be given in definition!');\n\t\t}\n\t\tif (!('name' in dfn)) {\n\t\t\tthrow new Error('Property name must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tif (key === 'path') {\n\t\t\t\tvalue = DotSafePath.resolve(value);\n\t\t\t}\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tif (!this.path) {\n\t\t\tObject.defineProperty(this, 'path', {value: DotSafePath.resolve([dfn.name]), enumerable:true});\n\t\t}\n\t\tObject.seal(this);\n\t}\n}","\n/**\n * @imports\n */\nimport { _from as _arrFrom, _remove, _last } from '@webqit/util/arr/index.js';\nimport Firebase from './Firebase.js';\nimport Observer from './Observer.js';\nimport Mutation from './Mutation.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Observers extends Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tsuper(target);\n\t\tthis.buffers = [];\n\t}\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Observer(this.target, dfn));\n\t}\n\t\n\t/**\n\t * Fires all observers with the given evt (change).\n\t *\n\t * @param array|Mutation\t\tchanges\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return Event\n\t */\n\tfire(changes, cancellable) {\n\t\tvar evt = new Event(this.target, cancellable);\n\t\t// We accept multiple changes\n\t\tchanges = _arrFrom(changes, false).map(delta => !(delta instanceof Mutation) ? new Mutation(this.target, delta) : delta);\n\t\tif (this.buffers.length) {\n\t\t\t_last(this.buffers)(changes);\n\t\t\treturn evt;\n\t\t}\n\t\tif (this.currentlyFiring.filter(d => changes.filter(delta => d.type === delta.type && d.name === delta.name).length).length) {\n\t\t\t//return false;\n\t\t}\n\t\t//this.currentlyFiring.push(...changes);\n\t\tthis.fireables.forEach(observer => {\n\t\t\tif (evt.propagationStopped && cancellable) {\n\t\t\t\treturn evt;\n\t\t\t}\n\t\t\tevt.respondWith(observer.fire(changes));\n\t\t});\n\t\t//changes.forEach(delta => _remove(this.currentlyFiring, delta));\n\t\treturn evt;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('observer', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('observer', ...arguments);\n\t}\n}","\n/**\n * @imports\n */\nimport _first from './first.js';\n\n/**\n * Returns THE LAST ENTRY OR A NUMBER OF ENTRIES counting forward to the end.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\treturn arguments.length > 1\n\t\t? _first(arr.slice().reverse(), amount).reverse()\n\t\t: _first(arr.slice().reverse());\n};\n","\n/**\n * @imports\n */\nimport {\n\t_isArray, _isNumeric, _isClass,\n\t_isFunction, _isTypeObject, _internals\n} from '@webqit/util/js/index.js';\nimport { _from as _objFrom } from '@webqit/util/obj/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a \"get\" operation on a target.\n * Fires any such query observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return mixed\n */\nexport default function(target, keys, receiver = null, params = {}) {\n\ttarget = receiver || target;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\tvar _keys = _arrFrom(keys);\n\tvar values = _keys.map(key => {\n\t\t// Execute any \"get\" traps, otherwise \"get\" the default way\n\t\tvar interceptors, defaultGet = function(_value) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _value;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps').has(key) && _internals(target, 'accessorizedProps').get(key).touch(true)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).get();\n\t\t\t}\n\t\t\treturn receiver \n\t\t\t\t? Reflect.get(target, key, receiver) \n\t\t\t\t: Reflect.get(target, key);\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, true, params.namespace)) {\n\t\t\treturn interceptors.fire({type:'get', name: key, related: _keys, receiver}, defaultGet);\n\t\t}\n\t\treturn defaultGet();\n\t});\n\t// ---------------------------------\n\treturn _isArray(keys) ? values : values[0];\n}\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isObject from '../js/isObject.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _getAllPropertyNames from './getAllPropertyNames.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function mergeCallback(objs, callback, deepProps = false, isReplace = false, withSymbols = false) {\n\tvar depth = 0;\n\tvar obj1 = objs.shift();\n\tif (_isNumeric(obj1) || obj1 === true || obj1 === false) {\n\t\tdepth = obj1;\n\t\tobj1 = objs.shift();\n\t}\n\tif (!objs.length) {\n\t\tthrow new Error('_merge() requires two or more array/objects.');\n\t}\n\tobjs.forEach((obj2, i) => {\n\t\tif (!_isTypeObject(obj2) && !_isFunction(obj2)) {\n\t\t\treturn;\n\t\t}\n\t\t(deepProps ? _getAllPropertyNames(obj2) : Object.getOwnPropertyNames(obj2)).forEach(key => {\n\t\t\tif (!callback(key, obj1, obj2, i)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar valAtObj1 = obj1[key];\n\t\t\tvar valAtObj2 = obj2[key];\n\t\t\tif (((_isArray(valAtObj1) && _isArray(valAtObj2)) || (_isObject(valAtObj1) && _isObject(valAtObj2))) \n\t\t\t&& (depth === true || depth > 0)) {\n\t\t\t\t// RECURSE...\n\t\t\t\tobj1[key] = _isArray(valAtObj1) && _isArray(valAtObj2) ? [] : {};\n\t\t\t\tmergeCallback([_isNumeric(depth) ? depth - 1 : depth, obj1[key], valAtObj1, valAtObj2], callback, deepProps, isReplace, withSymbols);\n\t\t\t} else {\n\t\t\t\tif (_isArray(obj1) && _isArray(obj2)) {\n\t\t\t\t\tif (isReplace) {\n\t\t\t\t\t\tobj1[key] = valAtObj2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj1.push(valAtObj2);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// In case we're setting a read-only property\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (withSymbols) {\n\t\t\t\t\t\t\tObject.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj2, key));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj1[key] = obj2[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\treturn obj1;\n};\n","\n/**\n * @imports\n */\nimport _pushUnique from '../arr/pushUnique.js';\nimport _getPrototypeChain from './getPrototypeChain.js';\n\n/**\n * Eagerly retrieves object members all down the prototype chain.\n *\n * @param object\t \tobj\n * @param object\t \tuntil\n *\n * @return array\n */\nexport default function(obj, until) {\n\tvar keysAll = [];\n\t_getPrototypeChain(obj, until).forEach(obj => {\n\t\t_pushUnique(keysAll, ...Object.getOwnPropertyNames(obj));\n\t});\n\treturn keysAll;\n};\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the prototype chain.\n *\n * @param object \t\tobj\n * @param object\t \tuntil\n *\n * @return bool\n */\nexport default function(obj, until) {\n\tuntil = until || Object.prototype;\n\tuntil = until && !_isArray(until) ? [until] : until;\n\t// We get the chain of inheritance\n\tvar prototypalChain = [];\n\tvar obj = obj;\n\twhile((obj && (!until || until.indexOf(obj) < 0) && obj.name !== 'default')) {\n\t\tprototypalChain.push(obj);\n\t\tobj = obj ? Object.getPrototypeOf(obj) : null;\n\t}\n\treturn prototypalChain;\n};\n","\n/**\n * Adds an item if not already exist.\n *\n * @param array \tarr\n * @param array\t \t...itms\n *\n * @return array\n */\nexport default function(arr, ...items) {\n\titems.forEach(itm => {\n\t\tif (arr.indexOf(itm) < 0) {\n\t\t\tarr.push(itm);\n\t\t}\n\t});\n\treturn arr;\n};\n","\n/**\n * @imports\n */\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function(...objs) {\n\treturn _mergeCallback(objs, (k, obj1, obj2) => {\n\t\treturn true;\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\n};\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Adds an observer to an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\thandler\n * @param object\t\t\t\t\tparams\n *\n * @return Observer\n */\nexport default function(target, filter, handler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? handler : {};\n\t\thandler = filter;\n\t\tfilter = null;\n\t}\n\tif (!_isFunction(handler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(handler) + '\" given!');\n\t}\n\tvar existing, observers = Observers.getFirebase(target, true, params.namespace);\n\tvar dfn = {filter, handler, params,};\n\tif (dfn.filter || dfn.params.subtree === '*' || (dfn.params.subtree && isUserObject(target))) {\n\t\tbuild(target, dfn.filter, dfn.params.subtree, params.namespace);\n\t}\n\tif (dfn.params.unique && (existing = observers.match({filter, params})).length) {\n\t\tif (dfn.params.unique !== 'replace') {\n\t\t\treturn existing[0];\n\t\t}\n\t\tobservers.remove(existing[0]);\n\t}\n\treturn observers.add(dfn);\n}\n","\n/**\n * @imports\n */\nimport { _each, _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Mutation from '../core/Mutation.js';\nimport Observers from '../core/Observers.js';\nimport observe from '../reactions/observe.js';\n\n/**\n * Bubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tvalue\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tif (target === value) {\n\t\treturn;\n\t}\n\tvar observers;\n\tobserve(value, (changes, eventObject) => {\n\t\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\t\tvar _changes = changes.map(delta => {\n\t\t\t\t// ------------\n\t\t\t\t// Recursive events must not propagate\n\t\t\t\t// ------------\n\t\t\t\tvar d = delta;\n\t\t\t\tdo {\n\t\t\t\t\tif (d.target === target) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} while(d = d.src);\n\t\t\t\t// ------------\n\t\t\t\t// Create propagation\n\t\t\t\t// ------------\n\t\t\t\tvar dfn = {}; _each(delta, (key, value) => {\n\t\t\t\t\tif (key !== 'target' && key !== 'name' && key !== 'path' && key !== 'src') {\n\t\t\t\t\t\tdfn[key] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdfn.name = field;\n\t\t\t\tdfn.path = [field].concat(delta.path);\n\t\t\t\tdfn.originalSubject = delta.originalSubject;\n\t\t\t\tdfn.src = delta;\n\t\t\t\treturn new Mutation(target, dfn);\n\t\t\t}).filter(c => c);\n\t\t\tif (_changes.length) {\n\t\t\t\treturn observers.fire(_changes, eventObject.cancellable);\n\t\t\t}\n\t\t}\n\t}, {subtree: true, ...params, unique: true, tags: [linkTag, field, target]});\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'set',\n\t\t\tvalue,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tlet eventObject = observers.fire(_event, params.cancellable);\n\t\tif (params.eventTypeReturn) {\n\t\t\treturn eventObject;\n\t\t}\n\t}\n}\n\n/**\n * @var object\n */\nexport const linkTag = {};","\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _before, _after } from '@webqit/util/str/index.js';\nimport { paths2D } from '../core/utils.js';\nimport Observers from '../core/Observers.js';\nimport _get from '../actions/get.js';\nimport link from './link.js';\n\n/**\n * Recursively \"connects\" an object's members to the object\n * for observer actions.\n *\n * @param array|object\ttarget\n * @param string|array\tpaths\n * @param bool\t\t\tsubtree\n * @param String\t\tnamespace\n *\n * @return void\n */\nexport default function build(target, paths = null, subtree = false, namespace = null) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tvar observers = Observers.getFirebase(target, true, namespace);\n\tif (!observers || observers.build) {\n\t\treturn;\n\t}\n\tobservers.build = subtree;\n\t// ---------------------------------\n\t// For paths2D, refer to the comments at class Observer.\n\tvar _paths2D = paths2D(paths);\n\t// If any path starts with a dot, (a wild card path), all keys at this level is implied\n\tvar rootLevelKeysToObserve = !_paths2D.length || _paths2D.filter(path => /*Starts with an empty segment*/!path[0] && path[0] !== 0).length\n\t\t? Object.keys(target)\n\t\t: _paths2D.map(path => path[0]);\n\tvar subLevelKeysToObserve = _paths2D.length ? _paths2D.map(path => path.slice(1)).filter(p => p.length) : null;\n\tobservers.subBuild = subLevelKeysToObserve && subLevelKeysToObserve.length ? subLevelKeysToObserve : null;\n\trootLevelKeysToObserve.forEach(key => {\n\t\tvar value = _get(target, key, null, { namespace });\n\t\ttry {\n\t\t\tif (_isTypeObject(value)) {\n\t\t\t\tlink(target, key, value, null, params);\n\t\t\t\tif ((observers.subBuild && isUserObject(value)) \n\t\t\t\t|| (_isFunction(subtree) ? subtree(value) : (subtree && isUserObject(value)))) {\n\t\t\t\t\tbuild(value, observers.subBuild, subtree, namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {/* instanceof-ing certain primitives may throw */}\n\t});\n}\n\n/**\n * Tells if an object if a User Object.\n * \n * @param Object value\n * \n * @return Bool\n */\nexport const isUserObject = value => ((value instanceof Object) || (value instanceof Array) || (value instanceof Function))\n\t&& (typeof window === 'undefined' || value !== window);\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Removes observers from an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\toriginalHandler\n * @param object\t\t\t\t\tparams\n *\n * @return void\n */\nexport default function(target, filter, originalHandler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? originalHandler : {};\n\t\toriginalHandler = filter;\n\t\tfilter = null;\n\t}\n\tif (originalHandler && !_isFunction(originalHandler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(originalHandler) + '\" given!');\n\t}\n\tvar observers;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\treturn observers.removeMatches({filter, originalHandler, params});\n\t}\n}\n","\n/**\n * @imports\n */\nimport { _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Observers from '../core/Observers.js';\nimport unobserve from '../reactions/unobserve.js';\nimport { linkTag } from './link.js';\n\n/**\n * Unbubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tobject\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tunobserve(value, null, null, {...params, tags:[linkTag, field, target]});\n\tvar observers;\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'del',\n\t\t\toldValue: value,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tobservers.fire(_event, params.cancellable);\n\t}\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"has\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string\t\tname\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('has', target, { name }, params);\n}\n","\n/**\n * @imports\n */\nimport {\n\t_isObject, _isTypeObject, _internals,\n\t_isNumber, _isArray, _isString\n} from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport link from '../connectors/link.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"_setProp\" type of operation on a target.\n * Fires any observers for the specific type that may be bound to target.\n *\n * @param bool\t\t\tdefine\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param Object\t\tparams\n *\n * @return Event\n */\nexport default function(define, target, payload, params = {}) {\n\ttarget = payload.receiver || target;\n\tvar keysOrPayload = payload.keysOrPayload;\n\tvar value = payload.value;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tif (_isObject(keysOrPayload)) {\n\t\tparams = value || {};\n\t\tvalue = null;\n\t}\n\t// ----------\n\ttarget = _unproxy(target);\n\tvar interceptors = Interceptors.getFirebase(target, false, params.namespace),\n\t\tobservers = Observers.getFirebase(target, false, params.namespace);\n\t// ----------\n\tconst handleSet = (key, value, related, detail) => {\n\t\tvar type = 'set', descriptor;\n\t\tif (define) {\n\t\t\ttype = 'defineProperty';\n\t\t\tdescriptor = value || {};\n\t\t\tvalue = descriptor.value;\n\t\t}\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar isUpdate = false, oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\tisUpdate = true;\n\t\t\toldValue = _get(target, key, payload.receiver, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype,\n\t\t\tvalue,\n\t\t\treceiver: payload.receiver,\n\t\t\trelated,\n\t\t\tdetail,\n\t\t\tisUpdate,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// The set operation\n\t\tvar defaultSet = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\tif (descriptor) {\n\t\t\t\t\tdescriptor = _success;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = _success;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (descriptor) {\n\t\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tObject.defineProperty(target, key, descriptor);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).set(value);\n\t\t\t}\n\t\t\ttarget[key] = value;\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors) {\n\t\t\tvar eventObject = descriptor \n\t\t\t\t? {type: 'defineProperty', name: key, descriptor, receiver: payload.receiver, related, detail, isUpdate, oldValue} \n\t\t\t\t: {type: 'set', name: key, value, receiver: payload.receiver, related, detail, isUpdate, oldValue};\n\t\t\te.success = interceptors.fire(eventObject, defaultSet);\n\t\t} else {\n\t\t\te.success = defaultSet();\n\t\t}\n\t\t// ---------------------------------\n\t\tif (e.success && e.value !== e.oldValue) {\n\t\t\t// Unobserve outgoing value for bubbling\n\t\t\tif (_isTypeObject(e.oldValue)) {\n\t\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t\t}\n\t\t\t// Observe incoming value for bubbling\n\t\t\tif (_isTypeObject(e.value)) {\n\t\t\t\tlink(target, key, e.value, null, params);\n\t\t\t\tif (observers && (observers.subBuild || (observers.build && isUserObject(e.value)))) {\n\t\t\t\t\tbuild(e.value, observers.subBuild, observers.build, params.namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn e;\n\t};\n\t// ---------------------------------\n\tvar keys, events = [];\n\tif (_isArray(keysOrPayload) || ((_isString(keysOrPayload) || _isNumber(keysOrPayload)) && (keys = _arrFrom(keysOrPayload)))) {\n\t\tevents = keys.map(key => handleSet(key, value, keys, params.detail));\n\t} else if (_isObject(keysOrPayload) && (keys = Object.keys(keysOrPayload))) {\n\t\tevents = keys.map(key => handleSet(key, keysOrPayload[key], keys, params.detail));\n\t}\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar evt;\n\tif (observers) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n","\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"defineProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, params = {}) {\n\treturn _setOrDefine(true/*define*/, target, { keysOrPayload, value }, params);\n}\n","\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _isTypeObject, _internals } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"deleteProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return Event\n */\nexport default function(target, keys, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\tvar _keys = _arrFrom(keys);\n\tvar events = _keys.map(key => {\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\toldValue = _get(target, key, null, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype: 'deleteProperty',\n\t\t\trelated: _keys,\n\t\t\tdetail: params.detail,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// Execute any \"del\" traps, otherwise \"del\" the default way\n\t\tvar interceptors, defaultDel = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _success;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdelete target[key];\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\t\te.success = interceptors.fire({type: 'deleteProperty', name:key, oldValue, related: _keys}, defaultDel);\n\t\t} else {\n\t\t\te.success = defaultDel();\n\t\t}\n\t\t// ---------------------------------\n\t\t// Unobserve outgoing value for bubbling\n\t\tif (e.success && _isTypeObject(e.oldValue)) {\n\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t}\n\t\treturn e;\n\t});\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar observers, evt;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getOwnPropertyDescriptor\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string|number name\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('getOwnPropertyDescriptor', target, { name }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('getPrototypeOf', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"isExtensible\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('isExtensible', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"ownKeys\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('ownKeys', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"preventExtensions\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('preventExtensions', target, {}, params);\n}\n","\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"set\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, receiver = null, params = {}) {\n\treturn _setOrDefine(false/*define*/, target, arguments.length > 3 ? { keysOrPayload, value, receiver } : { keysOrPayload, value }, params);\n}\n","\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"setPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tprototype\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, prototype, params = {}) {\n\treturn _exec('setPrototypeOf', target, { prototype }, params);\n}\n","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n * Copies an object.\n *\n * @param object\t \tobj\n * @param array\t\t \tfilter\n *\n * @return object\n */\nexport default function(obj, filter = [], withSymbols = true) {\n\tvar depth = 0;\n\tif (_isNumeric(arguments[0]) && _isTypeObject(arguments[1])) {\n\t\tdepth = arguments[0];\n\t\tobj = arguments[1];\n\t\tfilter = arguments[2] || [];\n\t}\n\treturn _mergeCallback([depth, {}, obj], (key, obj1, obj2) => {\n\t\treturn _isFunction(filter) ? filter(key) \n\t\t\t: (_isArray(filter) && filter.length ? filter.indexOf(key) > -1 : true);\n\t}, false/*deepProps*/, false/*isReplace*/, withSymbols);\n};\n","\n/**\n * Returns a list of unique items.\n *\n * @param array\t \t\t\t\tarr\n *\t *\n * @return array\n */\nexport default function(arr) {\n\tconst distinct = (value, index, self) => {\n\t\treturn self.indexOf(value) === index;\n\t};\n\treturn arr.filter(distinct);\n};\n","\n/**\n * @imports\n */\n// Actions\nimport apply from './actions/apply.js';\nimport construct from './actions/construct.js';\nimport defineProperty from './actions/defineProperty.js';\nimport deleteProperty from './actions/deleteProperty.js';\nimport get from './actions/get.js';\nimport getOwnPropertyDescriptor from './actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from './actions/getPrototypeOf.js';\nimport has from './actions/has.js';\nimport isExtensible from './actions/isExtensible.js';\nimport ownKeys from './actions/ownKeys.js';\nimport preventExtensions from './actions/preventExtensions.js';\nimport set from './actions/set.js';\nimport setPrototypeOf from './actions/setPrototypeOf.js';\n// Actors\nimport accessorize from './actors/accessorize.js';\nimport unaccessorize from './actors/unaccessorize.js';\nimport proxy from './actors/proxy.js';\nimport unproxy from './actors/unproxy.js';\n// Reactions\nimport observe from './reactions/observe.js';\nimport unobserve from './reactions/unobserve.js';\nimport intercept from './reactions/intercept.js';\nimport unintercept from './reactions/unintercept.js';\nimport closure from './reactions/closure.js';\n// Connectors\nimport build from './connectors/build.js';\nimport link from './connectors/link.js';\nimport unlink from './connectors/unlink.js';\n// Core\nimport Observers from './core/Observers.js';\nimport Interceptors from './core/Interceptors.js';\n\n/**\n * @exports\n */\nexport default {\n\t// Actions\n\tapply,\n\tconstruct,\n\tdefineProperty,\n\tdeleteProperty,\n\tget,\n\tgetOwnPropertyDescriptor,\n\tgetPrototypeOf,\n\thas,\n\tisExtensible,\n\townKeys,\n\tpreventExtensions,\n\tset,\n\tsetPrototypeOf,\n\t// Actors\n\taccessorize,\n\tunaccessorize,\n\tproxy,\n\tunproxy,\n\t// Reactions\n\tobserve,\n\tunobserve,\n\tintercept,\n\tunintercept,\n\tclosure,\n\t// Connectors\n\tbuild,\n\tlink,\n\tunlink,\n\t// Core\n\tObservers,\n\tInterceptors,\n}","\n/**\n * @imports\n */\nimport { _isArray, _internals } from '@webqit/util/js/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport _get from '../actions/get.js';\nimport _set from '../actions/set.js';\n\n/**\n * Initializes \"Reflxive getter/setter\" traps on the target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return bool|array\n */\nexport default function(target, keys = [], params = {}) {\n\tparams = _isObject(keys) ? keys : params;\n\tvar successFlags = (arguments.length === 1 ? Object.keys(target) : _arrFrom(keys)).map(key => {\n\t\tif (_internals(target, 'accessorizedProps').has(key) && _internals(target, 'accessorizedProps').get(key).touch(true)) {\n\t\t\treturn false;\n\t\t}\n\t\t// ----------\n\t\tconst getDescriptorDeep = () => {\n\t\t\tvar descriptor, proto = target;\n\t\t\twhile (!descriptor && (proto = Object.getPrototypeOf(proto))) {\n\t\t\t\tdescriptor = Object.getOwnPropertyDescriptor(proto, key);\n\t\t\t}\n\t\t\treturn descriptor;\n\t\t};\n\t\t// ----------\n\t\tvar originalOwnDescriptor = Object.getOwnPropertyDescriptor(target, key),\n\t\t\taltOriginalOwnDescriptor,\n\t\t\tactiveIsAltOriginalOwnDescriptor;\n\t\tif (!originalOwnDescriptor) {\n\t\t\t// Not an own property\n\t\t\t// and maybe not even defined at all in the prototype chain\n\t\t\taltOriginalOwnDescriptor = {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: key in target ? false/* existing but inherited*/ : true,\n\t\t\t\tconfigurable: params.configurable !== false,\n\t\t\t};\n\t\t}\n\t\t// ----------\n\t\tvar reactiveOwnDescriptor = { ...(originalOwnDescriptor || altOriginalOwnDescriptor) };\n\t\tif ('value' in reactiveOwnDescriptor) {\n\t\t\tdelete reactiveOwnDescriptor.value;\n\t\t}\n\t\tif ('writable' in reactiveOwnDescriptor) {\n\t\t\tdelete reactiveOwnDescriptor.writable;\n\t\t}\n\t\t// ----------\n\t\treactiveOwnDescriptor.get = () => {\n\t\t\tif (controlObject.ongoingGets.length) {\n\t\t\t\t// .touch(true)\n\t\t\t\treturn controlObject.get();\n\t\t\t}\n\t\t\t// _get() will return here\n\t\t\t// but to call controlObject.get();\n\t\t\tcontrolObject.ongoingGets.push(1);\n\t\t\tvar value = _get(target, key, null, params);\n\t\t\tcontrolObject.ongoingGets.pop();\n\t\t\treturn value;\n\t\t};\n\t\tvar setting;\n\t\treactiveOwnDescriptor.set = newValue => {\n\t\t\tif (controlObject.ongoingSets.length) {\n\t\t\t\treturn controlObject.set(newValue);\n\t\t\t}\n\t\t\t// _set() will return here\n\t\t\t// but to call controlObject.set();\n\t\t\tcontrolObject.ongoingSets.push(1);\n\t\t\tvar operation = _set(target, key, newValue, null, params);\n\t\t\tcontrolObject.ongoingSets.pop();\n\t\t\treturn operation;\n\t\t};\n\t\t// ----------\n\t\tvar controlObject = {\n\t\t\tongoingGets: [],\n\t\t\tongoingSets: [],\n\t\t\tget: function() {\n\t\t\t\t// ---------------------\n\t\t\t\tvar descriptor = originalOwnDescriptor;\n\t\t\t\tif (!descriptor) {\n\t\t\t\t\tif (activeIsAltOriginalOwnDescriptor) {\n\t\t\t\t\t\t// Already switched to altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// getDescriptorDeep() or altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = getDescriptorDeep() || altOriginalOwnDescriptor;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// ---------------------\n\t\t\t\treturn descriptor.get ? descriptor.get.call(target) : descriptor.value;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\t// ---------------------\n\t\t\t\tvar descriptor = originalOwnDescriptor;\n\t\t\t\tif (!descriptor) {\n\t\t\t\t\tif (activeIsAltOriginalOwnDescriptor) {\n\t\t\t\t\t\t// Already switched to altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t} else if (descriptor = getDescriptorDeep()) {\n\t\t\t\t\t\tif (('value' in descriptor)) {\n\t\t\t\t\t\t\t// Deep is data property.\n\t\t\t\t\t\t\t// We should rather switch to altOriginalOwnDescriptor\n\t\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t\t\tactiveIsAltOriginalOwnDescriptor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Not yet switched to altOriginalOwnDescriptor\n\t\t\t\t\t\t// and no getDescriptorDeep()\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t\tactiveIsAltOriginalOwnDescriptor = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// ---------------------\n\t\t\t\tif (descriptor.set || descriptor.get) {\n\t\t\t\t\tif (!descriptor.set) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t// Can sometimes return undefined\n\t\t\t\t\treturn descriptor.set.call(target, value);\n\t\t\t\t}\n\t\t\t\tdescriptor.value = value;\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\trestore: function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.intact()) {\n\t\t\t\t\t\tif (originalOwnDescriptor || activeIsAltOriginalOwnDescriptor /* switched */) {\n\t\t\t\t\t\t\tObject.defineProperty(target, key, originalOwnDescriptor || altOriginalOwnDescriptor /* switch target */);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete target[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_internals(target, 'accessorizedProps').delete(key);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} catch(e) {}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tintact: function() {\n\t\t\t\treturn (Object.getOwnPropertyDescriptor(target, key) || {}).get === reactiveOwnDescriptor.get;\n\t\t\t},\n\t\t\ttouch: function(attemptRestore = false) {\n\t\t\t\t// If intact, or not intact but not restorable, return true - \"valid\"\n\t\t\t\treturn this.intact() || (attemptRestore ? !this.restore() : false);\n\t\t\t},\n\t\t}\n\t\t// ----------\n\t\ttry {\n\t\t\tObject.defineProperty(target, key, reactiveOwnDescriptor);\n\t\t\t_internals(target, 'accessorizedProps').set(key, controlObject);\n\t\t\treturn true;\n\t\t} catch(e) {}\n\t\treturn false;\n\t});\n\treturn _isArray(keys) ? successFlags : successFlags[0];\n}\n","\n/**\n * @imports\n */\nimport { _isArray, _isObject, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\n\n/**\n * Removes previously initialized \"Reflxive getter/setter\" traps from the target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return bool|array\n */\nexport default function(target, keys = [], params = {}) {\n\tparams = _isObject(keys) ? keys : params;\n\tvar successFlags = (arguments.length === 1 ? Object.keys(target) : _arrFrom(keys)).map(key => {\n\t\tif (_internals(target, 'accessorizedProps', false).has(key)) {\n\t\t\treturn _internals(target, 'accessorizedProps').get(key).restore();\n\t\t}\n\t\treturn true;\n\t});\n\treturn _isArray(keys) ? successFlags : successFlags[0];\n}\n","\n/**\n * @imports\n */\nimport {\n    _isClass, _isFunction, _isTypeObject,\n    _getType, _internals,\n} from '@webqit/util/js/index.js';\nimport apply from '../actions/apply.js';\nimport construct from '../actions/construct.js';\nimport defineProperty from '../actions/defineProperty.js';\nimport deleteProperty from '../actions/deleteProperty.js';\nimport get from '../actions/get.js';\nimport getOwnPropertyDescriptor from '../actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from '../actions/getPrototypeOf.js';\nimport has from '../actions/has.js';\nimport isExtensible from '../actions/isExtensible.js';\nimport ownKeys from '../actions/ownKeys.js';\nimport preventExtensions from '../actions/preventExtensions.js';\nimport set from '../actions/set.js';\nimport setPrototypeOf from '../actions/setPrototypeOf.js';\n\n/**\n * Returns an object as a proxy and binds all instance methods\n * to the proxy instead of the object itself.\n *\n * @param Object|Array\t\ttarget\n * @param Object\t\t    params\n *\n * @return Proxy\n */\nexport default function(target, params = {}) {\n\tif (!_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(target) + '\" given!');\n    }\n    var proxy = new Proxy(target, {\n        apply:  (target, thisArgument, argumentsList) => apply(target, thisArgument, argumentsList, params),\n        construct:  (target, argumentsList, newTarget = null) => construct(target, argumentsList, newTarget, params),\n        defineProperty:  (target, propertyKey, attributes) => defineProperty(target, propertyKey, attributes, params),\n        deleteProperty: (target, propertyKey) => deleteProperty(target, propertyKey, params),\n        get: (target, propertyKey, receiver = null) => {\n            var val = get(target, propertyKey, receiver, params);\n            if (params.proxyAutoBinding !== false && _isFunction(val) && !_isClass(val)) {\n                return val.bind(proxy);\n            }\n            return val;\n        },\n        getOwnPropertyDescriptor: (target, propertyKey) => getOwnPropertyDescriptor(target, propertyKey, params),\n        getPrototypeOf: target => getPrototypeOf(target, params),\n        has: (target, propertyKey) => has(target, propertyKey, params),\n        isExtensible: target => isExtensible(target, params),\n        ownKeys: target => ownKeys(target, params),\n        preventExtensions: target => preventExtensions(target, params),\n        set: (target, propertyKey, value, receiver = null) => set(target, propertyKey, value, receiver, params),\n        setPrototypeOf: (target, prototype) => setPrototypeOf(target, prototype, params),\n    });\n    _internals(proxy).set(proxy, target);\n\treturn proxy;\n}\n","\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"class\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) && /^class\\s?/.test(Function.prototype.toString.call(val));\n};\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _isObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Interceptors from '../core/Interceptors.js';\n\n/**\n * Adds a trap to an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param object\t\t\t\t\ttrap\n * @param object\t\t\t\t\tparams\n *\n * @return Interceptor\n */\nexport default function(target, trap, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(handler) + '\" given!');\n\t}\n\tvar returnObj = {}, isOriginallyObj = true;\n\tif (!_isObject(trap)) {\n\t\t// Backwards compatibility\n\t\tif (_isFunction(trap)) {\n\t\t\ttrap = { '': trap };\n\t\t} else if (_isFunction(params)) {\n\t\t\ttrap = { [trap]: params };\n\t\t\tparams = arguments.length > 3 ? arguments[3] : {};\n\t\t}\n\t\tisOriginallyObj = false;\n\t}\n\tvar interceptors = Interceptors.getFirebase(target, true, params.namespace);\n\tObject.keys(trap).forEach(filter => {\n\t\tif (!_isFunction(trap[filter])) {\n\t\t\tthrow new Error('Callback' + (filter === null ? '' : ' for ' + filter) + ' must be a function; \"' + _getType(trap[filter]) + '\" given!');\n\t\t}\n\t\tvar dfn = { filter, handler: trap[filter], params }, existing;\n\t\tif (dfn.params.unique && (existing = interceptors.match(dfn)).length) {\n\t\t\tif (dfn.params.unique !== 'replace') {\n\t\t\t\treturn existing[0];\n\t\t\t}\n\t\t\tinterceptors.remove(existing[0]);\n\t\t}\n\t\tif (isOriginallyObj) {\n\t\t\treturnObj[filter] = interceptors.add(dfn);\n\t\t} else {\n\t\t\treturnObj = interceptors.add(dfn);\n\t\t}\n\t});\n\treturn returnObj;\n}\n","\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Interceptors from '../core/Interceptors.js';\n\n/**\n * Removes traps from an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param object\t\t\t\t\ttrap\n * @param object\t\t\t\t\tparams\n *\n * @return void\n */\nexport default function(target, trap = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(target) + '\" given!');\n\t}\n\tvar interceptors = Interceptors.getFirebase(target, false, params.namespace);\n\tif (!_isObject(trap)) {\n\t\t// Backwards compatibility\n\t\tif (_isFunction(trap)) {\n\t\t\ttrap = { [null]: trap };\n\t\t} else if (_isFunction(params)) {\n\t\t\ttrap = { [trap]: params };\n\t\t\tparams = arguments.length > 3 ? arguments[3] : {};\n\t\t}\n\t\tisOriginallyObj = false;\n\t}\n\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\tObject.keys(trap).forEach(filter => {\n\t\t\tif (!_isFunction(trap[filter])) {\n\t\t\t\tthrow new Error('Callback' + (filter === null ? '' : ' for ' + filter) + ' must be a function; \"' + _getType(trap[filter]) + '\" given!');\n\t\t\t}\n\t\t\tvar dfn = { filter, originalHandler: trap[filter], params };\n\t\t\treturn interceptors.removeMatches(dfn);\n\t\t});\n\t}\n}\n","\n/**\n * @imports\n */\nimport { _copy } from '@webqit/util/obj/index.js';\nimport { _unique } from '@webqit/util/arr/index.js';\nimport { _isArray, _isTypeObject } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\nimport unlink from '../connectors/unlink.js';\nimport link from '../connectors/link.js';\n\n/**\n * Executes a callback function on a target in \"closure\" mode.\n * Fires any observers that may be bound to target on recorded changes.\n *\n * @param function\t\tcallback\n * @param array\t\t\t...subjects\n *\n * @return array|Event\n */\nexport default function(callback, ...subjects) {\n\tvar context = subjects.map(target => {\n\t\ttarget = _unproxy(target);\n\t\tif (!_isTypeObject(target)) {\n\t\t\tthrow new Error('Target must be of type object!');\n\t\t}\n\t\treturn {\n\t\t\ttarget,\n\t\t\tsubjectCopy: _isArray(target) ? target.slice(0) : _copy(target),\n\t\t};\n\t});\n\t// ---------------------------------\n\tvar result = callback(...subjects);\n\t// ---------------------------------\n\tconst fireDiffs = () => {\n\t\tcontext.map(cntxt => {\n\t\t\tvar initialKeys = Object.keys(cntxt.subjectCopy);\n\t\t\tvar currentKeys = Object.keys(cntxt.target);\n\t\t\tvar related = [];\n\t\t\tvar changes = _unique(initialKeys.concat(currentKeys)).map(key => {\n\t\t\t\tif (cntxt.subjectCopy[key] !== cntxt.target[key]) {\n\t\t\t\t\trelated.push(key);\n\t\t\t\t\t// ---------------------------------\n\t\t\t\t\t// The event object\n\t\t\t\t\tvar e = {\n\t\t\t\t\t\tname:key,\n\t\t\t\t\t\trelated,\n\t\t\t\t\t\tbuffered: true,\n\t\t\t\t\t};\n\t\t\t\t\tif (currentKeys.includes(key)) {\n\t\t\t\t\t\te.type = 'set';\n\t\t\t\t\t\te.value = cntxt.target[key];\n\t\t\t\t\t\tif (initialKeys.includes(key)) {\n\t\t\t\t\t\t\te.isUpdate = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.type = 'del';\n\t\t\t\t\t}\n\t\t\t\t\tif (initialKeys.includes(key)) {\n\t\t\t\t\t\te.oldValue = cntxt.subjectCopy[key];\n\t\t\t\t\t}\n\t\t\t\t\t// ---------------------------------\n\t\t\t\t\t// Unobserve outgoing value for bubbling\n\t\t\t\t\tif (_isTypeObject(cntxt.subjectCopy[key])) {\n\t\t\t\t\t\tunlink(cntxt.target, key, cntxt.subjectCopy[key]);\n\t\t\t\t\t}\n\t\t\t\t\t// Observe incoming value for bubbling\n\t\t\t\t\tif (_isTypeObject(cntxt.target[key])) {\n\t\t\t\t\t\tlink(cntxt.target, key, cntxt.target[key]);\n\t\t\t\t\t}\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t}).filter(c => c);\n\t\t\t// ---------------------------------\n\t\t\tvar observers;\n\t\t\tif (changes.length && (observers = Observers.getFirebase(cntxt.target, false))) {\n\t\t\t\treturn observers.fire(changes);\n\t\t\t}\n\t\t});\n\t};\n\tif (result instanceof Promise) {\n\t\tresult.then(fireDiffs);\n\t} else {\n\t\tfireDiffs();\n\t}\n\treturn result;\n}\n","\n/**\n * Converts a string to title case.\n *\n * @param string \tstr\n * @param bool \t\tstrict\n *\n * @return string\n */\nexport default function(str, strict) {\n\tif (typeof str !== 'string') {\n\t\treturn str;\n\t}\n\treturn str.replace(/\\w\\S*/g,  function(txt) { return txt.charAt(0).toUpperCase() + ((typeof strict !== undefined && strict) ? txt.substr(1).toLowerCase() : txt.substr(1)); })\n};\n","\nexport const _isTextMediaType = contentMediaType => contentMediaType && (\n    contentMediaType.startsWith('text/')\n    || contentMediaType === 'application/rtf'\n    || contentMediaType === 'application/xml'\n    || contentMediaType === 'application/xhtml+xml'\n    || contentMediaType === 'application/json'\n);\n\nexport const _isFileUpload = schema => {\n    return schema.format === 'data-url' \n    || schema.contentEncoding === 'base64';\n};","\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the difference of two arrays;\n * optionally using a custom matching function.\n *\n * @param array \tarr\n * @param array\t \tarr2\n * @param function \tcallback\n *\n * @return array\n */\nexport default function(arr, arr2, callback = null) {\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \n\t\t? arr2.filter(val2 => callback(val1, val2)).length \n\t\t: arr2.indexOf(val1) === -1\n\t);\n};\n","\n/**\n * @imports\n */\nimport { _difference, _intersect, _unique } from '@webqit/util/arr/index.js';\nimport { _isBoolean, _isNull, _isNumeric, _isString } from '@webqit/util/js/index.js';\n\n/**\n * @Schema Base Controller\n * @todo: anyOf, oneOf, allOf\n */\nexport const _Schema = __Schema => class extends (__Schema || class {}) {\n    \n    constructor(jsonSchema) {\n        super(jsonSchema);\n        // depreciated, readOnly, writeOnly, default, \n        // title, description, enum, const, examples, etc\n        Object.keys(jsonSchema).forEach(name => {\n            Object.defineProperty(this, name, { value: jsonSchema[name] });\n        });\n    }\n\n    validate(instance) {\n        return super.validate ? super.validate(instance) : { valid: true };\n    }\n\n}\n\n/**\n * @ObjectOrArray Base Controller\n */\nexport const _ObjectOrArray = __ObjectOrArray => class extends _Schema(__ObjectOrArray) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateMin(instance)).valid) {\n            return { valid: false, error: validity.error || `Minimum number of entries short of: ${validity.violation}.` };\n        }\n        if (!(validity = this._validateMax(instance)).valid) {\n            return { valid: false, error: validity.error || `Maximum number of entries exceeded by: ${validity.violation}.` };\n        }\n        return validity;\n    }\n\n}\n\n/**\n * @Object Controller\n */\nexport const _Object = __Object => class extends _ObjectOrArray(__Object) {\n\n    getPropertyNameSchema(instanceHint = null) {\n        var propertyNameSchema = this.propertyNames || { type: 'string' };\n        if (this.additionalProperties === false) {\n            propertyNameSchema.error = `Additional properties not allowed.`;\n        }\n        if (instanceHint) {\n            // With instanceHint as hint, consider assisting the caller with\n            // 1. Dynamically-generated names as options - names that aren't yet in the instance\n        }\n        propertyNameSchema.isRequired = true;\n        return propertyNameSchema;\n    }\n\n    getPropertySchema(propertyName, instanceHint = null) {\n        var propertySchema;\n        if ((!this.properties || !(propertySchema = this.properties[propertyName]))\n        && !(propertySchema = this._patternPropertiesMatch(propertyName))\n        && !(propertySchema = this.additionalProperties) && propertySchema !== false) {\n            propertySchema = { };\n        }\n        if (propertySchema) {\n            // Also use \"this.required\" to hint this property schema about requiredness\n            if ((this.required || []).includes(propertyName)) {\n                propertySchema.isRequired = true;\n            }\n            if (instanceHint) {\n                const instanceProperties = Object.keys(instanceHint);\n                // With instance as hint, consider assisting the caller with dynamically-generated hints\n                // 1. Use \"this.dependentRequired\" to hint this property schema about dependent-requiredness\n                var requiringProp;\n                if (!propertySchema.isRequired && (requiringProp = _intersect(this.dependentRequired || [], instanceProperties).reduce((masterHint, master) => masterHint || this.dependentRequired[master].includes(propertyName) ? master : null, null))) {\n                    propertySchema.isRequired = requiringProp;\n                }\n                // 2. Info about whether this proposed entry will validate against \"this.min/this.maxProperties\"\n                var validity;\n                if (!instanceProperties.includes(propertyName) && !(validity = this._validateMax(instanceHint)).valid || validity.violation === 0/* currently exact maximum reached */) {\n                    propertySchema.error = `This additional entry will violate the maximum number of entries allowed.`;\n                }\n                // 3. dynamic \"type\": the list of types in \"this.allOf\", \"this.anyOf\", \"this.oneOf\", not in \"this.not\"\n            }\n            return { ...propertySchema, name:propertyName };\n        }\n    }\n\n    _patternPropertiesMatch(propertyName) {\n        return Object.keys(this.patternProperties || {}).reduce((prev, pattern) => {\n            if (prev) return prev;\n            if ((new RegExp(pattern)).test(propertyName)) {\n                return this.patternProperties[pattern];\n            }\n        }, null);\n    }\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateRequired(instance)).valid) {\n            return { valid: false, error: validity.error || `Required entries still empty: ${validity.violation.join(', ')}.` };\n        }\n        if (!(validity = this._validateDependentRequired(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries associated with \"${validity.master}\" still empty: ${validity.violation.join(', ')}.` };\n        }\n        return validity;\n    }\n\n    _validateMax(instance) {\n        if (!this.maxProperties) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = instanceProperties.length - this.maxProperties;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateMin(instance) {\n        if (!this.minProperties) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = this.minProperties - instanceProperties.length;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateRequired(instance) {\n        if (!this.required) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const violation = _difference(this.required, instanceProperties);\n        return { valid: violation.length === 0, violation };\n    }\n\n    _validateDependentRequired(instance) {\n        if (!this.dependentRequired) return { valid: true };\n        const instanceProperties = Object.keys(instance);\n        const [ master, violation ] = Object.keys(this.dependentRequired).reduce((prev, key) => {\n            if (prev) return prev;\n            if (instanceProperties.includes(key)) {\n                const violation = _difference(this.dependentRequired[key], instanceProperties);\n                if (violation.length) return [ key, violation ];\n            }\n        }, null) || [];\n        return { valid: !master, master, violation };\n    }\n}\n\n/**\n * @Array Controller\n */\n export const _Array = __Array => class extends _ObjectOrArray(__Array) {\n\n    getItemSchema(itemIndex, instanceHint = null) {\n        var itemSchema;\n        if ((!this.prefixItems || !(itemSchema = this.prefixItems[itemIndex]))\n        && !(itemSchema = this.items) && itemSchema !== false) {\n            itemSchema = { };\n        }\n        if (itemSchema) {\n            if (instanceHint) {\n                // With instance as hint, consider assisting the caller with dynamically-generated hints\n                // 1. Info about whether this proposed entry will validate against \"this.min/this.maxProperties\"\n                var validity;\n                if (!(itemIndex in instanceHint) && !(validity = this._validateMax(instanceHint)).valid || validity.violation === 0/* currently exact maximum reached */) {\n                    itemSchema.error = `This additional entry will violate the maximum number of entries allowed.`;\n                }\n                // 2. \"this.contains\"\n            }\n            return { ...itemSchema, name:itemIndex };\n        }\n    }\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        if (!(validity = this._validateUnique(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries must be unique` };\n        }\n        if (!(validity = this._validateContains(instance)).valid) {\n            return { valid: false, error: validity.error || `Entries must contain ${validity.min > 0 ? `at least ${validity.min} ` + (validity.max > 1 ? 'and ' : '') : ''} ${validity.max > 1 ? `at most ${validity.max} ` : ''}of ${validity.desc}.` };\n        }\n        return validity;\n    }\n\n    _validateMax(instance) {\n        if (!this.maxItems) return { valid: true };\n        const violation = instance.length - this.maxItems;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateMin(instance) {\n        if (!this.minItems) return { valid: true };\n        const violation = this.minItems - instance.length;\n        return { valid: violation <= 0, violation };\n    }\n\n    _validateUnique(instance) {\n        if (!this.uniqueItems) return { valid: true };\n        return { valid: _unique(instance).length === instance.length };\n    }\n\n    _validateContains(instance) {\n        if (!this.contains) return { valid: true };\n        const passes = instance.filter(item => this.__validateContains(this.contains, item));\n        if (passes.length < (this.minContains || 1)) {\n            return { valid: false, min: this.minContains || 1, max: this.maxContains, desc };\n        }\n        if (this.maxContains && passes.length > this.maxContains) {\n            return { valid: false, min: this.minContains || 1, max: this.maxContains, desc };\n        }\n        return { valid: true };\n    }\n}\n\n/**\n * @String Controller\n */\nexport const _String = __String => class extends _Schema(__String) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isString(instance) };\n    }\n\n}\n\n/**\n * @Num Controller\n */\nexport const _Num = __Num => class extends _Schema(__Num) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return validity;\n    }\n\n}\n\n/**\n * @Number Controller\n */\nexport const _Number = __Number => class extends _Num(__Number) {\n    \n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isNumeric(instance) };\n    }\n\n}\n\n/**\n * @Integer Controller\n */\nexport const _Integer = __Integer => class extends _Num(__Integer) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: Number.isInteger(instance) };\n    }\n\n}\n\n/**\n * @Boolean Controller\n */\nexport const _Boolean = __Boolean => class extends _Schema(__Boolean) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isBoolean(instance) };\n    }\n\n}\n\n/**\n * @Null Controller\n */\nexport const _Null = __Null => class extends _Schema(__Null) {\n\n    validate(instance) {\n        var validity = super.validate(instance);\n        if (!validity.valid) return validity;\n        return { valid: _isNull(instance) };\n    }\n\n}","\n/**\n * Tells if val is undefined or is of type \"boolean\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === true || val === false;\n};\n","\n/**\n * @imports\n */\nimport Observer from '@webqit/observer';\nimport { _toTitle } from '@webqit/util/str/index.js';\nimport { _from as _arrFrom, _intersect } from '@webqit/util/arr/index.js';\nimport { _getType, _isBoolean, _isEmpty, _isTypeObject, _isArray, _isFunction, _isUndefined, _isNumeric, _isObject } from '@webqit/util/js/index.js';\nimport { _isTextMediaType, _isFileUpload } from './utils/util.js';\nimport * as Schemas from './schema-mixins.js';\n\n/**\n * @Root Base Controller\n */\nexport const _Root = __Root => class extends (__Root || class {}) {\n\n    constructor() {\n        super();\n        this.nodeRemovalListeners = new Map;\n    }\n\n    execNodeRemoval(node) {\n        if (_isFunction(node.remove)) {\n            node.remove();\n        }\n    }\n\n    onNodeRemoval(node, callback) {\n        var listeners = this.nodeRemovalListeners.get(node);\n        if (!listeners) {\n            listeners = [];\n            this.nodeRemovalListeners.set(node, listeners);\n        }\n        listeners.push(callback);\n    }\n\n    async remoteAction(method, url, options = {}) {\n        return {};\n    }\n\n    static getSchemaName(type) {\n        type = _arrFrom(type || 'string');\n        return [\n            ['object', '_Object'],\n            ['array', '_Array'],\n            ['string', '_String'],\n            ['number', '_Number'],\n            ['integer', '_Integer'],\n            ['boolean', '_Boolean'],\n            ['null', '_Null']\n        ].reduce((name, pair) => name || (type.includes(pair[0]) ? pair[1] : null), null);\n    }\n\n    define(schema, ownerWidget = null) {\n        Observer.set(this, 'schema', Observer.proxy(schema));\n        Observer.set(this, 'ownerWidget', ownerWidget);\n        Observer.set(this, 'attrs', Observer.proxy({\n            name: this.ownerWidget && this.ownerWidget.attrs.name ? `${this.ownerWidget.attrs.name}[${this.schema.name}]` : this.schema.name\n        }));\n        if (!this.state) {\n            Observer.set(this, 'state', Observer.proxy({}));\n        }\n        if (!this.schema.title) {\n            this.schema.title = _toTitle(((this.schema.name || '') + '').replaceAll('_', ' '));\n        }\n        if (this.schema.isRequired) {\n            this.attrs.required = true;\n        }\n        if (!_isUndefined(this.schema.const) || !_isUndefined(this.schema.default)) {\n            this.attrs.value = !_isUndefined(this.schema.const) ? this.schema.const : this.schema.default;\n        }\n        if (this.schema.readOnly || !_isUndefined(this.schema.const)) {\n            this.attrs.readonly = true;\n        }\n    }\n\n    alert(alert = null) {\n        if (arguments.length) {\n            this.state.alert = { message: alert.message, type: alert.type };\n        }\n        return { ...(this.state.alert || {}) };\n    }\n\n    json() {}\n\n    set value(value) {\n        this.json(value);\n    }\n\n    get value() {\n        return this.json();\n    }\n\n};\n\n/**\n * @ParentRoot Base Controller\n */\nexport const _ParentRoot = __ParentRoot => class extends _Root(__ParentRoot) {\n\n    deriveChildEntry(childSchema, i) {}\n\n};\n\n/**\n * @Collection Controller\n */\nexport const _Collection = __Collection => class extends _ParentRoot(__Collection) {\n\n    constructor() {\n        super();\n        Observer.set(this, 'childEntries', Observer.proxy({}));\n        Observer.observe(this.childEntries, mutations => {\n            mutations.forEach(m => {\n                if (m.type === 'set') {\n                    if (m.isUpdate && m.oldValue) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                    if (m.value) {\n                        if (_isFunction(this.onNodeRemoval)) {\n                            this.onNodeRemoval(m.value, () => {\n                                if (this.childEntries[m.name] === m.value) {\n                                    delete this.childEntries[m.name];\n                                }\n                            });\n                        }\n                    } else {\n                        console.warn(`No widget type defined for entry \"${m.name}\" of schema type \"${_arrFrom(this.schema.properties[m.name].type || 'string').join(', ')}\".`);\n                    }\n                }\n                if (m.type === 'deleteProperty') {\n                    this.execNodeRemoval(m.oldValue);\n                }\n            });\n        });\n        // Better regex would allow you to not select the ${} characters. Try: /(?!\\${)([^{}]*)(?=})/g\n        function renderString(str,obj) {\n            return str.replace(/\\{.+?\\}/g, match => {return index(obj,match)})\n        }\n    }\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('object');\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._Object())(jsonSchema), ownerWidget);\n        Object.keys(this.childEntries).forEach(propertyName => {\n            delete this.childEntries[propertyName];\n        });\n        Object.keys(this.schema.properties || {}).forEach(propertyName => {\n            const propertySchema = this.schema.getPropertySchema(propertyName);\n            if (propertySchema.display !== false) {\n                this.childEntries[propertyName] = this.deriveChildEntry(propertySchema, propertyName);\n            }\n        });        \n    }\n\n    extend(propertyName, callback = null) {\n        if (_isFunction(propertyName)) {\n            const promptPropertyName = () => {\n                const propertyNameSchema = this.schema.getPropertyNameSchema(this.json());\n                propertyName(propertyNameSchema, _propertyName => {\n                    if (propertyNameSchema.validate(_propertyName)) {\n                        extend(_propertyName, callback);\n                    } else {\n                        promptPropertyName();\n                    }\n                });\n            }\n            promptPropertyName();\n        } else if (propertyName) {\n            const instanceHint = this.json();\n            this.childEntries[propertyName] = this.deriveChildEntry(this.schema.getPropertySchema(propertyName, instanceHint), propertyName);;\n            if (callback) {\n                callback(this.childEntries[propertyName]);\n            }\n        }\n    }\n\n    json(data = {}, autoExtend = false) {\n        if (arguments.length) {\n            if (!_isObject(data)) throw new Error(`Data must be a valid JSON object.`);\n            Object.keys(data).forEach(name => {\n                if (this.childEntries[name]) {\n                    this.childEntries[name].json(data[name]);\n                } else if (autoExtend) {\n                    this.extend(name, childEntry => {\n                        childEntry.json(data[name]);\n                    });\n                }\n            });\n            return;\n        }\n        // ------------------\n        const _data = {};\n        Object.keys(this.childEntries).forEach(name => {\n            _data[name] = this.childEntries[name].json();\n        });\n        return _data;\n    }\n\n    alert(alert = {}, autoExtend = false) {\n        if (arguments.length) {\n            super.alert(alert);\n            if (alert.details && !_isObject(alert.details)) throw new Error(`Alert details must be a valid JSON object.`);\n            Object.keys(alert.details || {}).forEach(name => {\n                if (this.childEntries[name]) {\n                    this.childEntries[name].alert(alert.details[name]);\n                } else if (autoExtend) {\n                    this.extend(name, childEntry => {\n                        childEntry.alert(alert.details[name]);\n                    });\n                }\n            });\n            return;\n        }\n        // ------------------\n        const _alert = super.alert(); _alert.details = {};\n        Object.keys(this.childEntries).forEach(name => {\n            _alert.details[name] = this.childEntries[name].alert();\n        });\n        return _alert;\n    }\n    \n};\n    \n/**\n * @Multiple Controller\n */\nexport const _Multiple = __Multiple => class extends _ParentRoot(__Multiple) {\n\n    constructor() {\n        super();\n        Observer.set(this, 'childEntries', Observer.proxy([]));\n        Observer.observe(this.childEntries, mutations => {\n            mutations.forEach(m => {\n                if (m.name === 'length') return;\n                if (m.type === 'set') {\n                    if (m.isUpdate && m.oldValue && this.childEntries.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                    if (m.value) {\n                        if (_isFunction(this.onNodeRemoval)) {\n                            this.onNodeRemoval(m.value, () => {\n                                const i = this.childEntries.indexOf(m.value);\n                                if (i > -1) {\n                                    this.childEntries.splice(i, 1);\n                                }\n                            });\n                        }\n                    } else {\n                        console.warn(`No widget type defined for entry \"${m.name}\" of schema type \"${_arrFrom(m.value.type || 'string').join(', ')}\".`);\n                    }\n                }\n                if (m.type === 'deleteProperty') {\n                    if (this.childEntries.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                }\n            });\n        });\n    }\n     \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('array');\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._Array())(jsonSchema), ownerWidget);\n        this.childEntries.splice(0);\n        if (!_isEmpty(this.schema.prefixItems)) {\n            this.schema.prefixItems.forEach((itemSchema, itemIndex) => {\n                this.childEntries.push(this.deriveChildEntry(itemSchema, itemIndex));\n            });\n        }\n        if (this.schema.autoExtend === true) {\n            this.extend();\n        }\n    }\n\n    extend(callback = null) {\n        const instanceHint = this.json();\n        const itemIndex = instanceHint.length;\n        const childEntry = this.deriveChildEntry(this.schema.getItemSchema(itemIndex, instanceHint), itemIndex);\n        this.childEntries.push(childEntry);\n        if (callback) {\n            callback(childEntry);\n        }\n    }\n\n    execNodeRemoval(node, confirm = null) {\n        if (!confirm) {\n            confirm = (msg, done) => done();\n        }\n        const i = this.childEntries.indexOf(node);\n        if (i === -1) {\n            return;\n        }\n        const name = !node.schema ? 'item' : (_isNumeric(node.schema.title) ? `item ${parseInt(node.schema.title) + 1}` : node.schema.title);\n        if (this.schema.remoteDelete) {\n            var value = node.value;\n            if (value && !_isTypeObject(value)) {\n                var deleteUrl = this.schema.remoteDelete.url.replace(/\\{value\\}/g, value);\n                confirm(`Remove ${name} (and delete from your account)?`, () => {\n                    return this.remoteAction(this.schema.remoteDelete.method || 'delete', deleteUrl).then(res => {\n                        if (res.ok) {\n                            super.execNodeRemoval(node);\n                        }\n                        return res;\n                    });\n                });\n                return;\n            }\n        }\n        confirm(`Remove ${name}?`, async () => {\n            super.execNodeRemoval(node);\n        });\n    }\n\n    json(data = []) {\n        if (arguments.length) {\n            if (!_isArray(data)) throw new Error(`Data must be a valid JSON array.`);\n            data.forEach((value, itemIndex) => {\n                if (this.childEntries[itemIndex]) {\n                    this.childEntries[itemIndex].json(value);\n                } else {\n                    this.extend(childEntry => {\n                        childEntry.json(value);\n                    });\n                }\n            });\n            return;\n        }\n        // ------------------\n        return this.childEntries.filter(entry => entry).map(entry => entry.json());\n    }\n\n    alert(alert = {}, autoExtend = false) {\n        if (arguments.length) {\n            super.alert(alert);\n            if (alert.details && !_isArray(alert.details) && !Object.keys(alert.details).every(k => _isNumeric(k))) throw new Error(`Alert items must be a valid JSON array.`);\n            Object.keys(alert.details).forEach(itemIndex => {\n                const _alert = alert.details[itemIndex];\n                if (this.childEntries[itemIndex]) {\n                    this.childEntries[itemIndex].alert(_alert);\n                } else {\n                    this.extend(childEntry => {\n                        childEntry.alert(_alert);\n                    });\n                }\n            });\n            return;\n        }\n        const _alert = super.alert();\n        _alert.details = this.childEntries.filter(entry => entry).map(entry => entry.alert());\n        return _alert;\n    }\n\n};\n\n/**\n * @Multiple Controller\n */\nexport const _Multiple2 = __Multiple2 => class extends _Multiple(__Multiple2) {\n            \n    static testSchema(jsonSchema) {\n        if (!super.testSchema(jsonSchema)) return;\n        // Any enum is going to be array items each\n        if (jsonSchema.enum) return;\n        var entries = [],\n            widgetLineContentLengthLimit = this.lineContentLengthLimit || 50;\n        if (jsonSchema.prefixItems) {\n            // super.testSchema() plus only \"const\" or \"single-item enum\", plus, nothing object-like, nor a string that execeeds widget line limit\n            if (jsonSchema.prefixItems.some(item => (!('const' in item) && (item.enum || []).length !== 1) || _intersect(_arrFrom(item.type), ['array', 'object']).length || Math.max(item.minLength, item.maxLength, 0) > widgetLineContentLengthLimit)) return;\n            entries = jsonSchema.prefixItems.map(item => ('const' in item) ? item.const : item.enum[0]);\n        }\n        if (jsonSchema.items) {\n            // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n            if (_intersect(_arrFrom(jsonSchema.items.type), ['array', 'object']).length || Math.max(jsonSchema.items.minLength, jsonSchema.items.maxLength, 0) > widgetLineContentLengthLimit) return;\n            entries = entries.concat(jsonSchema.items.enum || /* may not always be enum */[]);\n        }\n        return !(entries.some(item => _isTypeObject(item) || (item + '').length > widgetLineContentLengthLimit));\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(...arguments);\n        if (this.schema.autoExtend !== false) {\n            this.extend();\n        }\n    }\n    \n}\n\n/**\n * @Enum Controller\n */\nexport const _Enum = __Enum => class extends _Root(__Enum) {\n\n    constructor() {\n        super();\n        Observer.set(this, 'enumEntries', Observer.proxy([]));\n        Observer.observe(this.enumEntries, mutations => {\n            mutations.forEach(m => {\n                if (m.name === 'length') return;\n                if (m.type === 'set') {\n                    if (m.isUpdate && m.oldValue && this.enumEntries.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                    if (_isFunction(this.onNodeRemoval)) {\n                        this.onNodeRemoval(m.value, () => {\n                            const i = this.enumEntries.indexOf(m.value);\n                            if (i > -1) {\n                                this.enumEntries.splice(i, 1);\n                            }\n                        });\n                    }\n                }\n                if (m.type === 'deleteProperty') {\n                    if (this.enumEntries.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                }\n            });\n        });\n    }\n\n    static testSchema(jsonSchema) {\n        return _isArray(jsonSchema.enum) || (\n            // Or where an array with the following conditions that completely eliminates the idea of a schema-based items list:\n            _arrFrom(jsonSchema.type).includes('array') && (\n                // 1. where no jsonSchema.prefixItems (which would have been a schema) or where jsonSchema.prefixItems bundles its \"const\"s\n                (_isEmpty(jsonSchema.prefixItems) || jsonSchema.prefixItems.every(item => ('const' in item) || (item.enum || []).length === 1))\n                // 2. where no .items (meaning: \"won't grow\") or where .items bundles its \"enums\" which are themselves expected to be final as specified by .uniqueItems\n                && (jsonSchema.items === false || (_isArray((jsonSchema.items || {}).enum) && jsonSchema.uniqueItems))\n            )\n        );\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        // Enums can be any type\n        const schemaName = this.constructor.getSchemaName(jsonSchema.type);\n        this.enumEntries.splice(0);\n        super.define(new (Schemas[schemaName]())(jsonSchema), ownerWidget);\n        // -------------\n        // Fetch items...\n        // -------------\n        const runSchemaEnum = (enumValues, enumNames) => {\n            const entries = enumValues.map((value, i) => ({ value, label: (enumNames || {})[i] }));\n            this.enumerate(entries, 1);\n        };\n        const runSchemaEnumFetch = remoteFetch => {\n            this.enumFetching = this.remoteAction(remoteFetch.method || 'get', remoteFetch.url, {\n                headers: { accept: 'application/json' }\n            }).then(res => res.ok ? res.json() : Promise.reject({ message: res.statusText })).then(res => {\n                var _entries = !_isArray(res.data) ? [] : res.data.map(entry => (_isObject(entry) ? {\n                    value: 'value' in entry ? entry.value : entry.id,\n                    label: 'label' in entry ? entry.label : entry.title,\n                } : {\n                    value: entry,\n                }));\n                this.enumerate(_entries, remoteFetch.url);\n            });\n        };\n        // -------------\n        // Mine items...\n        // -------------\n        if (this.schema.remoteFetch) {\n            runSchemaEnumFetch(this.schema.remoteFetch);\n            Observer.observe(this.schema, 'remoteFetch', () => {\n                runSchemaEnumFetch(this.schema.remoteFetch);\n            }, { subtree: true });\n        } else if (this.schema.enum) {\n            runSchemaEnum(this.schema.enum, this.schema.enumNames);\n            Observer.observe(this.schema, [['enum'], ['enumNames']], () => {\n                runSchemaEnum(this.schema.enum, this.schema.enumNames);\n            });\n        } else if (_arrFrom(this.schema.type || 'string').includes('array')) {\n            const entries = [];\n            // Array case 1:\n            if (this.schema.prefixItems) {\n                entries = this.schema.prefixItems.map(item => (\n                    ('const' in item) ? { value: item.const, label: item.title } : { value: item.enum[0], label: item.title || (item.enumNames || [])[0] }\n                ));\n            }\n            // Array case 2:\n            if (this.schema.items) {\n                this.schema.items.enum.forEach((item, i) => {\n                    entries.push({ value: item, label: (this.schema.items.enumNames || [])[i] });\n                });\n            }\n            // Expecting type array means \"multiple\"\n            this.attrs.multiple = true;\n            this.attrs.name += '[]';\n            entries.forEach(item => {\n                item.selected = true;\n            });\n            this.enumerate(entries, 2);\n        }\n    }\n\n    deriveEnumEntry(enumData, index) {}\n\n    enumerate(entries, clearByTag = null) {\n        if (_arrFrom(this.schema.type).includes('null')) {\n            entries = [{ value: null, label: this.attrs.placeholder }].concat(entries);\n        }\n        if (clearByTag) {\n            if (clearByTag === true) {\n                this.enumEntries.splice(0);\n            } else {\n                this.enumEntries.filter(entry => _intersect(_arrFrom(entry.enumTag), _arrFrom(clearByTag)).length).forEach(entry => {\n                    const index = this.enumEntries.indexOf(entry);\n                    if (index > -1) {\n                        this.enumEntries.splice(index, 1);\n                    }\n                });\n            }\n        }\n        this.enumEntries.push(...entries.map((entry, i) => {\n            entry = this.deriveEnumEntry(entry, i);\n            if (clearByTag) {\n                entry.enumTag = clearByTag;\n            }\n            return entry;\n        }));\n    }\n\n    json(data = []) {\n        if (arguments.length) {\n            if (!_isArray(data)) {\n                if (this.attrs.multiple)\n                    throw new Error(`Data must be a valid JSON array.`);\n                data = [ data ];\n            }\n            const runSelect = () => {\n                this.enumEntries.forEach(entry => {\n                    entry.selected = false;\n                    data.forEach(value => {\n                        if (entry.value === value + '') {\n                            entry.selected = true;\n                        }\n                    });\n                });\n            };\n            if (this.enumFetching) {\n                this.enumFetching.then(runSelect);\n            } else {\n                runSelect();\n            }\n            return;\n        }\n        const selected = this.enumEntries.filter(entry => entry.selected).map(entry => entry.value);\n        return this.attrs.multiple ? selected : selected[0];\n    }\n\n};\n\n/**\n * @Enum2 Controller\n */\nexport const _Enum2 = __Enum2 => class extends _Enum(__Enum2) {\n    \n    static testSchema(jsonSchema) {\n        if (!super.testSchema(jsonSchema)) return;\n        var entries = [],\n            widgetLineContentLengthLimit = this.lineContentLengthLimit || 50;\n        if (jsonSchema.enum) {\n            // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n            if (_intersect(_arrFrom(jsonSchema.type), ['array', 'object']).length || Math.max(jsonSchema.minLength, jsonSchema.maxLength, 0) > widgetLineContentLengthLimit) return;\n            entries = jsonSchema.enum;\n        } else if (!jsonSchema.remoteFetch) {\n            if (jsonSchema.prefixItems) {\n                // Only \"const\" or \"single-item enum\" - as ensured by super.testSchema(), plus, none should be object-like, nor a string that execeeds widget line limit\n                if (jsonSchema.prefixItems.some(item => _intersect(_arrFrom(item.type), ['array', 'object']).length || Math.max(item.minLength, item.maxLength, 0) > widgetLineContentLengthLimit)) return;\n                entries = jsonSchema.prefixItems.map(item => ('const' in item) ? item.const : item.enum[0]);\n            }\n            if (jsonSchema.items) {\n                // super.testSchema() plus nothing object-like, nor a string that execeeds widget line limit\n                if (_intersect(_arrFrom(jsonSchema.items.type), ['array', 'object']).length || Math.max(jsonSchema.items.minLength, jsonSchema.items.maxLength, 0) > widgetLineContentLengthLimit) return;\n                entries = entries.concat(jsonSchema.items.enum);\n            }\n        }\n        return !(entries.some(item => _isTypeObject(item) || (item + '').length > widgetLineContentLengthLimit));\n    }\n\n}\n\n/**\n * @File Controller\n */\nexport const _File = __File => class extends _Root(__File) {\n\n    constructor() {\n        super();\n        Observer.set(this, 'filesList', Observer.proxy([]));\n        Observer.set(this, 'fallbackFilesList', Observer.proxy([]));\n        Observer.observe(this.filesList, mutations => {\n            mutations.forEach(m => {\n                if (m.name === 'length') return;\n                if (m.type === 'set') {\n                    if (m.isUpdate && m.oldValue && this.filesList.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                    if (_isFunction(this.onNodeRemoval)) {\n                        this.onNodeRemoval(m.value, () => {\n                            const i = this.filesList.indexOf(m.value);\n                            if (i > -1) {\n                                this.filesList.splice(i, 1);\n                            }\n                        });\n                    }\n                }\n                if (m.type === 'deleteProperty') {\n                    if (this.filesList.indexOf(m.oldValue) === -1) {\n                        this.execNodeRemoval(m.oldValue);\n                    }\n                }\n            });\n        });\n    }\n\n    static testSchema(jsonSchema) {\n        const _isFileSchema = _jsonSchema => {\n            const schemaType = _arrFrom(_jsonSchema.type || 'string');\n            return (schemaType.includes('string') && (_isFileUpload(_jsonSchema) || (_jsonSchema.contentMediaType && !_isTextMediaType(_jsonSchema.contentMediaType))));\n        };\n        return _isFileSchema(jsonSchema) || (\n            _arrFrom(jsonSchema.type).includes('array') && jsonSchema.uniqueItems && _isEmpty(jsonSchema.prefixItems) && _isFileSchema(jsonSchema.items || {})\n        );\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        const schemaType = _arrFrom(jsonSchema.type);\n        const $schema = schemaType.includes('array') ? Schemas._Array() : Schemas._String();\n        super.define(new $schema(jsonSchema), ownerWidget);\n        this.filesList.splice(0);\n        this.attrs.type = 'file';\n        if (schemaType.includes('array')) {\n            this.attrs.name += '[]';\n            this.attrs.multiple = true;\n        }\n        if (this.schema.contentMediaType || (this.schema.items && this.schema.items.contentMediaType)) {\n            this.attrs.accept = this.schema.contentMediaType || this.schema.items.contentMediaType;\n        }\n    }\n\n    deriveFileEntry(fileData, key) {}\n\n    populate(filesData, clearByTag = null) {\n        if (clearByTag) {\n            if (clearByTag === true) {\n                this.filesList.splice(0);\n            } else {\n                this.filesList.filter(entry => _intersect(_arrFrom(entry.enumTag), _arrFrom(clearByTag)).length).forEach(entry => {\n                    const index = this.filesList.indexOf(entry);\n                    if (index > -1) {\n                        // Don't remove just yet (; people are listening) until we figure out if this\n                        // should only be a transition to this.fallbackFilesList\n                        if (index > -1 && _intersect(_arrFrom(entry.enumTag), [ 1, 2 ]).length === 2) {\n                            this.fallbackFilesList.push(this.filesList[index]);\n                        }\n                        this.filesList.splice(index, 1); // Remove only now\n                    }\n                });\n            }\n        }\n        if ((!filesData || !filesData.length) && (!this.filesList.length || !this.filesList[0]) && this.fallbackFilesList.length) {\n            const _enumTag = this.fallbackFilesList[0].enumTag;\n            this.populate(this.fallbackFilesList.splice(0).map(_entry => ({ file: _entry.file })), _enumTag);\n        }\n        this.filesList.push(...filesData.map((fileData, i) => {\n            var entry = this.deriveFileEntry(fileData, i, clearByTag);\n            if (clearByTag !== null) {\n                entry.enumTag = clearByTag;\n            }\n            return entry;\n        }));\n    }\n\n    execNodeRemoval(node, confirm = null) {\n        if (!confirm) {\n            confirm = (msg, done) => done();\n        }\n        const name = 'file';\n        if (this.schema.remoteDelete && this.fallbackFilesList.indexOf(node) === -1) {\n\n            var value = node.file;\n            if (value && !_isTypeObject(value)) {\n                var deleteUrl = this.schema.remoteDelete.url.replace(/\\{value\\}/g, value);\n                confirm(`Remove ${name} (and delete from your account)?`, () => {\n                    return this.remoteAction(this.schema.remoteDelete.method || 'delete', deleteUrl).then(res => {\n                        if (res.ok) {\n                            super.execNodeRemoval(node);\n                        }\n                        return res;\n                    });\n                });\n                return;\n            }\n        }\n        confirm(`Remove ${name}?`, async () => {\n            super.execNodeRemoval(node);\n        });\n    }\n\n    json(files = []) {\n        if (arguments.length) {\n            if (!_isArray(files)) {\n                if (this.attrs.multiple)\n                    throw new Error(`Data must be a valid JSON array.`);\n                files = [ files ];\n            }\n            this.populate(files.filter(file => file).map(file => ({ file })), [ 1, 2 ]);\n            return;\n        }\n        const uploads = this.filesList.filter(entry => _isObject(entry.file)).map(entry => entry.file);\n        return this.attrs.multiple ? uploads : uploads[0];\n    }\n\n};\n\n/**\n * @InputRoot Base Controller\n */\nexport const _Input = __Input => class extends _Root(__Input) {\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(...arguments);\n        if (!_isUndefined(this.schema.default) || this.schema.examples) {\n            this.attrs.placeholder = `E.g.: ${!_isUndefined(this.schema.default) ? this.schema.default : this.schema.examples[0]}`;\n        }\n        if ('const' in this.schema || (this.schema.enum || []).length === 1) {\n            this.attrs.value = 'const' in this.schema ? this.schema.const : this.schema.enum[0];\n        }\n    }\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n\n};\n\n/**\n * @Editor Controller\n */\nexport const _Editor = __Editor => class extends _Input(__Editor) {\n        \n    static testSchema(jsonSchema) {\n        const schemaType = _arrFrom(jsonSchema.type || 'string');\n        return schemaType.includes('string') && ((jsonSchema.contentMediaType && _isTextMediaType(jsonSchema.contentMediaType)) || (\n            Math.max(jsonSchema.maxLength || 0, jsonSchema.minLength || 0) >= 1024\n        ));\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._String())(jsonSchema), ownerWidget);\n    }\n\n};\n\n/**\n * @Input Controller\n */\nexport const _Text = __Text => class extends _Input(__Text) {\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type || 'string').includes('string');\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._String())(jsonSchema), ownerWidget);\n        this.attrs.type = 'text';\n        if (this.schema.format === 'date') {\n            this.attrs.type = 'date';\n        } else if (this.schema.format === 'time') {\n            this.attrs.type = 'time';\n        } else if (this.schema.format === 'date-time') {\n            this.attrs.type = 'datetime-local';\n        } else if (this.schema.format === 'duration') {\n            this.attrs.type = ''; // ?\n        } else if (['uri', 'uri-reference', 'iri', 'iri-reference', 'uuid'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (['hostname', 'idn-hostname'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (['email', 'idn-email'].includes(this.schema.format)) {\n            this.attrs.type = 'email';\n        } else if (['ipv4', 'ipv6'].includes(this.schema.format)) {\n            this.attrs.pattern = ''; // regex\n        } else if (this.schema.format === 'password') {\n            this.attrs.type = 'password';\n        } else if (this.schema.format === 'color') {\n            this.attrs.type = 'color';\n        } else if (this.schema.format === 'phone') {\n            this.attrs.pattern = '^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$';\n        } else if (this.schema.format === 'postal-code') {\n            this.attrs.pattern = '^[0-9]{5}(?:-[0-9]{4})?$';\n        }\n        // -----\n        if (this.schema.maxLength) {\n            this.attrs.maxlength = this.schema.maxLength;\n        }\n        if (this.schema.minLength) {\n            this.attrs.minlength = this.schema.minLength;\n        }\n        if (this.schema.pattern) {\n            this.attrs.pattern = this.schema.pattern;\n        }\n        if (!this.schema.col) {\n            const col = this.schema.maxLength || 150;\n            this.schema.col = Math.max(1, parseInt(col / (300 / 12)));\n        }\n        // -----\n    }\n    \n};\n\n/**\n * @Number Controller\n */\nexport const _Number = __Number => class extends _Input(__Number) {\n        \n    static testSchema(jsonSchema) {\n        const schemaType = _arrFrom(jsonSchema.type);\n        return schemaType.includes('integer') || schemaType.includes('number');\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._Number())(jsonSchema), ownerWidget);\n        this.attrs.type = 'number';\n        if (this.schema.exclusiveMaximum) {\n            this.attrs.max = this.schema.exclusiveMaximum - 0.0001;\n        } else if (this.schema.maximum) {\n            // date, month, week, time, datetime-local, number, and range\n            this.attrs.max = this.schema.maximum;\n        }\n        if (this.schema.exclusiveMinimum) {\n            this.attrs.min = this.schema.exclusiveMinimum + 0.0001;\n        } else if (this.schema.minimum) {\n            // date, month, week, time, datetime-local, number, and range\n            this.attrs.min = this.schema.minimum;\n        }\n        if (this.schema.multipleOf) {\n            // number, date/time input types, and range\n            this.attrs.step = this.schema.multipleOf;\n        }\n        if (!this.schema.col) {\n            const col = this.schema.maxLength /* char width in sql */ || 50;\n            this.schema.col = Math.max(1, parseInt(col / (300 / 12)));\n        }\n        // ------\n    }\n    \n};\n\n/**\n * @State Controller\n */\nexport const _State = __State => class extends _Root(__State) {\n        \n    static testSchema(jsonSchema) {\n        return _arrFrom(jsonSchema.type).includes('boolean');\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(new (Schemas._Boolean())(jsonSchema), ownerWidget);\n        this.attrs.type = 'checkbox';\n        if (this.schema.const === true || this.schema.default === true) {\n            this.attrs.checked = true;\n        }\n    }\n\n    json(data = {}) {\n        if (arguments.length) return;\n        return this.attrs.multiple ? [] : null;\n    }\n    \n};\n\n/**\n * @Root Base Controller\n */\nexport const _ItemScope = __ItemScope => class extends (__ItemScope || class {}) {\n\n    define(schema, ownerWidget = null) {\n        super.define(...arguments);\n        const setItemIndex = () => {\n            if ((this.attrs.index || this.attrs.index === 0) && this.childEntries && this.schema.indexProperty && this.childEntries[this.schema.indexProperty]) {\n                this.childEntries[this.schema.indexProperty].json(this.attrs.index);\n            }\n        };\n        setItemIndex();\n        Observer.observe(this.attrs, 'index', setItemIndex);\n    }\n    \n}","\n/**\n * @imports\n */\nimport Observer from '@webqit/observer';\nimport { _from as _arrFrom, _intersect } from '@webqit/util/arr/index.js';\nimport { _isString, _isNumeric, _isTypeObject } from '@webqit/util/js/index.js';\nimport { _toTitle } from '@webqit/util/str/index.js';\nimport * as Roots from './playui-mixins.js';\n\n/**\n * ---------------------------\n * Root Elements\n * ---------------------------\n */\n\n/**\n * @Root Element\n * @extends __Root\n */\nexport const _Root = __Root => class extends (__Root || HTMLElement) {\n\n    constructor() {\n        super();\n        const mutationObserver = new MutationObserver(entries => {\n            entries.forEach(entry => {\n                entry.removedNodes.forEach(node => {\n                    if (this.nodeRemovalListeners && this.nodeRemovalListeners.has(node)) {\n                        this.nodeRemovalListeners.get(node).forEach(callback => callback());\n                    }\n                });\n            });\n        });\n        mutationObserver.observe(this, { subtree: true, childList: true });\n    }\n\n    async remoteAction(method, url, options = {}) {\n        this.state.remoteAction = method;\n        this.state.remoteActionError = '';\n        return fetch(url, { headers: { accept: 'application/json' }, ...options, method }).then(res => {\n            this.state.remoteAction = false;\n            return res;\n        }).catch(e => {\n            this.state.remoteAction = false;\n            this.alert(e);\n        });\n    }\n\n    static get subscriptMethods() {\n        return [ 'renderBasic', 'render' ];\n    }\n\n    connectedCallback() {\n        this.renderBasic();\n        this.render();\n    }\n\n    renderBasic() {\n        //if (typeof $ === 'undefined') return;\n        console.log('-------------------this.schema?.title', this, this.schema);\n        if (this.schema?.title && this.namespace.title) {\n            $(this.namespace.title).html(this.schema.title);\n        }\n        if (this.schema?.description && this.namespace.description) {\n            $(this.namespace.description).html(this.schema.description);\n        }\n        if (this.schema?.isRequired) {\n            $(this).attr('data-required', true);\n        }\n        if (this.schema?.col && this.schema.col !== 12) {\n            $(this).class({\n                ['col-' + this.schema.col]: true,\n                'col-12': false,\n            });\n        } else {\n            $(this).class('col-12', true);\n        }\n        if (this.schema?.display === 'hidden') {\n            $(this).class('overflow-hidden wt-0 ht-0 pd-0 mg-0', true);\n        }\n        $(this).attr('data-remote-action', this.state.remoteAction || false);\n        $(this).attr('data-remote-action-error', this.state.remoteActionError || false);\n        var message = this.state.alert ? this.state.alert.message : '';\n        var type = this.state.alert ? this.state.alert.type : '';\n        if (this.namespace.alert) {\n            $(this.namespace.alert).html(message || '');\n            $(this.namespace.alert).attr('data-type', type || false);\n            if (message) {\n                this.namespace.alert.focus();\n            }\n        }\n    }\n\n    render() {}\n\n    alert() {\n        const ret = super.alert(...arguments);\n        this.renderBasic();\n        return ret;\n    }\n\n};\n\n/**\n * @ParentRoot Element\n * @extends _Root() -> __ParentRoot\n */\nexport const _ParentRoot = __ParentRoot => class extends _Root(__ParentRoot) {\n\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.namespace.adder) {\n            this.adderAction = this.adderAction || (() => this.extend());\n            this.namespace.adder.removeEventListener('click', this.adderAction);\n            this.namespace.adder.addEventListener('click', this.adderAction);\n        }\n    }\n\n    deriveChildEntry(childSchema, i) {\n        if (!this.template) return;\n        var childEntry = Reflect.ownKeys(this.template.exports).map(key => this.template.exports[key][0]).reduce((match, item) => {\n            if (match) return match;\n            const constructor = item.hasAttribute('is') \n                ? customElements.get(item.getAttribute('is'))\n                : customElements.get(item.localName);\n            return constructor && constructor.testSchema(childSchema) ? item : null;\n        }, null);\n        if (childEntry) {\n            childEntry = childEntry.cloneNode(true);\n            if (this.namespace.content) {\n                this.namespace.content.append(childEntry);\n            } else {\n                this.append(childEntry);\n            }\n            // ------------\n            try {\n                childEntry.define(childSchema, this);\n                (childEntry.attrs || {}).index = i;\n            } catch(e) {\n                console.warn(`Error calling element.define();`, e, this);\n            }\n        }\n        return childEntry;\n    }\n\n};\n\n/**\n * @Collection Element\n * @extends _ParentRoot() -> Roots._Collection() -> __Collection\n */\nexport const _Collection = __Collection => class extends _ParentRoot(Roots._Collection(__Collection || HTMLElement)) {\n\n    get value() {\n        if (this.schema.primaryKey && this.childEntries[this.schema.primaryKey]) {\n            return this.childEntries[this.schema.primaryKey].json();\n        }\n    }\n    \n};\n\n/**\n * @MultipleRoot Element\n * @extends _ParentRoot() -> __MultipleRoot\n */\nexport const _MultipleRoot = __MultipleRoot => class extends _ParentRoot(__MultipleRoot) {\n};\n\n/**\n * @Multiple Element\n * @extends _MultipleRoot() -> Roots._Multiple() -> __Multiple\n */\nexport const _Multiple = __Multiple => class extends _MultipleRoot(Roots._Multiple(__Multiple || HTMLElement)) {\n};\n\n/**\n * @Multiple2 Element\n * @extends _MultipleRoot() -> Roots._Multiple2() -> __Multiple2\n */\nexport const _Multiple2 = __Multiple2 => class extends _MultipleRoot(Roots._Multiple2(__Multiple2 || HTMLElement)) {\n\n    constructor() {\n        super();\n        this.addEventListener('keypress', e => {\n            if (e.key === 'Enter') {\n                this.extend(childEntry => childEntry.namespace.input ? childEntry.namespace.input.focus() : null);\n                e.preventDefault();\n            }\n        });\n    }\n\n    extend(callback = null) {\n        if (this.childEntries.length && !this.childEntries[this.childEntries.length - 1].namespace.input.value) {\n            return;\n        }\n        return super.extend(callback);\n    }\n\n    render() {\n        if (this.namespace.input && this.attrs?.name) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @EnumRoot Element\n * @extends _Root() -> __EnumRoot\n */\nexport const _EnumRoot = __EnumRoot => class extends _Root(__EnumRoot) {\n\n    deriveEnumEntry(entry, i) {\n        var enumEntry;\n        if (!this.template && this.namespace.input instanceof HTMLSelectElement) {\n            enumEntry = document.createElement('option');\n        } else {\n            var _enumEntry = Reflect.ownKeys(this.template.exports).map(key => this.template.exports[key][0]).reduce((match, item) => {\n                if (match) return match;\n                const constructor = item.hasAttribute('is') \n                    ? customElements.get(item.getAttribute('is'))\n                    : customElements.get(item.localName);\n                return constructor && constructor.testSchema(this.schema, entry) ? item : null;\n            }, null);\n            if (_enumEntry) {\n                enumEntry = _enumEntry.cloneNode(true);\n            }\n        }\n        if (enumEntry) {\n            if (this.namespace.input instanceof HTMLSelectElement) {\n                this.namespace.input.options.add(enumEntry);\n                enumEntry.setAttribute('label', entry.label || _toTitle(entry.value));\n                enumEntry.value = entry.value;\n                enumEntry.selected = entry.selected;\n            } else {\n                this.namespace.input.append(enumEntry);\n                enumEntry.setAttribute('data-index', itemIndex);\n            }\n        }\n        return enumEntry;\n    }\n\n    render() {\n        if (this.namespace.input && this.attrs?.name) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @Enum Element\n * @extends _EnumRoot() -> Roots._Enum() -> __Enum\n */\nexport const _Enum = __Enum => class extends _EnumRoot(Roots._Enum(__Enum || HTMLElement)) {\n}\n\n/**\n * @Enum2 Element\n * @extends _EnumRoot() -> Roots._Enum2() -> __Enum2\n */\nexport const _Enum2 = __Enum2 => class extends _EnumRoot(Roots._Enum2(__Enum2 || HTMLElement)) {\n}\n\n/**\n * @File Element\n * @extends _Root() -> Roots._File() -> __FileRoot\n */\nexport const _File = __File => class extends _Root(Roots._File(__File || HTMLElement)) {\n\n    constructor() {\n        super();\n        // ------------------\n        // On-direct choosing\n        // ------------------\n        this.addEventListener('change', e => {\n            if (this.namespace.dropArea) {\n                this.populate(Array.from(e.target.files).map(file => ({ file })), 1);\n            }\n        });\n        this._handlerDrag = e => {\n            if (e.type === 'dragover' || e.type === 'dragenter') {\n                if (this.state) {\n                    this.state.dragging = true;\n                }\n            } else if (e.type === 'dragleave' || e.type === 'dragend' || e.type === 'drop') {\n                e.preventDefault();\n                if (this.state) {\n                    this.state.dragging = false;\n                }\n                if (e.type === 'drop') {\n                    this.populate(Array.from(e.dataTransfer.files).map(file => ({ file })));\n                }\n            }\n        };\n        Observer.observe(this.filesList, mutations => {\n            if (mutations[0].name === 'length' || !this.namespace.input) return;\n            const dataTransfer = new DataTransfer;\n            this.filesList.map(entry => entry.file).filter(file => !_isString(file)).forEach(file => {\n                dataTransfer.items.add(file);\n            });\n            // Assign the files to the input element\n            this.namespace.input.files = dataTransfer.files;\n            // Still keep the \"required\" attribute?\n            if (this.schema.isRequired) {\n                if (!this.namespace.input.files.length && this.filesList.length && this.filesList[0]/* IMPORTANT: item 0 may be \"undefined\" */) {\n                    // Then there must be files added by link\n                    this.namespace.input.removeAttribute('required');\n                } else {\n                    // Restore\n                    this.namespace.input.setAttribute('required', true);\n                }\n            }\n        });\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.namespace.dropArea) {\n            // On drag-and-drop\n            [ 'drag', 'dragstart', 'dragend', 'dragover', 'dragenter', 'dragleave', 'drop' ].forEach(eventName => {\n                this.namespace.dropArea.removeEventListener(eventName, this._handlerDrag);\n                this.namespace.dropArea.addEventListener(eventName, this._handlerDrag);\n            });\n        }\n    }\n\n    define(jsonSchema, ownerWidget = null) {\n        super.define(...arguments);\n        this.render();\n    }\n\n    deriveFileEntry(fileData, i, clearByTag = null) {\n        if (!this.template) return;\n        var childEntry = Reflect.ownKeys(this.template.exports).map(key => this.template.exports[key][0]).reduce((match, item) => {\n            if (match) return match;\n            const constructor = item.hasAttribute('is') \n                ? customElements.get(item.getAttribute('is'))\n                : customElements.get(item.localName);\n            return constructor && constructor.testFile(fileData) ? item : null;\n        }, null);\n        if (childEntry) {\n            childEntry = childEntry.cloneNode(true);\n            childEntry.file = fileData._file || fileData.file;\n            if (_isString(fileData.file)) {\n                const defaultInput = document.createElement('input');\n                defaultInput.setAttribute('name', this.attrs.name);\n                defaultInput.setAttribute('value', fileData.file);\n                defaultInput.setAttribute('type', 'hidden');\n                childEntry.append(defaultInput);\n                childEntry.setAttribute('data-src', fileData.file);\n                if (_intersect(_arrFrom(clearByTag), [ 1, 2 ]).length === 2 && !this.schema.remoteDelete) {\n                    childEntry.setAttribute('data-isdefault', 'true');\n                }\n            }\n            if (this.namespace.preview) {\n                this.namespace.preview.append(childEntry);\n            } else {\n                this.append(childEntry);\n            }\n            // ------------\n            try {\n                childEntry.previewFile(fileData.file, this);\n            } catch(e) {\n                console.warn(`Error calling element.previewFile();`, e, this);\n            }\n        }\n        return childEntry;\n    }\n\n    render() {\n        if (this.namespace.input && (this.attrs?.type || this.attrs?.name)) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @FilePreview Element\n * @extends __FilePreview\n */\nexport const _FilePreview = __FilePreview => class extends (__FilePreview || HTMLElement) {\n\n    connectedCallback() {\n        if (super.connectedCallback) {\n            super.connectedCallback();\n        }\n        if (this.namespace.deleter) {\n            this.deleterAction = this.deleterAction || (() => {\n                if (this.ownerWidget) {\n                    this.ownerWidget.execNodeRemoval(this, (msg, done) => {\n                        if (confirm(msg)) {\n                            $(this).attr('data-deleting', true);\n                            done().then(res => {\n                                $(this).attr('data-deleting', false);\n                                // This dry populate() should trigger restoration\n                                // of fallbackFiles. (See this.ownerWidget.populate())\n                                this.ownerWidget.populate([], [ 1, 2 ]);\n                            });\n                        }\n                    });\n                }\n            });\n            this.namespace.deleter.removeEventListener('click', this.deleterAction);\n            this.namespace.deleter.addEventListener('click', this.deleterAction);\n        }\n    }\n\n    static testFile(fileData) {\n        return true;\n    }\n\n    async previewFile(file, ownerWidget) {\n        this.ownerWidget = ownerWidget;\n        if (_isString(file)) {\n            const response = await fetch(file);\n            const data = response.ok ? await response.blob() : '';\n            file = new File([data], file.split('/').pop(), {\n                type: response.headers.get('content-type') || 'application/octet-stream',\n            });\n        }\n        // Show thumnails\n        var desc = `${file.name}: ${file.size / 1024}KB`;\n        var revokeURL = el => window.URL.revokeObjectURL(el.src);\n        if (/^image\\//.test(file.type)) {\n            var img = document.createElement('img');\n            img.onload = e => { revokeURL(img); };\n            img.src = window.URL.createObjectURL(file);\n            this.append(img);\n            return;\n        }\n        if (/^video\\//.test(file.type)) {\n            var media = document.createElement('video');\n            media.onloadstart/*canplay*/ = e => { revokeURL(media); media.play(); };\n            media.src = window.URL.createObjectURL(file);\n            media.muted = true;\n            this.append(media);\n            return;\n        }\n        const el = document.createElement('i');\n        el.classList.add('bi');\n        var type = 'file';\n        if (/^audio\\//.test(file.type)) {\n            type = 'music';\n        } else if (/msword|ms-word|wordprocessing/.test(file.type)) {\n            type = 'word';\n        } else if (/powerpoint|presentation/.test(file.type)) {\n            type = 'powerpoint';\n        } else if (/excel|spreadsheet/.test(file.type)) {\n            type = 'excel';\n        } else if (/^text\\//.test(file.type)) {\n            type = 'text';\n        } else if (/\\/pdf/.test(file.type)) {\n            type = 'pdf';\n        } else if (/\\/zip/.test(file.type)) {\n            type = 'zip';\n        }\n        el.classList.add('bi-file-' + type);\n        this.append(el);\n        return;\n    }\n\n}\n\n/**\n * @Input Element\n * @extends _Root() -> __Input\n */\nexport const _Input = __Input => class extends _Root(__Input) {\n\n    json(data = null) {\n        if (arguments.length) {\n            this.namespace.input.value = data;\n            return;\n        }\n        return this.namespace.input.value;\n    }\n\n    render() {\n        if (this.namespace.input && (this.attrs?.type || this.attrs?.name)) {\n            $(this.namespace.input).attr(this.attrs);\n        }\n    }\n\n};\n\n/**\n * @Editor Element\n * @extends _Input() -> Roots._Editor() -> __Editor\n */\nexport const _Editor = __Editor => class extends _Input(Roots._Editor(__Editor || HTMLElement)) {\n};\n\n/**\n * @Text Element\n * @extends _Input() -> Roots._Text() -> __Text\n */\nexport const _Text = __Text => class extends _Input(Roots._Text(__Text || HTMLElement)) {\n};\n\n/**\n * @Number Element\n * @extends _Input() -> Roots._Number() -> __Number\n */\nexport const _Number = __Number => class extends _Input(Roots._Number(__Number || HTMLElement)) {\n};\n\n/**\n * @State Element\n * @extends _Input() -> Roots._State() -> __State\n */\nexport const _State = __State => class extends _Input(Roots._State(__State || HTMLElement)) {\n\n    json(data = null) {\n        if (arguments.length) {\n            this.namespace.input.checked = data === true || data + '' === this.namespace.input.value;\n            return;\n        }\n        return this.namespace.input.checked ? this.namespace.input.value : null;\n    }\n\n};\n\n/**\n * @ItemScope Element\n * @extends __ItemScope\n */\nexport const _ItemScope = __ItemScope => class extends Roots._ItemScope(__ItemScope || HTMLElement) {\n\n    connectedCallback() {\n        if (super.connectedCallback) {\n            super.connectedCallback();\n        }\n        if (this.namespace.deleter) {\n            this.deleterAction = this.deleterAction || (() => {\n                if (this.ownerWidget) {\n                    this.ownerWidget.execNodeRemoval(this, (msg, done) => {\n                        if (confirm(msg)) {\n                            $(this).attr('data-deleting', true);\n                            done().then(res => {\n                                $(this).attr('data-deleting', false);\n                            });\n                        }\n                    });\n                }\n            });\n            this.namespace.deleter.removeEventListener('click', this.deleterAction);\n            this.namespace.deleter.addEventListener('click', this.deleterAction);\n        }\n    }\n\n};\n","\n/**\n * @imports\n */\nimport * as WidgetElements from './playui-element-mixins.js';\n\n/**\n * ---------------------------\n * @playui widgets\n * ---------------------------\n */\nconst { SubscriptElement } = WebQit.OOHTML;\n\nconst FormWidget = class extends WidgetElements._Collection(SubscriptElement(HTMLFormElement)) {};\ncustomElements.define('playui-form-widget', FormWidget, { extends: 'form' });\n\nconst CollectionWidget = class extends WidgetElements._Collection(SubscriptElement(HTMLFieldSetElement)) {};\nconst MultipleWidget = class extends WidgetElements._Multiple(SubscriptElement(HTMLFieldSetElement)) {};\nconst Multiple2Widget = class extends WidgetElements._Multiple2(SubscriptElement(HTMLFieldSetElement)) {};\nconst EnumWidget = class extends WidgetElements._Enum(SubscriptElement(HTMLDivElement)) {};\nconst Enum2Widget = class extends WidgetElements._Enum2(SubscriptElement(HTMLDivElement)) {};\nconst FileWidget = class extends WidgetElements._File(SubscriptElement(HTMLDivElement)) {};\nconst EditorWidget = class extends WidgetElements._Editor(SubscriptElement(HTMLDivElement)) {};\nconst TextWidget = class extends WidgetElements._Text(SubscriptElement(HTMLDivElement)) {};\nconst NumberWidget = class extends WidgetElements._Number(SubscriptElement(HTMLDivElement)) {};\nconst StateWidget = class extends WidgetElements._State(SubscriptElement(HTMLDivElement)) {};\ncustomElements.define('playui-collection-widget', CollectionWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple-widget', MultipleWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple2-widget', Multiple2Widget, { extends: 'fieldset' });\ncustomElements.define('playui-enum-widget', EnumWidget, { extends: 'div' });\ncustomElements.define('playui-enum2-widget', Enum2Widget, { extends: 'div' });\ncustomElements.define('playui-file-widget', FileWidget, { extends: 'div' });\ncustomElements.define('playui-editor-widget', EditorWidget, { extends: 'div' });\ncustomElements.define('playui-text-widget', TextWidget, { extends: 'div' });\ncustomElements.define('playui-number-widget', NumberWidget, { extends: 'div' });\ncustomElements.define('playui-state-widget', StateWidget, { extends: 'div' });\n\nconst CollectionItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Collection(SubscriptElement(HTMLFieldSetElement))) {};\nconst MultipleItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Multiple(SubscriptElement(HTMLFieldSetElement))) {};\nconst Multiple2ItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Multiple2(SubscriptElement(HTMLFieldSetElement))) {};\nconst EnumItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Enum(SubscriptElement(HTMLDivElement))) {};\nconst Enum2ItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Enum2(SubscriptElement(HTMLDivElement))) {};\nconst FileItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._File(SubscriptElement(HTMLDivElement))) {};\nconst EditorItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Editor(SubscriptElement(HTMLDivElement))) {};\nconst TextItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Text(SubscriptElement(HTMLDivElement))) {};\nconst NumberItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._Number(SubscriptElement(HTMLDivElement))) {};\nconst StateItemScopeWidget = class extends WidgetElements._ItemScope(WidgetElements._State(SubscriptElement(HTMLDivElement))) {};\ncustomElements.define('playui-collection-itemscope-widget', CollectionItemScopeWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple-itemscope-widget', MultipleItemScopeWidget, { extends: 'fieldset' });\ncustomElements.define('playui-multiple2-itemscope-widget', Multiple2ItemScopeWidget, { extends: 'fieldset' });\ncustomElements.define('playui-enum-itemscope-widget', EnumItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-enum2-itemscope-widget', Enum2ItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-file-itemscope-widget', FileItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-editor-itemscope-widget', EditorItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-text-itemscope-widget', TextItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-number-itemscope-widget', NumberItemScopeWidget, { extends: 'div' });\ncustomElements.define('playui-state-itemscope-widget', StateItemScopeWidget, { extends: 'div' });\n\nconst FilePreview = class extends WidgetElements._FilePreview(HTMLDivElement) {};\ncustomElements.define('playui-file-preview', FilePreview, { extends: 'div' });\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","val","internals","namespaces","globalThis","WebQitInternalsRegistry","Map","_ns","_itnls","itnls","set","shift","Array","isArray","arguments","length","undefined","keys","toString","Number","isNaN","String","castObject","slice","values","equals","a","b","dotSafe","join","reduce","prev","i","arr","arr2","callback","filter","val1","val2","indexOf","paths2D","paths","pathsIs2D","multiple","path","concat","map","DotSafePath","resolve","static","every","v","includes","yes","pathsIsDynamic","pathArray","seg","Firebase","constructor","target","this","fireables","currentlyFiring","add","fireable","push","remove","_fireable","removeMatches","dfn","match","forEach","fireableFilter","fireableTags","params","tags","dfnFilter","dfnTags","originalHandler","handler","type","createIfNotExists","namespace","__namespace","Error","ImplementationClass","WebQitObserverNamespaceRegistry","has","name","Fireable","disconnect","disconnected","Interceptor","fire","event","next","recieved","returnValue","k","parseFloat","Action","seal","Interceptors","super","action","defaultHandler","index","_args","interceptor","args","pop","_getFirebase","_namespace","payload","interceptors","_val","Reflect","getFirebase","thisArgument","argumentsList","_exec","newTarget","amount","count","itm","firsts","startsWith","after","fromInex","last","subsetIndex","cursors","cursorA","cursorB","_cursorB","_cursors","Event","cancellable","_","propagationStopped","defaultPrevented","promisesInstance","promises","stopPropagation","preventDefault","waitUntil","promise","Promise","all","respondWith","rspns","proms","isEvent","Observer","filters2D","filtersIsOriginally2D","filtersIsDynamic","changes","delta","prevTest","diff","oldValue","evt","matches","observerPathArray","observerPathArray_Resolved","_seg","subtree","suptree","changesObject","e","Mutation","originalSubject","Observers","buffers","reverse","d","observer","receiver","_keys","defaultGet","_value","touch","related","mergeCallback","objs","deepProps","isReplace","withSymbols","depth","obj1","obj2","until","keysAll","prototypalChain","getPrototypeOf","items","getOwnPropertyNames","valAtObj1","valAtObj2","getOwnPropertyDescriptor","existing","observers","isUserObject","build","unique","field","observe","eventObject","_changes","src","c","linkTag","_event","eventTypeReturn","_paths2D","rootLevelKeysToObserve","subLevelKeysToObserve","p","subBuild","_isFunction","Function","window","unobserve","define","keysOrPayload","handleSet","detail","descriptor","isUpdate","defaultSet","_success","restore","success","unlink","events","successfulEvents","successCount","_setOrDefine","defaultDel","self","apply","construct","deleteProperty","isExtensible","ownKeys","preventExtensions","setPrototypeOf","accessorize","successFlags","getDescriptorDeep","proto","altOriginalOwnDescriptor","activeIsAltOriginalOwnDescriptor","originalOwnDescriptor","writable","configurable","reactiveOwnDescriptor","controlObject","ongoingGets","newValue","ongoingSets","operation","intact","delete","attemptRestore","unaccessorize","proxy","Proxy","propertyKey","attributes","proxyAutoBinding","test","bind","unproxy","intercept","trap","returnObj","isOriginallyObj","unintercept","_isObject","closure","subjects","context","subjectCopy","result","fireDiffs","cntxt","initialKeys","currentKeys","buffered","then","link","str","strict","replace","txt","charAt","toUpperCase","substr","toLowerCase","_isTextMediaType","contentMediaType","_Schema","__Schema","jsonSchema","validate","instance","valid","_ObjectOrArray","__ObjectOrArray","validity","_validateMin","_validateMax","error","violation","_Object","__Object","getPropertyNameSchema","instanceHint","propertyNameSchema","propertyNames","additionalProperties","isRequired","getPropertySchema","propertyName","propertySchema","properties","_patternPropertiesMatch","required","instanceProperties","requiringProp","dependentRequired","masterHint","master","patternProperties","pattern","RegExp","_validateRequired","_validateDependentRequired","maxProperties","minProperties","_Array","__Array","getItemSchema","itemIndex","itemSchema","prefixItems","_validateUnique","_validateContains","min","max","desc","maxItems","minItems","uniqueItems","contains","passes","item","__validateContains","minContains","maxContains","_String","__String","_Num","__Num","_Number","__Number","_Integer","__Integer","isInteger","_Boolean","__Boolean","_Null","__Null","_Root","__Root","nodeRemovalListeners","execNodeRemoval","node","onNodeRemoval","listeners","async","method","url","options","pair","schema","ownerWidget","attrs","state","title","replaceAll","const","default","readOnly","readonly","alert","message","json","_ParentRoot","__ParentRoot","deriveChildEntry","childSchema","_Collection","__Collection","childEntries","mutations","m","console","warn","display","extend","promptPropertyName","_propertyName","data","autoExtend","childEntry","_data","details","_alert","_Multiple","__Multiple","splice","confirm","msg","done","parseInt","remoteDelete","deleteUrl","remoteAction","res","ok","entry","_Multiple2","__Multiple2","testSchema","enum","entries","widgetLineContentLengthLimit","lineContentLengthLimit","some","Math","minLength","maxLength","_Enum","__Enum","enumEntries","schemaName","getSchemaName","runSchemaEnum","enumValues","enumNames","label","enumerate","runSchemaEnumFetch","remoteFetch","enumFetching","headers","accept","reject","statusText","_entries","id","selected","deriveEnumEntry","enumData","clearByTag","placeholder","enumTag","runSelect","_Enum2","__Enum2","_File","__File","filesList","_isFileSchema","_jsonSchema","format","contentEncoding","schemaType","$schema","deriveFileEntry","fileData","populate","filesData","fallbackFilesList","_enumTag","_entry","file","files","uploads","_Input","__Input","examples","_Editor","__Editor","_Text","__Text","maxlength","minlength","col","exclusiveMaximum","maximum","exclusiveMinimum","minimum","multipleOf","step","_State","__State","checked","_ItemScope","__ItemScope","setItemIndex","indexProperty","HTMLElement","MutationObserver","removedNodes","childList","remoteActionError","fetch","catch","subscriptMethods","connectedCallback","renderBasic","render","log","$","html","description","attr","class","focus","ret","adder","adderAction","removeEventListener","addEventListener","template","hasAttribute","customElements","getAttribute","localName","cloneNode","content","append","primaryKey","_MultipleRoot","__MultipleRoot","input","_EnumRoot","__EnumRoot","enumEntry","HTMLSelectElement","document","createElement","_enumEntry","setAttribute","dropArea","from","_handlerDrag","dragging","dataTransfer","DataTransfer","removeAttribute","eventName","testFile","_file","defaultInput","preview","previewFile","_FilePreview","__FilePreview","deleter","deleterAction","response","blob","File","split","size","revokeURL","el","URL","revokeObjectURL","img","onload","createObjectURL","media","onloadstart","play","muted","classList","SubscriptElement","WebQit","OOHTML","FormWidget","HTMLFormElement","extends","CollectionWidget","HTMLFieldSetElement","MultipleWidget","Multiple2Widget","EnumWidget","HTMLDivElement","Enum2Widget","FileWidget","EditorWidget","TextWidget","NumberWidget","StateWidget","CollectionItemScopeWidget","MultipleItemScopeWidget","Multiple2ItemScopeWidget","EnumItemScopeWidget","Enum2ItemScopeWidget","FileItemScopeWidget","EditorItemScopeWidget","TextItemScopeWidget","NumberItemScopeWidget","StateItemScopeWidget","FilePreview"],"sourceRoot":""}