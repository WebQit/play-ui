(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function s(e){return typeof e}function i(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var s,i,r=globalThis.WebQitInternalsRegistry.get(e);if(!r){if(r=new Map,!1===t[0])return r;globalThis.WebQitInternalsRegistry.set(e,r)}for(;s=t.shift();)if((i=r)&&!(r=r.get(s))){if(r=new Map,!1===t[0])return r;i.set(s,r)}return r}function r(e){return Array.isArray(e)}function n(e){return"function"==typeof e}function a(e){return null===e||""===e}function l(e){return arguments.length&&(void 0===e||void 0===e)}function c(e){return Array.isArray(e)||"object"==typeof e&&e||n(e)}function o(e){return a(e)||l(e)||!1===e||0===e||c(e)&&!Object.keys(e).length}function h(e){return n(e)||e&&"[object function]"==={}.toString.call(e)}function u(e){return e instanceof Number||"number"==typeof e}function d(e){return u(e)||!0!==e&&!1!==e&&null!==e&&""!==e&&!isNaN(1*e)}function m(e){return!Array.isArray(e)&&"object"==typeof e&&e}function p(e){return e instanceof String||"string"==typeof e&&null!==e}function f(e,t=!0){return r(e)?e:!t&&m(e)?[e]:!1!==e&&0!==e&&o(e)?[]:function(e){return!p(e)&&!l(e.length)}(e)?Array.prototype.slice.call(e):m(e)?Object.values(e):[e]}function v(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?e.join(".")===t.join("."):e.length===t.length&&e.reduce(((e,s,i)=>e&&s===t[i]),!0)}function g(e,t,s=null){return r(t)?e.filter((e=>s?t.filter((t=>s(e,t))).length:-1!==t.indexOf(e))):[]}function y(e){return(x(e)?e:f(e).length?[e]:[]).reduce(((e,t)=>e.concat([f(t)])),[]).map((e=>b.resolve(e)))}e.r(t),e.d(t,{_Array:()=>ve,_Boolean:()=>Ee,_Integer:()=>xe,_Null:()=>we,_Num:()=>ye,_Number:()=>be,_Object:()=>fe,_ObjectOrArray:()=>pe,_Schema:()=>me,_String:()=>ge}),new Map;class b extends Array{static resolve(e){return e.every((e=>!(e+"").includes(".")))?(new b).concat(e):e}get dotSafe(){return!0}}function x(e){return f(e).reduce(((e,t)=>e||r(t)),!1)}function E(e){return e.filter((e=>e||0===e)).length!==e.length}class w{constructor(e){this.target=e,this.fireables=[],this.currentlyFiring=[]}add(e){return this.fireables.push(e),e}remove(e){this.fireables=this.fireables.filter((t=>t!==e))}removeMatches(e){this.match(e).forEach((e=>{this.fireables=this.fireables.filter((t=>t!==e))}))}match(e){return this.fireables.filter((t=>{var s=y(t.filter),i=f((t.params||{}).tags),r=y(e.filter),n=f((e.params||{}).tags);return(!e.originalHandler||t.handler===e.originalHandler)&&(!r.length||v(r,s))&&(!n.length||n.length===i.length&&g(i,n).length===n.length)}))}static _getFirebase(e,t,r=!0,n=this.__namespace){if(!c(t))throw new Error('Subject must be of type object; "'+s(t)+'" given!');var a=this;return n&&globalThis.WebQitObserverNamespaceRegistry.has(e+"-"+n)&&(a=globalThis.WebQitObserverNamespaceRegistry.get(e+"-"+n),e+="-"+n),!i(t,"firebases").has(e)&&r&&i(t,"firebases").set(e,new a(t)),i(t,"firebases").get(e)}static _namespace(e,t,s=null){if(e+="-"+t,2===arguments.length)return globalThis.WebQitObserverNamespaceRegistry.get(e);if(!(s.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${t} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(e,s),s.__namespace=t}}globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);class j{constructor(e,t){this.target=e,this.handler=t.handler,this.filter=t.filter,this.params=t.params}disconnect(){this.disconnected=!0}}class O extends j{fire(e,t,s){return this.disconnected||this.filter&&!g(f(this.filter),[e.type]).length?t(...Array.prototype.slice.call(arguments,2)):this.handler(e,s,t)}}function L(e,t){var s=void 0;return c(e)&&Object.keys(e).forEach(((i,r)=>{!1!==s&&(s=t(d(i)?parseFloat(i):i,e[i],r))})),s}class P{constructor(e,t){if(this.target=e,!t.type)throw new Error("Action type must be given in definition!");L(t,((e,t)=>{Object.defineProperty(this,e,{value:t,enumerable:!0})})),Object.seal(this)}}class M extends w{add(e){return super.add(new O(this.target,e))}fire(e,t=null){if(e instanceof P||(e=new P(this.target,e)),this.currentlyFiring.filter((t=>t.type===e.type&&t.name===e.name)).length)return t?t():void 0;this.currentlyFiring.push(e);const s=(i,...r)=>{var n=this.fireables[i];return n?n.fire(e,((...e)=>s(i+1,...e)),...r):t?t(...r):r[0]};var i=s(0);return this.currentlyFiring.pop(),i}static getFirebase(e,t=!0,s=null){return super._getFirebase("interceptor",...arguments)}static namespace(e,t=null){return super._namespace("interceptor",...arguments)}}function T(e){return i(e,!1).get(e)||e}function R(e,t,s={},i={}){if(!t||!c(t))throw new Error("Target must be of type object!");t=T(t);var r,n=function(i){return arguments.length?i:Reflect[e](t,...Object.values(s))};return(r=M.getFirebase(t,!1,i.namespace))?r.fire({type:e,...s},n):n()}function _(e,t,s,i={}){return R("apply",e,{thisArgument:t,argumentsList:s},i)}function S(e,t,s=null,i={}){return R("construct",e,arguments.length>2?{argumentsList:t,newTarget:s}:{argumentsList:t},i)}function k(e,t=1){var s=0;e.forEach((e=>{s++}));var i=e.slice(e.length-s,t);return arguments.length>1?i:i[0]}function N(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?(e.join(".")+".").startsWith(t.join(".")+"."):t.reduce(((t,s,i)=>t&&s===e[i]),!0)}function A(e,t,s=null,i=!1){var r=function(e,t,s=null,i=!1){return t.length>e.length?-1:("number"==typeof s?i?e.slice(0,s+1+(s<0?e.length:0)):e.slice(s):e).reduce(((e,s,r)=>{var[n,a,l]=e;if(!i&&n>-1)return[n,a,l];var c=l+1,o=s===t[c]?0===c?[r,0]:[a,c]:[-1,-1];return o[1]===t.length-1&&(o[1]=-1,o[0]>-1)?[o[0]].concat(o):[n].concat(o)}),[-1,-1,-1])[0]+(i||"number"!=typeof s?0:s>-1?s:e.length-s)}(e,t,s,i);return-1===r?[]:e.slice(r+t.length)}class F{constructor(e,t=!1){this._={},this._.target=e,this._.cancellable=t,this._.propagationStopped=!1,this._.defaultPrevented=!1,this._.promisesInstance=null,this._.promises=[]}get target(){return this._.target}get cancellable(){return this._.cancellable}stopPropagation(){this._.propagationStopped=!0}get propagationStopped(){return this._.propagationStopped}preventDefault(){this._.defaultPrevented=!0}get defaultPrevented(){return this._.defaultPrevented}waitUntil(e){e instanceof Promise&&(this._.promises.push(e),this._.promisesInstance=null)}get promises(){return!this._.promisesInstance&&this._.promises.length&&(this._.promisesInstance=Promise.all(this._.promises)),this._.promisesInstance}respondWith(e){var t,s=m(e)&&!l(e.propagationStopped)&&!l(e.defaultPrevented);!1===e||s&&e.propagationStopped?this.stopPropagation():!1===e||s&&e.defaultPrevented?this.preventDefault():(e instanceof Promise&&(t=e)||s&&(t=e.promises))&&this.waitUntil(t)}}class D extends j{constructor(e,t){if(super(e,t),this.filters2D=y(this.filter),this.filtersIsOriginally2D=x(this.filter),this.filtersIsDynamic=this.filters2D.filter((e=>E(f(e)))).length>0,this.filtersIsDynamic&&this.filters2D.length>1)throw new Error('Only one "Dynamic Filter" must be observed at a time! "'+this.filters2D.map((e=>"["+e.join(", ")+"]")).join(", ")+'" have been bound together.')}fire(e){if(this.disconnected||this.params.type&&(t=e=>this.params.type===e.type,!e.reduce(((e,s,i)=>e||t(s)),!1)))return;var t;const s=e=>!["set","def"].includes(e.type)||!this.params.diff||(h(this.params.diff)?this.params.diff(e.value,e.oldValue):e.value!==e.oldValue);var i=new F(this.target);if(this.filters2D.length){var r=e.filter((e=>this.filters2D.filter(((t,i)=>{var r=t.slice();return this.filtersIsDynamic&&e.path.forEach(((e,t)=>{r[t]=r[t]||0===r[t]?r[t]:e})),(!this.filtersIsDynamic||!E(r))&&s(e)&&(!this.params.subtree&&v(r,e.path)||this.params.suptree&&N(r,e.path)&&(!d(this.params.suptree)||A(r,e.path).length<=this.params.suptree)||this.params.subtree&&e.path.length>=r.length&&N(e.path,r)&&(!d(this.params.subtree)||A(e.path,r).length<=this.params.subtree))})).length));if(r.length)if(this.filtersIsOriginally2D||this.params.subtree){var n=r;m(this.filter)&&(n={...this.filter},r.forEach(((e,t)=>{n[e.name]=e}))),i.respondWith(this.handler(n,i))}else r.forEach(((e,t)=>{i.respondWith(this.handler(e,i))}))}else(this.params.subtree||e.filter((e=>v(e.path,[e.name]))).length===e.length)&&e.filter((e=>s(e))).length&&i.respondWith(this.handler(e,i));return i}}class I{constructor(e,t){if(this.target=e,t.originalSubject||(this.originalSubject=e),!("type"in t))throw new Error("Mutation type must be given in definition!");if(!("name"in t))throw new Error("Property name must be given in definition!");L(t,((e,t)=>{"path"===e&&(t=b.resolve(t)),Object.defineProperty(this,e,{value:t,enumerable:!0})})),this.path||Object.defineProperty(this,"path",{value:b.resolve([t.name]),enumerable:!0}),Object.seal(this)}}class H extends w{constructor(e){super(e),this.buffers=[]}add(e){return super.add(new D(this.target,e))}fire(e,t){var s=new F(this.target,t);return e=f(e,!1).map((e=>e instanceof I?e:new I(this.target,e))),this.buffers.length?(function(e,t=1){return arguments.length>1?k(e.slice().reverse(),t).reverse():k(e.slice().reverse())}(this.buffers)(e),s):(this.currentlyFiring.filter((t=>e.filter((e=>t.type===e.type&&t.name===e.name)).length)).length,this.fireables.forEach((i=>{if(s.propagationStopped&&t)return s;s.respondWith(i.fire(e))})),s)}static getFirebase(e,t=!0,s=null){return super._getFirebase("observer",...arguments)}static namespace(e,t=null){return super._namespace("observer",...arguments)}}function C(e,t,s=null,n={}){if(!(e=s||e)||!c(e))throw new Error("Target must be of type object!");e=T(e);var a=f(t),l=a.map((t=>{var r,l=function(r){return arguments.length?r:i(e,"accessorizedProps").has(t)&&i(e,"accessorizedProps").get(t).touch(!0)?i(e,"accessorizedProps").get(t).get():s?Reflect.get(e,t,s):Reflect.get(e,t)};return(r=M.getFirebase(e,!0,n.namespace))?r.fire({type:"get",name:t,related:a,receiver:s},l):l()}));return r(t)?l:l[0]}function q(e,t,s=!1,i=!1,n=!1){var a=0,l=e.shift();if((d(l)||!0===l||!1===l)&&(a=l,l=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach(((e,o)=>{var u,p,f;(c(e)||h(e))&&(s?(u=e,f=[],function(e,t){t=(t=t||Object.prototype)&&!r(t)?[t]:t;var s=[];for(e=e;e&&(!t||t.indexOf(e)<0)&&"default"!==e.name;)s.push(e),e=e?Object.getPrototypeOf(e):null;return s}(u,p).forEach((e=>{!function(e,...t){t.forEach((t=>{e.indexOf(t)<0&&e.push(t)}))}(f,...Object.getOwnPropertyNames(e))})),f):Object.getOwnPropertyNames(e)).forEach((c=>{if(t(c,l,e,o)){var h=l[c],u=e[c];if((r(h)&&r(u)||m(h)&&m(u))&&(!0===a||a>0))l[c]=r(h)&&r(u)?[]:{},q([d(a)?a-1:a,l[c],h,u],t,s,i,n);else if(r(l)&&r(e))i?l[c]=u:l.push(u);else try{n?Object.defineProperty(l,c,Object.getOwnPropertyDescriptor(e,c)):l[c]=e[c]}catch(e){}}}))})),l}function V(...e){return q(e,((e,t,s)=>!0),!1,!1,!1)}function W(e,t,i=null,r={}){if(!(e=T(e))||!c(e))throw new Error('Observable subjects must be of type object; "'+s(e)+'" given!');if(h(t)&&(r=arguments.length>2?i:{},i=t,t=null),!h(i))throw new Error('Handler must be a function; "'+s(i)+'" given!');var n,a=H.getFirebase(e,!0,r.namespace),l={filter:t,handler:i,params:r};if((l.filter||"*"===l.params.subtree||l.params.subtree&&Q(e))&&B(e,l.filter,l.params.subtree,r.namespace),l.params.unique&&(n=a.match({filter:t,params:r})).length){if("replace"!==l.params.unique)return n[0];a.remove(n[0])}return a.add(l)}function z(e,t,s,i=null,r={}){var n;if(e!==s&&(W(s,((s,i)=>{if(n=H.getFirebase(e,!1,r.namespace)){var a=s.map((s=>{var i=s;do{if(i.target===e)return}while(i=i.src);var r={};return L(s,((e,t)=>{"target"!==e&&"name"!==e&&"path"!==e&&"src"!==e&&(r[e]=t)})),r.name=t,r.path=[t].concat(s.path),r.originalSubject=s.originalSubject,r.src=s,new I(e,r)})).filter((e=>e));if(a.length)return n.fire(a,i.cancellable)}}),{subtree:!0,...r,unique:!0,tags:[U,t,e]}),m(i)&&(n=H.getFirebase(e,!1,r.namespace)))){var a=V({name:t,type:"set",value:s,related:[t]},i);let e=n.fire(a,r.cancellable);if(r.eventTypeReturn)return e}}const U={};function B(e,t=null,s=!1,i=null){if(!e||!c(e))throw new Error("Target must be of type object!");var r=H.getFirebase(e,!0,i);if(r&&!r.build){r.build=s;var n=y(t),a=!n.length||n.filter((e=>!e[0]&&0!==e[0])).length?Object.keys(e):n.map((e=>e[0])),l=n.length?n.map((e=>e.slice(1))).filter((e=>e.length)):null;r.subBuild=l&&l.length?l:null,a.forEach((t=>{var n=C(e,t,null,{namespace:i});try{c(n)&&(z(e,t,n,null,params),(r.subBuild&&Q(n)||(_isFunction(s)?s(n):s&&Q(n)))&&B(n,r.subBuild,s,i))}catch(e){}}))}}const Q=e=>(e instanceof Object||e instanceof Array||e instanceof Function)&&("undefined"==typeof window||e!==window);function K(e,t,i=null,r={}){if(!(e=T(e))||!c(e))throw new Error('Observable subjects must be of type object; "'+s(e)+'" given!');if(h(t)&&(r=arguments.length>2?i:{},i=t,t=null),i&&!h(i))throw new Error('Handler must be a function; "'+s(i)+'" given!');var n;if(n=H.getFirebase(e,!1,r.namespace))return n.removeMatches({filter:t,originalHandler:i,params:r})}function J(e,t,s,i=null,r={}){var n;if(K(s,null,null,{...r,tags:[U,t,e]}),m(i)&&(n=H.getFirebase(e,!1,r.namespace))){var a=V({name:t,type:"del",oldValue:s,related:[t]},i);n.fire(a,r.cancellable)}}function G(e,t,s={}){return R("has",e,{name:t},s)}function X(e,t,s,n={}){t=s.receiver||t;var a=s.keysOrPayload,l=s.value;if(!t||!c(t))throw new Error("Target must be of type object!");m(a)&&(n=l||{},l=null),t=T(t);var o=M.getFirebase(t,!1,n.namespace),h=H.getFirebase(t,!1,n.namespace);const d=(r,a,l,u)=>{var d,m="set";e&&(m="defineProperty",a=(d=a||{}).value);var p,f=!1;G(t,r,n)&&(f=!0,p=C(t,r,s.receiver,n));var v={name:r,type:m,value:a,receiver:s.receiver,related:l,detail:u,isUpdate:f,oldValue:p},g=function(e){return arguments.length&&(d?d=e:a=e),d?!(i(t,"accessorizedProps",!1).has(r)&&!i(t,"accessorizedProps").get(r).restore()||(Object.defineProperty(t,r,d),0)):i(t,"accessorizedProps",!1).has(r)?i(t,"accessorizedProps").get(r).set(a):(t[r]=a,!0)};if(o){var y=d?{type:"defineProperty",name:r,descriptor:d,receiver:s.receiver,related:l,detail:u,isUpdate:f,oldValue:p}:{type:"set",name:r,value:a,receiver:s.receiver,related:l,detail:u,isUpdate:f,oldValue:p};v.success=o.fire(y,g)}else v.success=g();return v.success&&v.value!==v.oldValue&&(c(v.oldValue)&&J(t,r,v.oldValue,null,n),c(v.value)&&(z(t,r,v.value,null,n),h&&(h.subBuild||h.build&&Q(v.value))&&B(v.value,h.subBuild,h.build,n.namespace))),v};var v,g=[];r(a)||(p(a)||u(a))&&(v=f(a))?g=v.map((e=>d(e,l,v,n.detail))):m(a)&&(v=Object.keys(a))&&(g=v.map((e=>d(e,a[e],v,n.detail))));var y,b=g.filter((e=>!1!==e.success));return h?(y=h.fire(b,n.cancellable)).successCount=b.length:n.eventTypeReturn&&(y=new F(t)),n.eventTypeReturn?y:b.length>0}function Y(e,t,s=null,i={}){return X(!0,e,{keysOrPayload:t,value:s},i)}function Z(e,t,s={}){if(!e||!c(e))throw new Error("Target must be of type object!");e=T(e);var r,n,a=f(t),l=a.map((t=>{var r;G(e,t,s)&&(r=C(e,t,null,s));var n,l={name:t,type:"deleteProperty",related:a,detail:s.detail,oldValue:r},o=function(s){return arguments.length?s:!(i(e,"accessorizedProps",!1).has(t)&&!i(e,"accessorizedProps").get(t).restore()||(delete e[t],0))};return(n=M.getFirebase(e,!1,s.namespace))?l.success=n.fire({type:"deleteProperty",name:t,oldValue:r,related:a},o):l.success=o(),l.success&&c(l.oldValue)&&J(e,t,l.oldValue,null,s),l})),o=l.filter((e=>!1!==e.success));return(r=H.getFirebase(e,!1,s.namespace))?(n=r.fire(o,s.cancellable)).successCount=o.length:s.eventTypeReturn&&(n=new F(e)),s.eventTypeReturn?n:o.length>0}function ee(e,t,s={}){return R("getOwnPropertyDescriptor",e,{name:t},s)}function te(e,t={}){return R("getPrototypeOf",e,{},t)}function se(e,t={}){return R("isExtensible",e,{},t)}function ie(e,t={}){return R("ownKeys",e,{},t)}function re(e,t={}){return R("preventExtensions",e,{},t)}function ne(e,t,s=null,i=null,r={}){return X(!1,e,arguments.length>3?{keysOrPayload:t,value:s,receiver:i}:{keysOrPayload:t,value:s},r)}function ae(e,t,s={}){return R("setPrototypeOf",e,{prototype:t},s)}function le(e,t=[],s=!0){var i=0;return d(arguments[0])&&c(arguments[1])&&(i=arguments[0],e=arguments[1],t=arguments[2]||[]),q([i,{},e],((e,s,i)=>h(t)?t(e):!r(t)||!t.length||t.indexOf(e)>-1),!1,!1,s)}function ce(e){return e.filter(((e,t,s)=>s.indexOf(e)===t))}const oe={apply:_,construct:S,defineProperty:Y,deleteProperty:Z,get:C,getOwnPropertyDescriptor:ee,getPrototypeOf:te,has:G,isExtensible:se,ownKeys:ie,preventExtensions:re,set:ne,setPrototypeOf:ae,accessorize:function(e,t=[],s={}){s=m(t)?t:s;var n=(1===arguments.length?Object.keys(e):f(t)).map((t=>{if(i(e,"accessorizedProps").has(t)&&i(e,"accessorizedProps").get(t).touch(!0))return!1;const r=()=>{for(var s,i=e;!s&&(i=Object.getPrototypeOf(i));)s=Object.getOwnPropertyDescriptor(i,t);return s};var n,a,l=Object.getOwnPropertyDescriptor(e,t);l||(n={writable:!0,enumerable:!(t in e),configurable:!1!==s.configurable});var c={...l||n};"value"in c&&delete c.value,"writable"in c&&delete c.writable,c.get=()=>{if(o.ongoingGets.length)return o.get();o.ongoingGets.push(1);var i=C(e,t,null,s);return o.ongoingGets.pop(),i},c.set=i=>{if(o.ongoingSets.length)return o.set(i);o.ongoingSets.push(1);var r=ne(e,t,i,null,s);return o.ongoingSets.pop(),r};var o={ongoingGets:[],ongoingSets:[],get:function(){var t=l;return t||(t=a?n:r()||n),t.get?t.get.call(e):t.value},set:function(t){var s=l;return s||(a?s=n:(s=r())?"value"in s&&(s=n,a=!0):(s=n,a=!0)),s.set||s.get?!!s.set&&s.set.call(e,t):(s.value=t,!0)},restore:function(){try{return this.intact()&&(l||a?Object.defineProperty(e,t,l||n):delete e[t],i(e,"accessorizedProps").delete(t)),!0}catch(e){}return!1},intact:function(){return(Object.getOwnPropertyDescriptor(e,t)||{}).get===c.get},touch:function(e=!1){return this.intact()||!!e&&!this.restore()}};try{return Object.defineProperty(e,t,c),i(e,"accessorizedProps").set(t,o),!0}catch(e){}return!1}));return r(t)?n:n[0]},unaccessorize:function(e,t=[],s={}){s=m(t)?t:s;var n=(1===arguments.length?Object.keys(e):f(t)).map((t=>!i(e,"accessorizedProps",!1).has(t)||i(e,"accessorizedProps").get(t).restore()));return r(t)?n:n[0]},proxy:function(e,t={}){if(!c(e))throw new Error('Object must be of type target; "'+s(e)+'" given!');var r=new Proxy(e,{apply:(e,s,i)=>_(e,s,i,t),construct:(e,s,i=null)=>S(e,s,i,t),defineProperty:(e,s,i)=>Y(e,s,i,t),deleteProperty:(e,s)=>Z(e,s,t),get:(e,s,i=null)=>{var a=C(e,s,i,t);return!1!==t.proxyAutoBinding&&h(a)&&!function(e){return n(e)&&/^class\s?/.test(Function.prototype.toString.call(e))}(a)?a.bind(r):a},getOwnPropertyDescriptor:(e,s)=>ee(e,s,t),getPrototypeOf:e=>te(e,t),has:(e,s)=>G(e,s,t),isExtensible:e=>se(e,t),ownKeys:e=>ie(e,t),preventExtensions:e=>re(e,t),set:(e,s,i,r=null)=>ne(e,s,i,r,t),setPrototypeOf:(e,s)=>ae(e,s,t)});return i(r).set(r,e),r},unproxy:T,observe:W,unobserve:K,intercept:function(e,t,i={}){if(!c(e=T(e)))throw new Error('Object must be of type target; "'+s(handler)+'" given!');var r={},n=!0;m(t)||(h(t)?t={"":t}:h(i)&&(t={[t]:i},i=arguments.length>3?arguments[3]:{}),n=!1);var a=M.getFirebase(e,!0,i.namespace);return Object.keys(t).forEach((e=>{if(!h(t[e]))throw new Error("Callback"+(null===e?"":" for "+e)+' must be a function; "'+s(t[e])+'" given!');var l,c={filter:e,handler:t[e],params:i};if(c.params.unique&&(l=a.match(c)).length){if("replace"!==c.params.unique)return l[0];a.remove(l[0])}n?r[e]=a.add(c):r=a.add(c)})),r},unintercept:function(e,t=null,i={}){if(!(e=T(e))||!c(e))throw new Error('Object must be of type target; "'+s(e)+'" given!');var r=M.getFirebase(e,!1,i.namespace);_isObject(t)||(h(t)?t={[null]:t}:h(i)&&(t={[t]:i},i=arguments.length>3?arguments[3]:{}),isOriginallyObj=!1),(r=M.getFirebase(e,!1,i.namespace))&&Object.keys(t).forEach((e=>{if(!h(t[e]))throw new Error("Callback"+(null===e?"":" for "+e)+' must be a function; "'+s(t[e])+'" given!');var n={filter:e,originalHandler:t[e],params:i};return r.removeMatches(n)}))},closure:function(e,...t){var s=t.map((e=>{if(!c(e=T(e)))throw new Error("Target must be of type object!");return{target:e,subjectCopy:r(e)?e.slice(0):le(e)}})),i=e(...t);const n=()=>{s.map((e=>{var t,s=Object.keys(e.subjectCopy),i=Object.keys(e.target),r=[],n=ce(s.concat(i)).map((t=>{if(e.subjectCopy[t]!==e.target[t]){r.push(t);var n={name:t,related:r,buffered:!0};return i.includes(t)?(n.type="set",n.value=e.target[t],s.includes(t)&&(n.isUpdate=!0)):n.type="del",s.includes(t)&&(n.oldValue=e.subjectCopy[t]),c(e.subjectCopy[t])&&J(e.target,t,e.subjectCopy[t]),c(e.target[t])&&z(e.target,t,e.target[t]),n}})).filter((e=>e));if(n.length&&(t=H.getFirebase(e.target,!1)))return t.fire(n)}))};return i instanceof Promise?i.then(n):n(),i},build:B,link:z,unlink:J,Observers:H,Interceptors:M};function he(e,t){return"string"!=typeof e?e:e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+(void 0!==typeof t&&t?e.substr(1).toLowerCase():e.substr(1))}))}const ue=e=>e&&(e.startsWith("text/")||"application/rtf"===e||"application/xml"===e||"application/xhtml+xml"===e||"application/json"===e);function de(e,t,s=null){return r(t)?e.filter((e=>s?t.filter((t=>s(e,t))).length:-1===t.indexOf(e))):[]}const me=e=>class extends(e||class{}){constructor(e){super(e),Object.keys(e).forEach((t=>{Object.defineProperty(this,t,{value:e[t]})}))}validate(e){return super.validate?super.validate(e):{valid:!0}}},pe=e=>class extends(me(e)){validate(e){var t=super.validate(e);return t.valid?(t=this._validateMin(e)).valid?(t=this._validateMax(e)).valid?t:{valid:!1,error:t.error||`Maximum number of entries exceeded by: ${t.violation}.`}:{valid:!1,error:t.error||`Minimum number of entries short of: ${t.violation}.`}:t}},fe=e=>class extends(pe(e)){getPropertyNameSchema(e=null){var t=this.propertyNames||{type:"string"};return!1===this.additionalProperties&&(t.error="Additional properties not allowed."),t.isRequired=!0,t}getPropertySchema(e,t=null){var s;if(this.properties&&(s=this.properties[e])||(s=this._patternPropertiesMatch(e))||(s=this.additionalProperties)||!1===s||(s={}),s){if((this.required||[]).includes(e)&&(s.isRequired=!0),t){const n=Object.keys(t);var i,r;!s.isRequired&&(i=g(this.dependentRequired||[],n).reduce(((t,s)=>t||this.dependentRequired[s].includes(e)?s:null),null))&&(s.isRequired=i),(n.includes(e)||(r=this._validateMax(t)).valid)&&0!==r.violation||(s.error="This additional entry will violate the maximum number of entries allowed.")}return{...s,name:e}}}_patternPropertiesMatch(e){return Object.keys(this.patternProperties||{}).reduce(((t,s)=>t||(new RegExp(s).test(e)?this.patternProperties[s]:void 0)),null)}validate(e){var t=super.validate(e);return t.valid?(t=this._validateRequired(e)).valid?(t=this._validateDependentRequired(e)).valid?t:{valid:!1,error:t.error||`Entries associated with "${t.master}" still empty: ${t.violation.join(", ")}.`}:{valid:!1,error:t.error||`Required entries still empty: ${t.violation.join(", ")}.`}:t}_validateMax(e){if(!this.maxProperties)return{valid:!0};const t=Object.keys(e).length-this.maxProperties;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minProperties)return{valid:!0};const t=Object.keys(e),s=this.minProperties-t.length;return{valid:s<=0,violation:s}}_validateRequired(e){if(!this.required)return{valid:!0};const t=Object.keys(e),s=de(this.required,t);return{valid:0===s.length,violation:s}}_validateDependentRequired(e){if(!this.dependentRequired)return{valid:!0};const t=Object.keys(e),[s,i]=Object.keys(this.dependentRequired).reduce(((e,s)=>{if(e)return e;if(t.includes(s)){const e=de(this.dependentRequired[s],t);if(e.length)return[s,e]}}),null)||[];return{valid:!s,master:s,violation:i}}},ve=e=>class extends(pe(e)){getItemSchema(e,t=null){var s,i;if(this.prefixItems&&(s=this.prefixItems[e])||(s=this.items)||!1===s||(s={}),s)return t&&((e in t||(i=this._validateMax(t)).valid)&&0!==i.violation||(s.error="This additional entry will violate the maximum number of entries allowed.")),{...s,name:e}}validate(e){var t=super.validate(e);return t.valid?(t=this._validateUnique(e)).valid?(t=this._validateContains(e)).valid?t:{valid:!1,error:t.error||`Entries must contain ${t.min>0?`at least ${t.min} `+(t.max>1?"and ":""):""} ${t.max>1?`at most ${t.max} `:""}of ${t.desc}.`}:{valid:!1,error:t.error||"Entries must be unique"}:t}_validateMax(e){if(!this.maxItems)return{valid:!0};const t=e.length-this.maxItems;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minItems)return{valid:!0};const t=this.minItems-e.length;return{valid:t<=0,violation:t}}_validateUnique(e){return this.uniqueItems?{valid:ce(e).length===e.length}:{valid:!0}}_validateContains(e){if(!this.contains)return{valid:!0};const t=e.filter((e=>this.__validateContains(this.contains,e)));return t.length<(this.minContains||1)||this.maxContains&&t.length>this.maxContains?{valid:!1,min:this.minContains||1,max:this.maxContains,desc}:{valid:!0}}},ge=e=>class extends(me(e)){validate(e){var t=super.validate(e);return t.valid?{valid:p(e)}:t}},ye=e=>class extends(me(e)){validate(e){var t=super.validate(e);return t.valid,t}},be=e=>class extends(ye(e)){validate(e){var t=super.validate(e);return t.valid?{valid:d(e)}:t}},xe=e=>class extends(ye(e)){validate(e){var t=super.validate(e);return t.valid?{valid:Number.isInteger(e)}:t}},Ee=e=>class extends(me(e)){validate(e){var t,s=super.validate(e);return s.valid?{valid:(t=e,!0===t||!1===t)}:s}},we=e=>class extends(me(e)){validate(e){var t=super.validate(e);return t.valid?{valid:a(e)}:t}},je=e=>class extends(e||class{}){constructor(){super(),this.nodeRemovalListeners=new Map}execNodeRemoval(e){h(e.remove)&&e.remove()}onNodeRemoval(e,t){var s=this.nodeRemovalListeners.get(e);s||(s=[],this.nodeRemovalListeners.set(e,s)),s.push(t)}async remoteAction(e,t,s={}){return{}}static getSchemaName(e){return e=f(e||"string"),[["object","_Object"],["array","_Array"],["string","_String"],["number","_Number"],["integer","_Integer"],["boolean","_Boolean"],["null","_Null"]].reduce(((t,s)=>t||(e.includes(s[0])?s[1]:null)),null)}define(e,t=null){oe.set(this,"schema",oe.proxy(e)),oe.set(this,"ownerWidget",t),oe.set(this,"attrs",oe.proxy({name:this.ownerWidget&&this.ownerWidget.attrs.name?`${this.ownerWidget.attrs.name}[${this.schema.name}]`:this.schema.name})),this.state||oe.set(this,"state",oe.proxy({})),this.schema.title||(this.schema.title=he(((this.schema.name||"")+"").replaceAll("_"," "))),this.schema.isRequired&&(this.attrs.required=!0),l(this.schema.const)&&l(this.schema.default)||(this.attrs.value=l(this.schema.const)?this.schema.default:this.schema.const),!this.schema.readOnly&&l(this.schema.const)||(this.attrs.readonly=!0)}alert(e=null){return arguments.length&&(this.state.alert={message:e.message,type:e.type}),{...this.state.alert||{}}}json(){}set value(e){this.json(e)}get value(){return this.json()}},Oe=e=>class extends(je(e)){deriveChildEntry(e,t){}},Le=e=>class extends(Oe(e)){constructor(){super(),oe.set(this,"childEntries",oe.proxy({})),oe.observe(this.childEntries,(e=>{e.forEach((e=>{"set"===e.type&&(e.isUpdate&&e.oldValue&&this.execNodeRemoval(e.oldValue),e.value?h(this.onNodeRemoval)&&this.onNodeRemoval(e.value,(()=>{this.childEntries[e.name]===e.value&&delete this.childEntries[e.name]})):console.warn(`No widget type defined for entry "${e.name}" of schema type "${f(this.schema.properties[e.name].type||"string").join(", ")}".`)),"deleteProperty"===e.type&&this.execNodeRemoval(e.oldValue)}))}))}static testSchema(e){return f(e.type).includes("object")}define(e,t=null){super.define(new(fe())(e),t),Object.keys(this.childEntries).forEach((e=>{delete this.childEntries[e]})),Object.keys(this.schema.properties||{}).forEach((e=>{const t=this.schema.getPropertySchema(e);!1!==t.display&&(this.childEntries[e]=this.deriveChildEntry(t,e))}))}extend(e,t=null){if(h(e)){const s=()=>{const i=this.schema.getPropertyNameSchema(this.json());e(i,(e=>{i.validate(e)?extend(e,t):s()}))};s()}else if(e){const s=this.json();this.childEntries[e]=this.deriveChildEntry(this.schema.getPropertySchema(e,s),e),t&&t(this.childEntries[e])}}json(e={},t=!1){if(arguments.length){if(!m(e))throw new Error("Data must be a valid JSON object.");return void Object.keys(e).forEach((s=>{this.childEntries[s]?this.childEntries[s].json(e[s]):t&&this.extend(s,(t=>{t.json(e[s])}))}))}const s={};return Object.keys(this.childEntries).forEach((e=>{s[e]=this.childEntries[e].json()})),s}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!m(e.details))throw new Error("Alert details must be a valid JSON object.");return void Object.keys(e.details||{}).forEach((s=>{this.childEntries[s]?this.childEntries[s].alert(e.details[s]):t&&this.extend(s,(t=>{t.alert(e.details[s])}))}))}const s=super.alert();return s.details={},Object.keys(this.childEntries).forEach((e=>{s.details[e]=this.childEntries[e].alert()})),s}},Pe=e=>class extends(Oe(e)){constructor(){super(),oe.set(this,"childEntries",oe.proxy([])),oe.observe(this.childEntries,(e=>{e.forEach((e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.childEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),e.value?h(this.onNodeRemoval)&&this.onNodeRemoval(e.value,(()=>{const t=this.childEntries.indexOf(e.value);t>-1&&this.childEntries.splice(t,1)})):console.warn(`No widget type defined for entry "${e.name}" of schema type "${f(e.value.type||"string").join(", ")}".`)),"deleteProperty"===e.type&&-1===this.childEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))}))}))}static testSchema(e){return f(e.type).includes("array")}define(e,t=null){super.define(new(ve())(e),t),this.childEntries.splice(0),o(this.schema.prefixItems)||this.schema.prefixItems.forEach(((e,t)=>{this.childEntries.push(this.deriveChildEntry(e,t))})),!0===this.schema.autoExtend&&this.extend()}extend(e=null){const t=this.json(),s=t.length,i=this.deriveChildEntry(this.schema.getItemSchema(s,t),s);this.childEntries.push(i),e&&e(i)}execNodeRemoval(e,t=null){if(t||(t=(e,t)=>t()),-1===this.childEntries.indexOf(e))return;const s=e.schema?d(e.schema.title)?`item ${parseInt(e.schema.title)+1}`:e.schema.title:"item";if(this.schema.remoteDelete){var i=e.value;if(i&&!c(i)){var r=this.schema.remoteDelete.url.replace(/\{value\}/g,i);return void t(`Remove ${s} (and delete from your account)?`,(()=>this.remoteAction(this.schema.remoteDelete.method||"delete",r).then((t=>(t.ok&&super.execNodeRemoval(e),t)))))}}t(`Remove ${s}?`,(async()=>{super.execNodeRemoval(e)}))}json(e=[]){if(!arguments.length)return this.childEntries.filter((e=>e)).map((e=>e.json()));if(!r(e))throw new Error("Data must be a valid JSON array.");e.forEach(((e,t)=>{this.childEntries[t]?this.childEntries[t].json(e):this.extend((t=>{t.json(e)}))}))}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!r(e.details)&&!Object.keys(e.details).every((e=>d(e))))throw new Error("Alert items must be a valid JSON array.");return void Object.keys(e.details).forEach((t=>{const s=e.details[t];this.childEntries[t]?this.childEntries[t].alert(s):this.extend((e=>{e.alert(s)}))}))}const s=super.alert();return s.details=this.childEntries.filter((e=>e)).map((e=>e.alert())),s}},Me=e=>class extends(Pe(e)){static testSchema(e){if(super.testSchema(e)&&!e.enum){var t=[],s=this.lineContentLengthLimit||50;if(e.prefixItems){if(e.prefixItems.some((e=>!("const"in e)&&1!==(e.enum||[]).length||g(f(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s)))return;t=e.prefixItems.map((e=>"const"in e?e.const:e.enum[0]))}if(e.items){if(g(f(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum||[])}return!t.some((e=>c(e)||(e+"").length>s))}}define(e,t=null){super.define(...arguments),!1!==this.schema.autoExtend&&this.extend()}},Te=e=>class extends(je(e)){constructor(){super(),oe.set(this,"enumEntries",oe.proxy([])),oe.observe(this.enumEntries,(e=>{e.forEach((e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.enumEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),h(this.onNodeRemoval)&&this.onNodeRemoval(e.value,(()=>{const t=this.enumEntries.indexOf(e.value);t>-1&&this.enumEntries.splice(t,1)}))),"deleteProperty"===e.type&&-1===this.enumEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))}))}))}static testSchema(e){return r(e.enum)||f(e.type).includes("array")&&(o(e.prefixItems)||e.prefixItems.every((e=>"const"in e||1===(e.enum||[]).length)))&&(!1===e.items||r((e.items||{}).enum)&&e.uniqueItems)}define(e,s=null){const i=this.constructor.getSchemaName(e.type);this.enumEntries.splice(0),super.define(new(t[i]())(e),s);const n=(e,t)=>{const s=e.map(((e,s)=>({value:e,label:(t||{})[s]})));this.enumerate(s,1)},a=e=>{this.enumFetching=this.remoteAction(e.method||"get",e.url,{headers:{accept:"application/json"}}).then((e=>e.ok?e.json():Promise.reject({message:e.statusText}))).then((t=>{var s=r(t.data)?t.data.map((e=>m(e)?{value:"value"in e?e.value:e.id,label:"label"in e?e.label:e.title}:{value:e})):[];this.enumerate(s,e.url)}))};if(this.schema.remoteFetch)a(this.schema.remoteFetch),oe.observe(this.schema,"remoteFetch",(()=>{a(this.schema.remoteFetch)}),{subtree:!0});else if(this.schema.enum)n(this.schema.enum,this.schema.enumNames),oe.observe(this.schema,[["enum"],["enumNames"]],(()=>{n(this.schema.enum,this.schema.enumNames)}));else if(f(this.schema.type||"string").includes("array")){const e=[];this.schema.prefixItems&&(e=this.schema.prefixItems.map((e=>"const"in e?{value:e.const,label:e.title}:{value:e.enum[0],label:e.title||(e.enumNames||[])[0]}))),this.schema.items&&this.schema.items.enum.forEach(((t,s)=>{e.push({value:t,label:(this.schema.items.enumNames||[])[s]})})),this.attrs.multiple=!0,this.attrs.name+="[]",e.forEach((e=>{e.selected=!0})),this.enumerate(e,2)}}deriveEnumEntry(e,t){}enumerate(e,t=null){f(this.schema.type).includes("null")&&(e=[{value:null,label:this.attrs.placeholder}].concat(e)),t&&(!0===t?this.enumEntries.splice(0):this.enumEntries.filter((e=>g(f(e.enumTag),f(t)).length)).forEach((e=>{const t=this.enumEntries.indexOf(e);t>-1&&this.enumEntries.splice(t,1)}))),this.enumEntries.push(...e.map(((e,s)=>(e=this.deriveEnumEntry(e,s),t&&(e.enumTag=t),e))))}json(e=[]){if(arguments.length){if(!r(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}const t=()=>{this.enumEntries.forEach((t=>{t.selected=!1,e.forEach((e=>{t.value===e+""&&(t.selected=!0)}))}))};return void(this.enumFetching?this.enumFetching.then(t):t())}const t=this.enumEntries.filter((e=>e.selected)).map((e=>e.value));return this.attrs.multiple?t:t[0]}},Re=e=>class extends(Te(e)){static testSchema(e){if(super.testSchema(e)){var t=[],s=this.lineContentLengthLimit||50;if(e.enum){if(g(f(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s)return;t=e.enum}else if(!e.remoteFetch){if(e.prefixItems){if(e.prefixItems.some((e=>g(f(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s)))return;t=e.prefixItems.map((e=>"const"in e?e.const:e.enum[0]))}if(e.items){if(g(f(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum)}}return!t.some((e=>c(e)||(e+"").length>s))}}},_e=e=>class extends(je(e)){constructor(){super(),oe.set(this,"filesList",oe.proxy([])),oe.set(this,"fallbackFilesList",oe.proxy([])),oe.observe(this.filesList,(e=>{e.forEach((e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.filesList.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),h(this.onNodeRemoval)&&this.onNodeRemoval(e.value,(()=>{const t=this.filesList.indexOf(e.value);t>-1&&this.filesList.splice(t,1)}))),"deleteProperty"===e.type&&-1===this.filesList.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))}))}))}static testSchema(e){const t=e=>{return f(e.type||"string").includes("string")&&("data-url"===(t=e).format||"base64"===t.contentEncoding||e.contentMediaType&&!ue(e.contentMediaType));var t};return t(e)||f(e.type).includes("array")&&e.uniqueItems&&o(e.prefixItems)&&t(e.items||{})}define(e,t=null){const s=f(e.type),i=s.includes("array")?ve():ge();super.define(new i(e),t),this.filesList.splice(0),this.attrs.type="file",s.includes("array")&&(this.attrs.name+="[]",this.attrs.multiple=!0),(this.schema.contentMediaType||this.schema.items&&this.schema.items.contentMediaType)&&(this.attrs.accept=this.schema.contentMediaType||this.schema.items.contentMediaType)}deriveFileEntry(e,t){}populate(e,t=null){if(t&&(!0===t?this.filesList.splice(0):this.filesList.filter((e=>g(f(e.enumTag),f(t)).length)).forEach((e=>{const t=this.filesList.indexOf(e);t>-1&&(t>-1&&2===g(f(e.enumTag),[1,2]).length&&this.fallbackFilesList.push(this.filesList[t]),this.filesList.splice(t,1))}))),(!e||!e.length)&&(!this.filesList.length||!this.filesList[0])&&this.fallbackFilesList.length){const e=this.fallbackFilesList[0].enumTag;this.populate(this.fallbackFilesList.splice(0).map((e=>({file:e.file}))),e)}this.filesList.push(...e.map(((e,s)=>{var i=this.deriveFileEntry(e,s,t);return null!==t&&(i.enumTag=t),i})))}execNodeRemoval(e,t=null){if(t||(t=(e,t)=>t()),this.schema.remoteDelete&&-1===this.fallbackFilesList.indexOf(e)){var s=e.file;if(s&&!c(s)){var i=this.schema.remoteDelete.url.replace(/\{value\}/g,s);return void t("Remove file (and delete from your account)?",(()=>this.remoteAction(this.schema.remoteDelete.method||"delete",i).then((t=>(t.ok&&super.execNodeRemoval(e),t)))))}}t("Remove file?",(async()=>{super.execNodeRemoval(e)}))}json(e=[]){if(arguments.length){if(!r(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}return void this.populate(e.filter((e=>e)).map((e=>({file:e}))),[1,2])}const t=this.filesList.filter((e=>m(e.file))).map((e=>e.file));return this.attrs.multiple?t:t[0]}},Se=e=>class extends(je(e)){define(e,t=null){super.define(...arguments),l(this.schema.default)&&!this.schema.examples||(this.attrs.placeholder=`E.g.: ${l(this.schema.default)?this.schema.examples[0]:this.schema.default}`),("const"in this.schema||1===(this.schema.enum||[]).length)&&(this.attrs.value="const"in this.schema?this.schema.const:this.schema.enum[0])}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},ke=e=>class extends(Se(e)){static testSchema(e){return f(e.type||"string").includes("string")&&(e.contentMediaType&&ue(e.contentMediaType)||Math.max(e.maxLength||0,e.minLength||0)>=1024)}define(e,t=null){super.define(new(ge())(e),t)}},Ne=e=>class extends(Se(e)){static testSchema(e){return f(e.type||"string").includes("string")}define(e,t=null){if(super.define(new(ge())(e),t),this.attrs.type="text","date"===this.schema.format?this.attrs.type="date":"time"===this.schema.format?this.attrs.type="time":"date-time"===this.schema.format?this.attrs.type="datetime-local":"duration"===this.schema.format?this.attrs.type="":["uri","uri-reference","iri","iri-reference","uuid"].includes(this.schema.format)||["hostname","idn-hostname"].includes(this.schema.format)?this.attrs.pattern="":["email","idn-email"].includes(this.schema.format)?this.attrs.type="email":["ipv4","ipv6"].includes(this.schema.format)?this.attrs.pattern="":"password"===this.schema.format?this.attrs.type="password":"color"===this.schema.format?this.attrs.type="color":"phone"===this.schema.format?this.attrs.pattern="^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,6}$":"postal-code"===this.schema.format&&(this.attrs.pattern="^[0-9]{5}(?:-[0-9]{4})?$"),this.schema.maxLength&&(this.attrs.maxlength=this.schema.maxLength),this.schema.minLength&&(this.attrs.minlength=this.schema.minLength),this.schema.pattern&&(this.attrs.pattern=this.schema.pattern),!this.schema.col){const e=this.schema.maxLength||150;this.schema.col=Math.max(1,parseInt(e/25))}}},Ae=e=>class extends(Se(e)){static testSchema(e){const t=f(e.type);return t.includes("integer")||t.includes("number")}define(e,t=null){if(super.define(new(be())(e),t),this.attrs.type="number",this.schema.exclusiveMaximum?this.attrs.max=this.schema.exclusiveMaximum-1e-4:this.schema.maximum&&(this.attrs.max=this.schema.maximum),this.schema.exclusiveMinimum?this.attrs.min=this.schema.exclusiveMinimum+1e-4:this.schema.minimum&&(this.attrs.min=this.schema.minimum),this.schema.multipleOf&&(this.attrs.step=this.schema.multipleOf),!this.schema.col){const e=this.schema.maxLength||50;this.schema.col=Math.max(1,parseInt(e/25))}}},Fe=e=>class extends(je(e)){static testSchema(e){return f(e.type).includes("boolean")}define(e,t=null){super.define(new(Ee())(e),t),this.attrs.type="checkbox",!0!==this.schema.const&&!0!==this.schema.default||(this.attrs.checked=!0)}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},De=e=>class extends(e||class{}){define(e,t=null){super.define(...arguments);const s=()=>{(this.attrs.index||0===this.attrs.index)&&this.childEntries&&this.schema.indexProperty&&this.childEntries[this.schema.indexProperty]&&this.childEntries[this.schema.indexProperty].json(this.attrs.index)};s(),oe.observe(this.attrs,"index",s)}},Ie=e=>class extends(e||HTMLElement){constructor(){super(),new MutationObserver((e=>{e.forEach((e=>{e.removedNodes.forEach((e=>{this.nodeRemovalListeners&&this.nodeRemovalListeners.has(e)&&this.nodeRemovalListeners.get(e).forEach((e=>e()))}))}))})).observe(this,{subtree:!0,childList:!0})}async remoteAction(e,t,s={}){return this.state.remoteAction=e,this.state.remoteActionError="",fetch(t,{headers:{accept:"application/json"},...s,method:e}).then((e=>(this.state.remoteAction=!1,e))).catch((e=>{this.state.remoteAction=!1,this.alert(e)}))}static get subscriptMethods(){return["renderBasic","render"]}connectedCallback(){this.renderBasic(),this.render()}renderBasic(){console.log("-------------------this.schema?.title",this,this.schema?.title),this.schema?.title&&this.namespace.title&&$(this.namespace.title).html(this.schema.title),this.schema?.description&&this.namespace.description&&$(this.namespace.description).html(this.schema.description),this.schema?.isRequired&&$(this).attr("data-required",!0),this.schema?.col&&12!==this.schema.col?$(this).class({["col-"+this.schema.col]:!0,"col-12":!1}):$(this).class("col-12",!0),"hidden"===this.schema?.display&&$(this).class("overflow-hidden wt-0 ht-0 pd-0 mg-0",!0),$(this).attr("data-remote-action",this.state.remoteAction||!1),$(this).attr("data-remote-action-error",this.state.remoteActionError||!1);var e=this.state.alert?this.state.alert.message:"",t=this.state.alert?this.state.alert.type:"";this.namespace.alert&&($(this.namespace.alert).html(e||""),$(this.namespace.alert).attr("data-type",t||!1),e&&this.namespace.alert.focus())}render(){}alert(){const e=super.alert(...arguments);return this.renderBasic(),e}},He=e=>class extends(Ie(e)){connectedCallback(){super.connectedCallback(),this.namespace.adder&&(this.adderAction=this.adderAction||(()=>this.extend()),this.namespace.adder.removeEventListener("click",this.adderAction),this.namespace.adder.addEventListener("click",this.adderAction))}deriveChildEntry(e,t){if(this.template){var s=Reflect.ownKeys(this.template.exports).map((e=>this.template.exports[e][0])).reduce(((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testSchema(e)?s:null}),null);if(s){s=s.cloneNode(!0),this.namespace.content?this.namespace.content.append(s):this.append(s);try{s.define(e,this),(s.attrs||{}).index=t}catch(e){console.warn("Error calling element.define();",e,this)}}return s}}},$e=e=>class extends(He(Le(e||HTMLElement))){get value(){if(this.schema.primaryKey&&this.childEntries[this.schema.primaryKey])return this.childEntries[this.schema.primaryKey].json()}},Ce=e=>class extends(He(e)){},qe=e=>class extends(Ce(Pe(e||HTMLElement))){},Ve=e=>class extends(Ce(Me(e||HTMLElement))){constructor(){super(),this.addEventListener("keypress",(e=>{"Enter"===e.key&&(this.extend((e=>e.namespace.input?e.namespace.input.focus():null)),e.preventDefault())}))}extend(e=null){if(!this.childEntries.length||this.childEntries[this.childEntries.length-1].namespace.input.value)return super.extend(e)}render(){this.namespace.input&&this.attrs?.name&&$(this.namespace.input).attr(this.attrs)}},We=e=>class extends(Ie(e)){deriveEnumEntry(e,t){var s;if(!this.template&&this.namespace.input instanceof HTMLSelectElement)s=document.createElement("option");else{var i=Reflect.ownKeys(this.template.exports).map((e=>this.template.exports[e][0])).reduce(((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testSchema(this.schema,e)?s:null}),null);i&&(s=i.cloneNode(!0))}return s&&(this.namespace.input instanceof HTMLSelectElement?(this.namespace.input.options.add(s),s.setAttribute("label",e.label||he(e.value)),s.value=e.value,s.selected=e.selected):(this.namespace.input.append(s),s.setAttribute("data-index",itemIndex))),s}render(){this.namespace.input&&this.attrs?.name&&$(this.namespace.input).attr(this.attrs)}},ze=e=>class extends(We(Te(e||HTMLElement))){},Ue=e=>class extends(We(Re(e||HTMLElement))){},Be=e=>class extends(Ie(_e(e||HTMLElement))){constructor(){super(),this.addEventListener("change",(e=>{this.namespace.dropArea&&this.populate(Array.from(e.target.files).map((e=>({file:e}))),1)})),this._handlerDrag=e=>{"dragover"===e.type||"dragenter"===e.type?this.state&&(this.state.dragging=!0):"dragleave"!==e.type&&"dragend"!==e.type&&"drop"!==e.type||(e.preventDefault(),this.state&&(this.state.dragging=!1),"drop"===e.type&&this.populate(Array.from(e.dataTransfer.files).map((e=>({file:e})))))},oe.observe(this.filesList,(e=>{if("length"===e[0].name||!this.namespace.input)return;const t=new DataTransfer;this.filesList.map((e=>e.file)).filter((e=>!p(e))).forEach((e=>{t.items.add(e)})),this.namespace.input.files=t.files,this.schema.isRequired&&(!this.namespace.input.files.length&&this.filesList.length&&this.filesList[0]?this.namespace.input.removeAttribute("required"):this.namespace.input.setAttribute("required",!0))}))}connectedCallback(){super.connectedCallback(),this.namespace.dropArea&&["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach((e=>{this.namespace.dropArea.removeEventListener(e,this._handlerDrag),this.namespace.dropArea.addEventListener(e,this._handlerDrag)}))}define(e,t=null){super.define(...arguments),this.render()}deriveFileEntry(e,t,s=null){if(this.template){var i=Reflect.ownKeys(this.template.exports).map((e=>this.template.exports[e][0])).reduce(((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testFile(e)?s:null}),null);if(i){if((i=i.cloneNode(!0)).file=e._file||e.file,p(e.file)){const t=document.createElement("input");t.setAttribute("name",this.attrs.name),t.setAttribute("value",e.file),t.setAttribute("type","hidden"),i.append(t),i.setAttribute("data-src",e.file),2!==g(f(s),[1,2]).length||this.schema.remoteDelete||i.setAttribute("data-isdefault","true")}this.namespace.preview?this.namespace.preview.append(i):this.append(i);try{i.previewFile(e.file,this)}catch(e){console.warn("Error calling element.previewFile();",e,this)}}return i}}render(){this.namespace.input&&(this.attrs?.type||this.attrs?.name)&&$(this.namespace.input).attr(this.attrs)}},Qe=e=>class extends(e||HTMLElement){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,((e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then((e=>{$(this).attr("data-deleting",!1),this.ownerWidget.populate([],[1,2])})))}))}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}static testFile(e){return!0}async previewFile(e,t){if(this.ownerWidget=t,p(e)){const t=await fetch(e),s=t.ok?await t.blob():"";e=new File([s],e.split("/").pop(),{type:t.headers.get("content-type")||"application/octet-stream"})}e.name,e.size;var s=e=>window.URL.revokeObjectURL(e.src);if(/^image\//.test(e.type)){var i=document.createElement("img");return i.onload=e=>{s(i)},i.src=window.URL.createObjectURL(e),void this.append(i)}if(/^video\//.test(e.type)){var r=document.createElement("video");return r.onloadstart=e=>{s(r),r.play()},r.src=window.URL.createObjectURL(e),r.muted=!0,void this.append(r)}const n=document.createElement("i");n.classList.add("bi");var a="file";/^audio\//.test(e.type)?a="music":/msword|ms-word|wordprocessing/.test(e.type)?a="word":/powerpoint|presentation/.test(e.type)?a="powerpoint":/excel|spreadsheet/.test(e.type)?a="excel":/^text\//.test(e.type)?a="text":/\/pdf/.test(e.type)?a="pdf":/\/zip/.test(e.type)&&(a="zip"),n.classList.add("bi-file-"+a),this.append(n)}},Ke=e=>class extends(Ie(e)){json(e=null){if(!arguments.length)return this.namespace.input.value;this.namespace.input.value=e}render(){this.namespace.input&&(this.attrs?.type||this.attrs?.name)&&$(this.namespace.input).attr(this.attrs)}},Je=e=>class extends(Ke(ke(e||HTMLElement))){},Ge=e=>class extends(Ke(Ne(e||HTMLElement))){},Xe=e=>class extends(Ke(Ae(e||HTMLElement))){},Ye=e=>class extends(Ke(Fe(e||HTMLElement))){json(e=null){if(!arguments.length)return this.namespace.input.checked?this.namespace.input.value:null;this.namespace.input.checked=!0===e||e+""===this.namespace.input.value}},Ze=e=>class extends(De(e||HTMLElement)){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,((e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then((e=>{$(this).attr("data-deleting",!1)})))}))}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}},{SubscriptElement:et}=WebQit.OOHTML,tt=class extends($e(et(HTMLFormElement))){};customElements.define("playui-form-widget",tt,{extends:"form"});const st=class extends($e(et(HTMLFieldSetElement))){},it=class extends(qe(et(HTMLFieldSetElement))){},rt=class extends(Ve(et(HTMLFieldSetElement))){},nt=class extends(ze(et(HTMLDivElement))){},at=class extends(Ue(et(HTMLDivElement))){},lt=class extends(Be(et(HTMLDivElement))){},ct=class extends(Je(et(HTMLDivElement))){},ot=class extends(Ge(et(HTMLDivElement))){},ht=class extends(Xe(et(HTMLDivElement))){},ut=class extends(Ye(et(HTMLDivElement))){};customElements.define("playui-collection-widget",st,{extends:"fieldset"}),customElements.define("playui-multiple-widget",it,{extends:"fieldset"}),customElements.define("playui-multiple2-widget",rt,{extends:"fieldset"}),customElements.define("playui-enum-widget",nt,{extends:"div"}),customElements.define("playui-enum2-widget",at,{extends:"div"}),customElements.define("playui-file-widget",lt,{extends:"div"}),customElements.define("playui-editor-widget",ct,{extends:"div"}),customElements.define("playui-text-widget",ot,{extends:"div"}),customElements.define("playui-number-widget",ht,{extends:"div"}),customElements.define("playui-state-widget",ut,{extends:"div"});const dt=class extends(Ze($e(et(HTMLFieldSetElement)))){},mt=class extends(Ze(qe(et(HTMLFieldSetElement)))){},pt=class extends(Ze(Ve(et(HTMLFieldSetElement)))){},ft=class extends(Ze(ze(et(HTMLDivElement)))){},vt=class extends(Ze(Ue(et(HTMLDivElement)))){},gt=class extends(Ze(Be(et(HTMLDivElement)))){},yt=class extends(Ze(Je(et(HTMLDivElement)))){},bt=class extends(Ze(Ge(et(HTMLDivElement)))){},xt=class extends(Ze(Xe(et(HTMLDivElement)))){},Et=class extends(Ze(Ye(et(HTMLDivElement)))){};customElements.define("playui-collection-itemscope-widget",dt,{extends:"fieldset"}),customElements.define("playui-multiple-itemscope-widget",mt,{extends:"fieldset"}),customElements.define("playui-multiple2-itemscope-widget",pt,{extends:"fieldset"}),customElements.define("playui-enum-itemscope-widget",ft,{extends:"div"}),customElements.define("playui-enum2-itemscope-widget",vt,{extends:"div"}),customElements.define("playui-file-itemscope-widget",gt,{extends:"div"}),customElements.define("playui-editor-itemscope-widget",yt,{extends:"div"}),customElements.define("playui-text-itemscope-widget",bt,{extends:"div"}),customElements.define("playui-number-itemscope-widget",xt,{extends:"div"}),customElements.define("playui-state-itemscope-widget",Et,{extends:"div"});const wt=class extends(Qe(HTMLDivElement)){};customElements.define("playui-file-preview",wt,{extends:"div"})})();
//# sourceMappingURL=main.js.map