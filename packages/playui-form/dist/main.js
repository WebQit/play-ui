(()=>{var Qt=Object.defineProperty;var Jt=(i,e)=>{for(var t in e)Qt(i,t,{get:e[t],enumerable:!0})};function v(i){return!Array.isArray(i)&&typeof i=="object"&&i}function A(i){return typeof i}function x(i,...e){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var t=globalThis.WebQitInternalsRegistry.get(i);if(!t){if(t=new Map,e[0]===!1)return t;globalThis.WebQitInternalsRegistry.set(i,t)}for(var r,s;r=e.shift();)if((s=t)&&!(t=t.get(r))){if(t=new Map,e[0]===!1)return t;s.set(r,t)}return t}function c(i){return Array.isArray(i)}function le(i){return i===!0||i===!1}function J(i){return typeof i=="function"}function Ue(i){return J(i)&&/^class\s?/.test(Function.prototype.toString.call(i))}function ee(i){return i===null||i===""}function w(i){return arguments.length&&(i===void 0||typeof i>"u")}function p(i){return Array.isArray(i)||typeof i=="object"&&i||J(i)}function K(i){return ee(i)||w(i)||i===!1||i===0||p(i)&&!Object.keys(i).length}function _(i){return J(i)||i&&{}.toString.call(i)==="[object function]"}function G(i){return i instanceof Number||typeof i=="number"}function T(i){return G(i)||i!==!0&&i!==!1&&i!==null&&i!==""&&!isNaN(i*1)}function M(i){return i instanceof String||typeof i=="string"&&i!==null}function Ve(i){return!M(i)&&!w(i.length)}function fe(i,e=1){var t=0;i.forEach(s=>{t++});var r=i.slice(i.length-t,e);return arguments.length>1?r:r[0]}function ue(i,e=1){return arguments.length>1?fe(i.slice().reverse(),e).reverse():fe(i.slice().reverse())}function xe(i,...e){return e.forEach(t=>{i.indexOf(t)<0&&i.push(t)}),i}function ze(r,e){e=e||Object.prototype,e=e&&!c(e)?[e]:e;for(var t=[],r=r;r&&(!e||e.indexOf(r)<0)&&r.name!=="default";)t.push(r),r=r?Object.getPrototypeOf(r):null;return t}function Be(i,e){var t=[];return ze(i,e).forEach(r=>{xe(t,...Object.getOwnPropertyNames(r))}),t}function S(i,e,t=!1,r=!1,s=!1){var n=0,o=i.shift();if((T(o)||o===!0||o===!1)&&(n=o,o=i.shift()),!i.length)throw new Error("_merge() requires two or more array/objects.");return i.forEach((a,f)=>{!p(a)&&!_(a)||(t?Be(a):Object.getOwnPropertyNames(a)).forEach(l=>{if(!!e(l,o,a,f)){var h=o[l],u=a[l];if((c(h)&&c(u)||v(h)&&v(u))&&(n===!0||n>0))o[l]=c(h)&&c(u)?[]:{},S([T(n)?n-1:n,o[l],h,u],e,t,r,s);else if(c(o)&&c(a))r?o[l]=u:o.push(u);else try{s?Object.defineProperty(o,l,Object.getOwnPropertyDescriptor(a,l)):o[l]=a[l]}catch{}}})}),o}function j(i,e){var t=void 0;return p(i)&&Object.keys(i).forEach((r,s)=>{t!==!1&&(t=e(T(r)?parseFloat(r):r,i[r],s))}),t}function k(...i){return S(i,(e,t,r)=>!0,!1,!1,!1)}function te(i,e,t=null,r=!1){return e.length>i.length?-1:(typeof t=="number"?r?i.slice(0,t+1+(t<0?i.length:0)):i.slice(t):i).reduce((s,n,o)=>{var[a,f,l]=s;if(!r&&a>-1)return[a,f,l];var h=l+1,u=n===e[h]?h===0?[o,0]:[f,h]:[-1,-1];return u[1]===e.length-1&&(u[1]=-1,u[0]>-1)?[u[0]].concat(u):[a].concat(u)},[-1,-1,-1])[0]+(r||typeof t!="number"?0:t>-1?t:i.length-t)}function re(i,e,t=null,r=!1){var s=te(i,e,t,r);return s===-1?[]:i.slice(s+e.length)}function Qe(i,e){return i.reduce((t,r,s)=>t||e(r,s),!1)}function m(i,e=!0){return c(i)?i:!e&&v(i)?[i]:i!==!1&&i!==0&&K(i)?[]:Ve(i)?Array.prototype.slice.call(i):v(i)?Object.values(i):[i]}function ye(i,e,t=null){return c(e)?i.filter(r=>t?e.filter(s=>t(r,s)).length:e.indexOf(r)===-1):[]}function q(i,e,t=null){return t||t!==!1&&i.dotSafe&&e.dotSafe?i.join(".")===e.join("."):i.length===e.length&&i.reduce((r,s,n)=>r&&s===e[n],!0)}function L(i,e,t=null){return c(e)?i.filter(r=>t?e.filter(s=>t(r,s)).length:e.indexOf(r)!==-1):[]}function me(i,e,t=null){return t||t!==!1&&i.dotSafe&&e.dotSafe?(i.join(".")+".").startsWith(e.join(".")+"."):e.reduce((r,s,n)=>r&&s===i[n],!0)}function ce(i){let e=(t,r,s)=>s.indexOf(t)===r;return i.filter(e)}function Z(i){return(Je(i)?i:m(i).length?[i]:[]).reduce((e,t)=>e.concat([m(t)]),[]).map(e=>H.resolve(e))}var H=class extends Array{static resolve(e){return e.every(t=>!(t+"").includes("."))?new H().concat(e):e}get dotSafe(){return!0}};function Je(i){return m(i).reduce((e,t)=>e||c(t),!1)}function Ke(i){return i.filter(e=>e||e===0).length!==i.length}function Et(i){return i.filter(e=>Ke(m(e))).length>0}var X=class{constructor(e){this.target=e,this.fireables=[],this.currentlyFiring=[]}add(e){return this.fireables.push(e),e}remove(e){this.fireables=this.fireables.filter(t=>t!==e)}removeMatches(e){this.match(e).forEach(t=>{this.fireables=this.fireables.filter(r=>r!==t)})}match(e){return this.fireables.filter(t=>{var r=Z(t.filter),s=m((t.params||{}).tags),n=Z(e.filter),o=m((e.params||{}).tags);return(!e.originalHandler||t.handler===e.originalHandler)&&(!n.length||q(n,r))&&(!o.length||o.length===s.length&&L(s,o).length===o.length)})}static _getFirebase(e,t,r=!0,s=this.__namespace){if(!p(t))throw new Error('Subject must be of type object; "'+A(t)+'" given!');var n=this;return s&&globalThis.WebQitObserverNamespaceRegistry.has(e+"-"+s)&&(n=globalThis.WebQitObserverNamespaceRegistry.get(e+"-"+s),e+="-"+s),!x(t,"firebases").has(e)&&r&&x(t,"firebases").set(e,new n(t)),x(t,"firebases").get(e)}static _namespace(e,t,r=null){if(e+="-"+t,arguments.length===2)return globalThis.WebQitObserverNamespaceRegistry.get(e);if(!(r.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${t} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(e,r),r.__namespace=t}};globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);var Y=class{constructor(e,t){this.target=e,this.handler=t.handler,this.filter=t.filter,this.params=t.params}disconnect(){this.disconnected=!0}};var pe=class extends Y{fire(e,t,r){return this.disconnected||this.filter&&!L(m(this.filter),[e.type]).length?t(...Array.prototype.slice.call(arguments,2)):this.handler(e,r,t)}};function be(i,e=[],t=!0){var r=0;return T(arguments[0])&&p(arguments[1])&&(r=arguments[0],i=arguments[1],e=arguments[2]||[]),S([r,{},i],(s,n,o)=>_(e)?e(s):c(e)&&e.length?e.indexOf(s)>-1:!0,!1,!1,t)}var ie=class{constructor(e,t){if(this.target=e,!t.type)throw new Error("Action type must be given in definition!");j(t,(r,s)=>{Object.defineProperty(this,r,{value:s,enumerable:!0})}),Object.seal(this)}};var F=class extends X{add(e){return super.add(new pe(this.target,e))}fire(e,t=null){if(e instanceof ie||(e=new ie(this.target,e)),this.currentlyFiring.filter(n=>n.type===e.type&&n.name===e.name).length)return t?t():void 0;this.currentlyFiring.push(e);let r=(n,...o)=>{var a=this.fireables[n];return a?a.fire(e,(...f)=>r(n+1,...f),...o):t?t(...o):o[0]};var s=r(0);return this.currentlyFiring.pop(),s}static getFirebase(e,t=!0,r=null){return super._getFirebase("interceptor",...arguments)}static namespace(e,t=null){return super._namespace("interceptor",...arguments)}};function O(i){return x(i,!1).get(i)||i}function P(i,e,t={},r={}){if(!e||!p(e))throw new Error("Target must be of type object!");e=O(e);var s,n=function(o){return arguments.length?o:Reflect[i](e,...Object.values(t))};return(s=F.getFirebase(e,!1,r.namespace))?s.fire({type:i,...t},n):n()}function Oe(i,e,t,r={}){return P("apply",i,{thisArgument:e,argumentsList:t},r)}function we(i,e,t=null,r={}){return P("construct",i,arguments.length>2?{argumentsList:e,newTarget:t}:{argumentsList:e},r)}function se(i,e){return typeof i!="string"?i:i.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+(typeof e!==void 0&&e?t.substr(1).toLowerCase():t.substr(1))})}var I=class{constructor(e,t=!1){this._={},this._.target=e,this._.cancellable=t,this._.propagationStopped=!1,this._.defaultPrevented=!1,this._.promisesInstance=null,this._.promises=[]}get target(){return this._.target}get cancellable(){return this._.cancellable}stopPropagation(){this._.propagationStopped=!0}get propagationStopped(){return this._.propagationStopped}preventDefault(){this._.defaultPrevented=!0}get defaultPrevented(){return this._.defaultPrevented}waitUntil(e){e instanceof Promise&&(this._.promises.push(e),this._.promisesInstance=null)}get promises(){return!this._.promisesInstance&&this._.promises.length&&(this._.promisesInstance=Promise.all(this._.promises)),this._.promisesInstance}respondWith(e){var t,r=v(e)&&!w(e.propagationStopped)&&!w(e.defaultPrevented);e===!1||r&&e.propagationStopped?this.stopPropagation():e===!1||r&&e.defaultPrevented?this.preventDefault():(e instanceof Promise&&(t=e)||r&&(t=e.promises))&&this.waitUntil(t)}};var he=class extends Y{constructor(e,t){if(super(e,t),this.filters2D=Z(this.filter),this.filtersIsOriginally2D=Je(this.filter),this.filtersIsDynamic=Et(this.filters2D),this.filtersIsDynamic&&this.filters2D.length>1)throw new Error('Only one "Dynamic Filter" must be observed at a time! "'+this.filters2D.map(r=>"["+r.join(", ")+"]").join(", ")+'" have been bound together.')}fire(e){if(this.disconnected||this.params.type&&!Qe(e,o=>this.params.type===o.type))return;let t=o=>!["set","def"].includes(o.type)||!this.params.diff||(_(this.params.diff)?this.params.diff(o.value,o.oldValue):o.value!==o.oldValue);var r=new I(this.target);if(this.filters2D.length){var s=e.filter(o=>this.filters2D.filter((a,f)=>{var l=a.slice();return this.filtersIsDynamic&&o.path.forEach((h,u)=>{l[u]=l[u]||l[u]===0?l[u]:h}),(!this.filtersIsDynamic||!Ke(l))&&t(o)&&(!this.params.subtree&&q(l,o.path)||this.params.suptree&&me(l,o.path)&&(!T(this.params.suptree)||re(l,o.path).length<=this.params.suptree)||this.params.subtree&&o.path.length>=l.length&&me(o.path,l)&&(!T(this.params.subtree)||re(o.path,l).length<=this.params.subtree))}).length);if(s.length)if(this.filtersIsOriginally2D||this.params.subtree){var n=s;v(this.filter)&&(n={...this.filter},s.forEach((o,a)=>{n[o.name]=o})),r.respondWith(this.handler(n,r))}else s.forEach((o,a)=>{r.respondWith(this.handler(o,r))})}else(this.params.subtree||e.filter(o=>q(o.path,[o.name])).length===e.length)&&e.filter(o=>t(o)).length&&r.respondWith(this.handler(e,r));return r}};var U=class{constructor(e,t){if(this.target=e,t.originalSubject||(this.originalSubject=e),!("type"in t))throw new Error("Mutation type must be given in definition!");if(!("name"in t))throw new Error("Property name must be given in definition!");j(t,(r,s)=>{r==="path"&&(s=H.resolve(s)),Object.defineProperty(this,r,{value:s,enumerable:!0})}),this.path||Object.defineProperty(this,"path",{value:H.resolve([t.name]),enumerable:!0}),Object.seal(this)}};var b=class extends X{constructor(e){super(e),this.buffers=[]}add(e){return super.add(new he(this.target,e))}fire(e,t){var r=new I(this.target,t);return e=m(e,!1).map(s=>s instanceof U?s:new U(this.target,s)),this.buffers.length?(ue(this.buffers)(e),r):(this.currentlyFiring.filter(s=>e.filter(n=>s.type===n.type&&s.name===n.name).length).length,this.fireables.forEach(s=>{if(r.propagationStopped&&t)return r;r.respondWith(s.fire(e))}),r)}static getFirebase(e,t=!0,r=null){return super._getFirebase("observer",...arguments)}static namespace(e,t=null){return super._namespace("observer",...arguments)}};function R(i,e,t=null,r={}){if(i=t||i,!i||!p(i))throw new Error("Target must be of type object!");i=O(i);var s=m(e),n=s.map(o=>{var a,f=function(l){return arguments.length?l:x(i,"accessorizedProps").has(o)&&x(i,"accessorizedProps").get(o).touch(!0)?x(i,"accessorizedProps").get(o).get():t?Reflect.get(i,o,t):Reflect.get(i,o)};return(a=F.getFirebase(i,!0,r.namespace))?a.fire({type:"get",name:o,related:s,receiver:t},f):f()});return c(e)?n:n[0]}function Te(i,e,t=null,r={}){if(i=O(i),!i||!p(i))throw new Error('Observable subjects must be of type object; "'+A(i)+'" given!');if(_(e)&&(r=arguments.length>2?t:{},t=e,e=null),!_(t))throw new Error('Handler must be a function; "'+A(t)+'" given!');var s,n=b.getFirebase(i,!0,r.namespace),o={filter:e,handler:t,params:r};if((o.filter||o.params.subtree==="*"||o.params.subtree&&ne(i))&&V(i,o.filter,o.params.subtree,r.namespace),o.params.unique&&(s=n.match({filter:e,params:r})).length){if(o.params.unique!=="replace")return s[0];n.remove(s[0])}return n.add(o)}function z(i,e,t,r=null,s={}){if(i!==t){var n;if(Te(t,(a,f)=>{if(n=b.getFirebase(i,!1,s.namespace)){var l=a.map(h=>{var u=h;do if(u.target===i)return;while(u=u.src);var g={};return j(h,(d,C)=>{d!=="target"&&d!=="name"&&d!=="path"&&d!=="src"&&(g[d]=C)}),g.name=e,g.path=[e].concat(h.path),g.originalSubject=h.originalSubject,g.src=h,new U(i,g)}).filter(h=>h);if(l.length)return n.fire(l,f.cancellable)}},{subtree:!0,...s,unique:!0,tags:[ke,e,i]}),v(r)&&(n=b.getFirebase(i,!1,s.namespace))){var o=k({name:e,type:"set",value:t,related:[e]},r);let a=n.fire(o,s.cancellable);if(s.eventTypeReturn)return a}}}var ke={};function V(i,e=null,t=!1,r=null){if(!i||!p(i))throw new Error("Target must be of type object!");var s=b.getFirebase(i,!0,r);if(!(!s||s.build)){s.build=t;var n=Z(e),o=!n.length||n.filter(f=>!f[0]&&f[0]!==0).length?Object.keys(i):n.map(f=>f[0]),a=n.length?n.map(f=>f.slice(1)).filter(f=>f.length):null;s.subBuild=a&&a.length?a:null,o.forEach(f=>{var l=R(i,f,null,{namespace:r});try{p(l)&&(z(i,f,l,null,params),(s.subBuild&&ne(l)||(_isFunction(t)?t(l):t&&ne(l)))&&V(l,s.subBuild,t,r))}catch{}})}}var ne=i=>(i instanceof Object||i instanceof Array||i instanceof Function)&&(typeof window>"u"||i!==window);function Le(i,e,t=null,r={}){if(i=O(i),!i||!p(i))throw new Error('Observable subjects must be of type object; "'+A(i)+'" given!');if(_(e)&&(r=arguments.length>2?t:{},t=e,e=null),t&&!_(t))throw new Error('Handler must be a function; "'+A(t)+'" given!');var s;if(s=b.getFirebase(i,!1,r.namespace))return s.removeMatches({filter:e,originalHandler:t,params:r})}function B(i,e,t,r=null,s={}){Le(t,null,null,{...s,tags:[ke,e,i]});var n;if(v(r)&&(n=b.getFirebase(i,!1,s.namespace))){var o=k({name:e,type:"del",oldValue:t,related:[e]},r);n.fire(o,s.cancellable)}}function Q(i,e,t={}){return P("has",i,{name:e},t)}function Fe(i,e,t,r={}){e=t.receiver||e;var s=t.keysOrPayload,n=t.value;if(!e||!p(e))throw new Error("Target must be of type object!");v(s)&&(r=n||{},n=null),e=O(e);var o=F.getFirebase(e,!1,r.namespace),a=b.getFirebase(e,!1,r.namespace);let f=(d,C,$e,He)=>{var gt="set",D;i&&(gt="defineProperty",D=C||{},C=D.value);var _e=!1,ve;Q(e,d,r)&&(_e=!0,ve=R(e,d,t.receiver,r));var N={name:d,type:gt,value:C,receiver:t.receiver,related:$e,detail:He,isUpdate:_e,oldValue:ve},_t=function(vt){return arguments.length&&(D?D=vt:C=vt),D?x(e,"accessorizedProps",!1).has(d)&&!x(e,"accessorizedProps").get(d).restore()?!1:(Object.defineProperty(e,d,D),!0):x(e,"accessorizedProps",!1).has(d)?x(e,"accessorizedProps").get(d).set(C):(e[d]=C,!0)};if(o){var Bt=D?{type:"defineProperty",name:d,descriptor:D,receiver:t.receiver,related:$e,detail:He,isUpdate:_e,oldValue:ve}:{type:"set",name:d,value:C,receiver:t.receiver,related:$e,detail:He,isUpdate:_e,oldValue:ve};N.success=o.fire(Bt,_t)}else N.success=_t();return N.success&&N.value!==N.oldValue&&(p(N.oldValue)&&B(e,d,N.oldValue,null,r),p(N.value)&&(z(e,d,N.value,null,r),a&&(a.subBuild||a.build&&ne(N.value))&&V(N.value,a.subBuild,a.build,r.namespace))),N};var l,h=[];c(s)||(M(s)||G(s))&&(l=m(s))?h=l.map(d=>f(d,n,l,r.detail)):v(s)&&(l=Object.keys(s))&&(h=l.map(d=>f(d,s[d],l,r.detail)));var u=h.filter(d=>d.success!==!1),g;return a?(g=a.fire(u,r.cancellable),g.successCount=u.length):r.eventTypeReturn&&(g=new I(e)),r.eventTypeReturn?g:u.length>0}function Pe(i,e,t=null,r={}){return Fe(!0,i,{keysOrPayload:e,value:t},r)}function Ae(i,e,t={}){if(!i||!p(i))throw new Error("Target must be of type object!");i=O(i);var r=m(e),s=r.map(f=>{var l;Q(i,f,t)&&(l=R(i,f,null,t));var h={name:f,type:"deleteProperty",related:r,detail:t.detail,oldValue:l},u,g=function(d){return arguments.length?d:x(i,"accessorizedProps",!1).has(f)&&!x(i,"accessorizedProps").get(f).restore()?!1:(delete i[f],!0)};return(u=F.getFirebase(i,!1,t.namespace))?h.success=u.fire({type:"deleteProperty",name:f,oldValue:l,related:r},g):h.success=g(),h.success&&p(h.oldValue)&&B(i,f,h.oldValue,null,t),h}),n=s.filter(f=>f.success!==!1),o,a;return(o=b.getFirebase(i,!1,t.namespace))?(a=o.fire(n,t.cancellable),a.successCount=n.length):t.eventTypeReturn&&(a=new I(i)),t.eventTypeReturn?a:n.length>0}function Me(i,e,t={}){return P("getOwnPropertyDescriptor",i,{name:e},t)}function Ne(i,e={}){return P("getPrototypeOf",i,{},e)}function Re(i,e={}){return P("isExtensible",i,{},e)}function Se(i,e={}){return P("ownKeys",i,{},e)}function Ie(i,e={}){return P("preventExtensions",i,{},e)}function oe(i,e,t=null,r=null,s={}){return Fe(!1,i,arguments.length>3?{keysOrPayload:e,value:t,receiver:r}:{keysOrPayload:e,value:t},s)}function We(i,e,t={}){return P("setPrototypeOf",i,{prototype:e},t)}function wt(i,e=[],t={}){t=v(e)?e:t;var r=(arguments.length===1?Object.keys(i):m(e)).map(s=>{if(x(i,"accessorizedProps").has(s)&&x(i,"accessorizedProps").get(s).touch(!0))return!1;let n=()=>{for(var g,d=i;!g&&(d=Object.getPrototypeOf(d));)g=Object.getOwnPropertyDescriptor(d,s);return g};var o=Object.getOwnPropertyDescriptor(i,s),a,f;o||(a={writable:!0,enumerable:!(s in i),configurable:t.configurable!==!1});var l={...o||a};"value"in l&&delete l.value,"writable"in l&&delete l.writable,l.get=()=>{if(u.ongoingGets.length)return u.get();u.ongoingGets.push(1);var g=R(i,s,null,t);return u.ongoingGets.pop(),g};var h;l.set=g=>{if(u.ongoingSets.length)return u.set(g);u.ongoingSets.push(1);var d=oe(i,s,g,null,t);return u.ongoingSets.pop(),d};var u={ongoingGets:[],ongoingSets:[],get:function(){var g=o;return g||(f?g=a:g=n()||a),g.get?g.get.call(i):g.value},set:function(g){var d=o;return d||(f?d=a:(d=n())?"value"in d&&(d=a,f=!0):(d=a,f=!0)),d.set||d.get?d.set?d.set.call(i,g):!1:(d.value=g,!0)},restore:function(){try{return this.intact()&&(o||f?Object.defineProperty(i,s,o||a):delete i[s],x(i,"accessorizedProps").delete(s)),!0}catch{}return!1},intact:function(){return(Object.getOwnPropertyDescriptor(i,s)||{}).get===l.get},touch:function(g=!1){return this.intact()||(g?!this.restore():!1)}};try{return Object.defineProperty(i,s,l),x(i,"accessorizedProps").set(s,u),!0}catch{}return!1});return c(e)?r:r[0]}function Tt(i,e=[],t={}){t=v(e)?e:t;var r=(arguments.length===1?Object.keys(i):m(e)).map(s=>x(i,"accessorizedProps",!1).has(s)?x(i,"accessorizedProps").get(s).restore():!0);return c(e)?r:r[0]}function Lt(i,e={}){if(!p(i))throw new Error('Object must be of type target; "'+A(i)+'" given!');var t=new Proxy(i,{apply:(r,s,n)=>Oe(r,s,n,e),construct:(r,s,n=null)=>we(r,s,n,e),defineProperty:(r,s,n)=>Pe(r,s,n,e),deleteProperty:(r,s)=>Ae(r,s,e),get:(r,s,n=null)=>{var o=R(r,s,n,e);return e.proxyAutoBinding!==!1&&_(o)&&!Ue(o)?o.bind(t):o},getOwnPropertyDescriptor:(r,s)=>Me(r,s,e),getPrototypeOf:r=>Ne(r,e),has:(r,s)=>Q(r,s,e),isExtensible:r=>Re(r,e),ownKeys:r=>Se(r,e),preventExtensions:r=>Ie(r,e),set:(r,s,n,o=null)=>oe(r,s,n,o,e),setPrototypeOf:(r,s)=>We(r,s,e)});return x(t).set(t,i),t}function Ft(i,e,t={}){if(i=O(i),!p(i))throw new Error('Object must be of type target; "'+A(handler)+'" given!');var r={},s=!0;v(e)||(_(e)?e={"":e}:_(t)&&(e={[e]:t},t=arguments.length>3?arguments[3]:{}),s=!1);var n=F.getFirebase(i,!0,t.namespace);return Object.keys(e).forEach(o=>{if(!_(e[o]))throw new Error("Callback"+(o===null?"":" for "+o)+' must be a function; "'+A(e[o])+'" given!');var a={filter:o,handler:e[o],params:t},f;if(a.params.unique&&(f=n.match(a)).length){if(a.params.unique!=="replace")return f[0];n.remove(f[0])}s?r[o]=n.add(a):r=n.add(a)}),r}function Pt(i,e=null,t={}){if(i=O(i),!i||!p(i))throw new Error('Object must be of type target; "'+A(i)+'" given!');var r=F.getFirebase(i,!1,t.namespace);_isObject(e)||(_(e)?e={[null]:e}:_(t)&&(e={[e]:t},t=arguments.length>3?arguments[3]:{}),isOriginallyObj=!1),(r=F.getFirebase(i,!1,t.namespace))&&Object.keys(e).forEach(s=>{if(!_(e[s]))throw new Error("Callback"+(s===null?"":" for "+s)+' must be a function; "'+A(e[s])+'" given!');var n={filter:s,originalHandler:e[s],params:t};return r.removeMatches(n)})}function At(i,...e){var t=e.map(n=>{if(n=O(n),!p(n))throw new Error("Target must be of type object!");return{target:n,subjectCopy:c(n)?n.slice(0):be(n)}}),r=i(...e);let s=()=>{t.map(n=>{var o=Object.keys(n.subjectCopy),a=Object.keys(n.target),f=[],l=ce(o.concat(a)).map(u=>{if(n.subjectCopy[u]!==n.target[u]){f.push(u);var g={name:u,related:f,buffered:!0};return a.includes(u)?(g.type="set",g.value=n.target[u],o.includes(u)&&(g.isUpdate=!0)):g.type="del",o.includes(u)&&(g.oldValue=n.subjectCopy[u]),p(n.subjectCopy[u])&&B(n.target,u,n.subjectCopy[u]),p(n.target[u])&&z(n.target,u,n.target[u]),g}}).filter(u=>u),h;if(l.length&&(h=b.getFirebase(n.target,!1)))return h.fire(l)})};return r instanceof Promise?r.then(s):s(),r}var y={apply:Oe,construct:we,defineProperty:Pe,deleteProperty:Ae,get:R,getOwnPropertyDescriptor:Me,getPrototypeOf:Ne,has:Q,isExtensible:Re,ownKeys:Se,preventExtensions:Ie,set:oe,setPrototypeOf:We,accessorize:wt,unaccessorize:Tt,proxy:Lt,unproxy:O,observe:Te,unobserve:Le,intercept:Ft,unintercept:Pt,closure:At,build:V,link:z,unlink:B,Observers:b,Interceptors:F};var Ze=i=>i&&(i.startsWith("text/")||i==="application/rtf"||i==="application/xml"||i==="application/xhtml+xml"||i==="application/json"),Mt=i=>i.format==="data-url"||i.contentEncoding==="base64";var it={};Jt(it,{_Array:()=>je,_Boolean:()=>rt,_Integer:()=>ar,_Null:()=>lr,_Num:()=>et,_Number:()=>tt,_Object:()=>Ye,_ObjectOrArray:()=>Xe,_Schema:()=>ae,_String:()=>de});var ae=i=>class extends(i||class{}){constructor(e){super(e),Object.keys(e).forEach(t=>{Object.defineProperty(this,t,{value:e[t]})})}validate(e){return super.validate?super.validate(e):{valid:!0}}},Xe=i=>class extends ae(i){validate(e){var t=super.validate(e);return t.valid?(t=this._validateMin(e)).valid?(t=this._validateMax(e)).valid?t:{valid:!1,error:t.error||`Maximum number of entries exceeded by: ${t.violation}.`}:{valid:!1,error:t.error||`Minimum number of entries short of: ${t.violation}.`}:t}},Ye=i=>class extends Xe(i){getPropertyNameSchema(e=null){var t=this.propertyNames||{type:"string"};return this.additionalProperties===!1&&(t.error="Additional properties not allowed."),t.isRequired=!0,t}getPropertySchema(e,t=null){var r;if((!this.properties||!(r=this.properties[e]))&&!(r=this._patternPropertiesMatch(e))&&!(r=this.additionalProperties)&&r!==!1&&(r={}),r){if((this.required||[]).includes(e)&&(r.isRequired=!0),t){let o=Object.keys(t);var s;!r.isRequired&&(s=L(this.dependentRequired||[],o).reduce((a,f)=>a||this.dependentRequired[f].includes(e)?f:null,null))&&(r.isRequired=s);var n;(!o.includes(e)&&!(n=this._validateMax(t)).valid||n.violation===0)&&(r.error="This additional entry will violate the maximum number of entries allowed.")}return{...r,name:e}}}_patternPropertiesMatch(e){return Object.keys(this.patternProperties||{}).reduce((t,r)=>{if(t)return t;if(new RegExp(r).test(e))return this.patternProperties[r]},null)}validate(e){var t=super.validate(e);return t.valid?(t=this._validateRequired(e)).valid?(t=this._validateDependentRequired(e)).valid?t:{valid:!1,error:t.error||`Entries associated with "${t.master}" still empty: ${t.violation.join(", ")}.`}:{valid:!1,error:t.error||`Required entries still empty: ${t.violation.join(", ")}.`}:t}_validateMax(e){if(!this.maxProperties)return{valid:!0};let r=Object.keys(e).length-this.maxProperties;return{valid:r<=0,violation:r}}_validateMin(e){if(!this.minProperties)return{valid:!0};let t=Object.keys(e),r=this.minProperties-t.length;return{valid:r<=0,violation:r}}_validateRequired(e){if(!this.required)return{valid:!0};let t=Object.keys(e),r=ye(this.required,t);return{valid:r.length===0,violation:r}}_validateDependentRequired(e){if(!this.dependentRequired)return{valid:!0};let t=Object.keys(e),[r,s]=Object.keys(this.dependentRequired).reduce((n,o)=>{if(n)return n;if(t.includes(o)){let a=ye(this.dependentRequired[o],t);if(a.length)return[o,a]}},null)||[];return{valid:!r,master:r,violation:s}}},je=i=>class extends Xe(i){getItemSchema(e,t=null){var r;if((!this.prefixItems||!(r=this.prefixItems[e]))&&!(r=this.items)&&r!==!1&&(r={}),r){if(t){var s;(!(e in t)&&!(s=this._validateMax(t)).valid||s.violation===0)&&(r.error="This additional entry will violate the maximum number of entries allowed.")}return{...r,name:e}}}validate(e){var t=super.validate(e);return t.valid?(t=this._validateUnique(e)).valid?(t=this._validateContains(e)).valid?t:{valid:!1,error:t.error||`Entries must contain ${t.min>0?`at least ${t.min} `+(t.max>1?"and ":""):""} ${t.max>1?`at most ${t.max} `:""}of ${t.desc}.`}:{valid:!1,error:t.error||"Entries must be unique"}:t}_validateMax(e){if(!this.maxItems)return{valid:!0};let t=e.length-this.maxItems;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minItems)return{valid:!0};let t=this.minItems-e.length;return{valid:t<=0,violation:t}}_validateUnique(e){return this.uniqueItems?{valid:ce(e).length===e.length}:{valid:!0}}_validateContains(e){if(!this.contains)return{valid:!0};let t=e.filter(r=>this.__validateContains(this.contains,r));return t.length<(this.minContains||1)?{valid:!1,min:this.minContains||1,max:this.maxContains,desc}:this.maxContains&&t.length>this.maxContains?{valid:!1,min:this.minContains||1,max:this.maxContains,desc}:{valid:!0}}},de=i=>class extends ae(i){validate(e){var t=super.validate(e);return t.valid?{valid:M(e)}:t}},et=i=>class extends ae(i){validate(e){var t=super.validate(e);return t.valid,t}},tt=i=>class extends et(i){validate(e){var t=super.validate(e);return t.valid?{valid:T(e)}:t}},ar=i=>class extends et(i){validate(e){var t=super.validate(e);return t.valid?{valid:Number.isInteger(e)}:t}},rt=i=>class extends ae(i){validate(e){var t=super.validate(e);return t.valid?{valid:le(e)}:t}},lr=i=>class extends ae(i){validate(e){var t=super.validate(e);return t.valid?{valid:ee(e)}:t}};var ge=i=>class extends(i||class{}){constructor(){super(),this.nodeRemovalListeners=new Map}execNodeRemoval(e){_(e.remove)&&e.remove()}onNodeRemoval(e,t){var r=this.nodeRemovalListeners.get(e);r||(r=[],this.nodeRemovalListeners.set(e,r)),r.push(t)}async remoteAction(e,t,r={}){return{}}static getSchemaName(e){return e=m(e||"string"),[["object","_Object"],["array","_Array"],["string","_String"],["number","_Number"],["integer","_Integer"],["boolean","_Boolean"],["null","_Null"]].reduce((t,r)=>t||(e.includes(r[0])?r[1]:null),null)}define(e,t=null){y.set(this,"schema",y.proxy(e)),y.set(this,"ownerWidget",t),y.set(this,"attrs",y.proxy({name:this.ownerWidget&&this.ownerWidget.attrs.name?`${this.ownerWidget.attrs.name}[${this.schema.name}]`:this.schema.name})),this.state||y.set(this,"state",y.proxy({})),this.schema.title||(this.schema.title=se(((this.schema.name||"")+"").replaceAll("_"," "))),this.schema.isRequired&&(this.attrs.required=!0),(!w(this.schema.const)||!w(this.schema.default))&&(this.attrs.value=w(this.schema.const)?this.schema.default:this.schema.const),(this.schema.readOnly||!w(this.schema.const))&&(this.attrs.readonly=!0)}alert(e=null){return arguments.length&&(this.state.alert={message:e.message,type:e.type}),{...this.state.alert||{}}}json(){}set value(e){this.json(e)}get value(){return this.json()}},Nt=i=>class extends ge(i){deriveChildEntry(e,t){}},Rt=i=>class extends Nt(i){constructor(){super(),y.set(this,"childEntries",y.proxy({})),y.observe(this.childEntries,t=>{t.forEach(r=>{r.type==="set"&&(r.isUpdate&&r.oldValue&&this.execNodeRemoval(r.oldValue),r.value?_(this.onNodeRemoval)&&this.onNodeRemoval(r.value,()=>{this.childEntries[r.name]===r.value&&delete this.childEntries[r.name]}):console.warn(`No widget type defined for entry "${r.name}" of schema type "${m(this.schema.properties[r.name].type||"string").join(", ")}".`)),r.type==="deleteProperty"&&this.execNodeRemoval(r.oldValue)})});function e(t,r){return t.replace(/\{.+?\}/g,s=>index(r,s))}}static testSchema(e){return m(e.type).includes("object")}define(e,t=null){super.define(new(Ye())(e),t),Object.keys(this.childEntries).forEach(r=>{delete this.childEntries[r]}),Object.keys(this.schema.properties||{}).forEach(r=>{let s=this.schema.getPropertySchema(r);s.display!==!1&&(this.childEntries[r]=this.deriveChildEntry(s,r))})}extend(e,t=null){if(_(e)){let r=()=>{let s=this.schema.getPropertyNameSchema(this.json());e(s,n=>{s.validate(n)?extend(n,t):r()})};r()}else if(e){let r=this.json();this.childEntries[e]=this.deriveChildEntry(this.schema.getPropertySchema(e,r),e),t&&t(this.childEntries[e])}}json(e={},t=!1){if(arguments.length){if(!v(e))throw new Error("Data must be a valid JSON object.");Object.keys(e).forEach(s=>{this.childEntries[s]?this.childEntries[s].json(e[s]):t&&this.extend(s,n=>{n.json(e[s])})});return}let r={};return Object.keys(this.childEntries).forEach(s=>{r[s]=this.childEntries[s].json()}),r}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!v(e.details))throw new Error("Alert details must be a valid JSON object.");Object.keys(e.details||{}).forEach(s=>{this.childEntries[s]?this.childEntries[s].alert(e.details[s]):t&&this.extend(s,n=>{n.alert(e.details[s])})});return}let r=super.alert();return r.details={},Object.keys(this.childEntries).forEach(s=>{r.details[s]=this.childEntries[s].alert()}),r}},st=i=>class extends Nt(i){constructor(){super(),y.set(this,"childEntries",y.proxy([])),y.observe(this.childEntries,e=>{e.forEach(t=>{t.name!=="length"&&(t.type==="set"&&(t.isUpdate&&t.oldValue&&this.childEntries.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue),t.value?_(this.onNodeRemoval)&&this.onNodeRemoval(t.value,()=>{let r=this.childEntries.indexOf(t.value);r>-1&&this.childEntries.splice(r,1)}):console.warn(`No widget type defined for entry "${t.name}" of schema type "${m(t.value.type||"string").join(", ")}".`)),t.type==="deleteProperty"&&this.childEntries.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue))})})}static testSchema(e){return m(e.type).includes("array")}define(e,t=null){super.define(new(je())(e),t),this.childEntries.splice(0),K(this.schema.prefixItems)||this.schema.prefixItems.forEach((r,s)=>{this.childEntries.push(this.deriveChildEntry(r,s))}),this.schema.autoExtend===!0&&this.extend()}extend(e=null){let t=this.json(),r=t.length,s=this.deriveChildEntry(this.schema.getItemSchema(r,t),r);this.childEntries.push(s),e&&e(s)}execNodeRemoval(e,t=null){if(t||(t=(a,f)=>f()),this.childEntries.indexOf(e)===-1)return;let s=e.schema?T(e.schema.title)?`item ${parseInt(e.schema.title)+1}`:e.schema.title:"item";if(this.schema.remoteDelete){var n=e.value;if(n&&!p(n)){var o=this.schema.remoteDelete.url.replace(/\{value\}/g,n);t(`Remove ${s} (and delete from your account)?`,()=>this.remoteAction(this.schema.remoteDelete.method||"delete",o).then(a=>(a.ok&&super.execNodeRemoval(e),a)));return}}t(`Remove ${s}?`,async()=>{super.execNodeRemoval(e)})}json(e=[]){if(arguments.length){if(!c(e))throw new Error("Data must be a valid JSON array.");e.forEach((t,r)=>{this.childEntries[r]?this.childEntries[r].json(t):this.extend(s=>{s.json(t)})});return}return this.childEntries.filter(t=>t).map(t=>t.json())}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!c(e.details)&&!Object.keys(e.details).every(s=>T(s)))throw new Error("Alert items must be a valid JSON array.");Object.keys(e.details).forEach(s=>{let n=e.details[s];this.childEntries[s]?this.childEntries[s].alert(n):this.extend(o=>{o.alert(n)})});return}let r=super.alert();return r.details=this.childEntries.filter(s=>s).map(s=>s.alert()),r}},St=i=>class extends st(i){static testSchema(e){if(!!super.testSchema(e)&&!e.enum){var t=[],r=this.lineContentLengthLimit||50;if(e.prefixItems){if(e.prefixItems.some(s=>!("const"in s)&&(s.enum||[]).length!==1||L(m(s.type),["array","object"]).length||Math.max(s.minLength,s.maxLength,0)>r))return;t=e.prefixItems.map(s=>"const"in s?s.const:s.enum[0])}if(e.items){if(L(m(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>r)return;t=t.concat(e.items.enum||[])}return!t.some(s=>p(s)||(s+"").length>r)}}define(e,t=null){super.define(...arguments),this.schema.autoExtend!==!1&&this.extend()}},nt=i=>class extends ge(i){constructor(){super(),y.set(this,"enumEntries",y.proxy([])),y.observe(this.enumEntries,e=>{e.forEach(t=>{t.name!=="length"&&(t.type==="set"&&(t.isUpdate&&t.oldValue&&this.enumEntries.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue),_(this.onNodeRemoval)&&this.onNodeRemoval(t.value,()=>{let r=this.enumEntries.indexOf(t.value);r>-1&&this.enumEntries.splice(r,1)})),t.type==="deleteProperty"&&this.enumEntries.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue))})})}static testSchema(e){return c(e.enum)||m(e.type).includes("array")&&(K(e.prefixItems)||e.prefixItems.every(t=>"const"in t||(t.enum||[]).length===1))&&(e.items===!1||c((e.items||{}).enum)&&e.uniqueItems)}define(e,t=null){let r=this.constructor.getSchemaName(e.type);this.enumEntries.splice(0),super.define(new(it[r]())(e),t);let s=(o,a)=>{let f=o.map((l,h)=>({value:l,label:(a||{})[h]}));this.enumerate(f,1)},n=o=>{this.enumFetching=this.remoteAction(o.method||"get",o.url,{headers:{accept:"application/json"}}).then(a=>a.ok?a.json():Promise.reject({message:a.statusText})).then(a=>{var f=c(a.data)?a.data.map(l=>v(l)?{value:"value"in l?l.value:l.id,label:"label"in l?l.label:l.title}:{value:l}):[];this.enumerate(f,o.url)})};if(this.schema.remoteFetch)n(this.schema.remoteFetch),y.observe(this.schema,"remoteFetch",()=>{n(this.schema.remoteFetch)},{subtree:!0});else if(this.schema.enum)s(this.schema.enum,this.schema.enumNames),y.observe(this.schema,[["enum"],["enumNames"]],()=>{s(this.schema.enum,this.schema.enumNames)});else if(m(this.schema.type||"string").includes("array")){let o=[];this.schema.prefixItems&&(o=this.schema.prefixItems.map(a=>"const"in a?{value:a.const,label:a.title}:{value:a.enum[0],label:a.title||(a.enumNames||[])[0]})),this.schema.items&&this.schema.items.enum.forEach((a,f)=>{o.push({value:a,label:(this.schema.items.enumNames||[])[f]})}),this.attrs.multiple=!0,this.attrs.name+="[]",o.forEach(a=>{a.selected=!0}),this.enumerate(o,2)}}deriveEnumEntry(e,t){}enumerate(e,t=null){m(this.schema.type).includes("null")&&(e=[{value:null,label:this.attrs.placeholder}].concat(e)),t&&(t===!0?this.enumEntries.splice(0):this.enumEntries.filter(r=>L(m(r.enumTag),m(t)).length).forEach(r=>{let s=this.enumEntries.indexOf(r);s>-1&&this.enumEntries.splice(s,1)})),this.enumEntries.push(...e.map((r,s)=>(r=this.deriveEnumEntry(r,s),t&&(r.enumTag=t),r)))}json(e=[]){if(arguments.length){if(!c(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}let r=()=>{this.enumEntries.forEach(s=>{s.selected=!1,e.forEach(n=>{s.value===n+""&&(s.selected=!0)})})};this.enumFetching?this.enumFetching.then(r):r();return}let t=this.enumEntries.filter(r=>r.selected).map(r=>r.value);return this.attrs.multiple?t:t[0]}},It=i=>class extends nt(i){static testSchema(e){if(!!super.testSchema(e)){var t=[],r=this.lineContentLengthLimit||50;if(e.enum){if(L(m(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>r)return;t=e.enum}else if(!e.remoteFetch){if(e.prefixItems){if(e.prefixItems.some(s=>L(m(s.type),["array","object"]).length||Math.max(s.minLength,s.maxLength,0)>r))return;t=e.prefixItems.map(s=>"const"in s?s.const:s.enum[0])}if(e.items){if(L(m(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>r)return;t=t.concat(e.items.enum)}}return!t.some(s=>p(s)||(s+"").length>r)}}},Wt=i=>class extends ge(i){constructor(){super(),y.set(this,"filesList",y.proxy([])),y.set(this,"fallbackFilesList",y.proxy([])),y.observe(this.filesList,e=>{e.forEach(t=>{t.name!=="length"&&(t.type==="set"&&(t.isUpdate&&t.oldValue&&this.filesList.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue),_(this.onNodeRemoval)&&this.onNodeRemoval(t.value,()=>{let r=this.filesList.indexOf(t.value);r>-1&&this.filesList.splice(r,1)})),t.type==="deleteProperty"&&this.filesList.indexOf(t.oldValue)===-1&&this.execNodeRemoval(t.oldValue))})})}static testSchema(e){let t=r=>m(r.type||"string").includes("string")&&(Mt(r)||r.contentMediaType&&!Ze(r.contentMediaType));return t(e)||m(e.type).includes("array")&&e.uniqueItems&&K(e.prefixItems)&&t(e.items||{})}define(e,t=null){let r=m(e.type),s=r.includes("array")?je():de();super.define(new s(e),t),this.filesList.splice(0),this.attrs.type="file",r.includes("array")&&(this.attrs.name+="[]",this.attrs.multiple=!0),(this.schema.contentMediaType||this.schema.items&&this.schema.items.contentMediaType)&&(this.attrs.accept=this.schema.contentMediaType||this.schema.items.contentMediaType)}deriveFileEntry(e,t){}populate(e,t=null){if(t&&(t===!0?this.filesList.splice(0):this.filesList.filter(r=>L(m(r.enumTag),m(t)).length).forEach(r=>{let s=this.filesList.indexOf(r);s>-1&&(s>-1&&L(m(r.enumTag),[1,2]).length===2&&this.fallbackFilesList.push(this.filesList[s]),this.filesList.splice(s,1))})),(!e||!e.length)&&(!this.filesList.length||!this.filesList[0])&&this.fallbackFilesList.length){let r=this.fallbackFilesList[0].enumTag;this.populate(this.fallbackFilesList.splice(0).map(s=>({file:s.file})),r)}this.filesList.push(...e.filter(r=>M(r.file)||r.file.name).map((r,s)=>{var n=this.deriveFileEntry(r,s,t);return t!==null&&(n.enumTag=t),n}))}execNodeRemoval(e,t=null){t||(t=(o,a)=>a());let r="file";if(this.schema.remoteDelete&&this.fallbackFilesList.indexOf(e)===-1){var s=e.file;if(s&&!p(s)){var n=this.schema.remoteDelete.url.replace(/\{value\}/g,s);t(`Remove ${r} (and delete from your account)?`,()=>this.remoteAction(this.schema.remoteDelete.method||"delete",n).then(o=>(o.ok&&super.execNodeRemoval(e),o)));return}}t(`Remove ${r}?`,async()=>{super.execNodeRemoval(e)})}json(e=[]){if(arguments.length){if(!c(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}this.populate(e.filter(r=>r).map(r=>({file:r})),[1,2]);return}let t=this.filesList.filter(r=>v(r.file)).map(r=>r.file);return this.attrs.multiple?t:t[0]}},ot=i=>class extends ge(i){define(e,t=null){super.define(...arguments),(!w(this.schema.default)||this.schema.examples)&&(this.attrs.placeholder=`E.g.: ${w(this.schema.default)?this.schema.examples[0]:this.schema.default}`),("const"in this.schema||(this.schema.enum||[]).length===1)&&(this.attrs.value="const"in this.schema?this.schema.const:this.schema.enum[0])}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},jt=i=>class extends ot(i){static testSchema(e){return m(e.type||"string").includes("string")&&(e.contentMediaType&&Ze(e.contentMediaType)||Math.max(e.maxLength||0,e.minLength||0)>=1024)}define(e,t=null){super.define(new(de())(e),t)}},Ct=i=>class extends ot(i){static testSchema(e){return m(e.type||"string").includes("string")}define(e,t=null){if(super.define(new(de())(e),t),this.attrs.type="text",this.schema.format==="date"?this.attrs.type="date":this.schema.format==="time"?this.attrs.type="time":this.schema.format==="date-time"?this.attrs.type="datetime-local":this.schema.format==="duration"?this.attrs.type="":["uri","uri-reference","iri","iri-reference","uuid"].includes(this.schema.format)?this.attrs.pattern="":["hostname","idn-hostname"].includes(this.schema.format)?this.attrs.pattern="":["email","idn-email"].includes(this.schema.format)?this.attrs.type="email":["ipv4","ipv6"].includes(this.schema.format)?this.attrs.pattern="":this.schema.format==="password"?this.attrs.type="password":this.schema.format==="color"?this.attrs.type="color":this.schema.format==="phone"?this.attrs.pattern="^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,6}$":this.schema.format==="postal-code"&&(this.attrs.pattern="^[0-9]{5}(?:-[0-9]{4})?$"),this.schema.maxLength&&(this.attrs.maxlength=this.schema.maxLength),this.schema.minLength&&(this.attrs.minlength=this.schema.minLength),this.schema.pattern&&(this.attrs.pattern=this.schema.pattern),!this.schema.col){let r=this.schema.maxLength||150;this.schema.col=Math.max(1,parseInt(r/(300/12)))}}},Dt=i=>class extends ot(i){static testSchema(e){let t=m(e.type);return t.includes("integer")||t.includes("number")}define(e,t=null){if(super.define(new(tt())(e),t),this.attrs.type="number",this.schema.exclusiveMaximum?this.attrs.max=this.schema.exclusiveMaximum-1e-4:this.schema.maximum&&(this.attrs.max=this.schema.maximum),this.schema.exclusiveMinimum?this.attrs.min=this.schema.exclusiveMinimum+1e-4:this.schema.minimum&&(this.attrs.min=this.schema.minimum),this.schema.multipleOf&&(this.attrs.step=this.schema.multipleOf),!this.schema.col){let r=this.schema.maxLength||50;this.schema.col=Math.max(1,parseInt(r/(300/12)))}}},qt=i=>class extends ge(i){static testSchema(e){return m(e.type).includes("boolean")}define(e,t=null){super.define(new(rt())(e),t),this.attrs.type="checkbox",(this.schema.const===!0||this.schema.default===!0)&&(this.attrs.checked=!0)}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},$t=i=>class extends(i||class{}){define(e,t=null){super.define(...arguments);let r=()=>{(this.attrs.index||this.attrs.index===0)&&this.childEntries&&this.schema.indexProperty&&this.childEntries[this.schema.indexProperty]&&this.childEntries[this.schema.indexProperty].json(this.attrs.index)};r(),y.observe(this.attrs,"index",r)}};var Ce=i=>class extends(i||HTMLElement){constructor(){super(),new MutationObserver(t=>{t.forEach(r=>{r.removedNodes.forEach(s=>{this.nodeRemovalListeners&&this.nodeRemovalListeners.has(s)&&this.nodeRemovalListeners.get(s).forEach(n=>n())})})}).observe(this,{subtree:!0,childList:!0})}async remoteAction(e,t,r={}){return this.state.remoteAction=e,this.state.remoteActionError="",fetch(t,{headers:{accept:"application/json"},...r,method:e}).then(s=>(this.state.remoteAction=!1,s)).catch(s=>{this.state.remoteAction=!1,this.alert(s)})}static get subscriptMethods(){return["renderBasic","render"]}connectedCallback(){super.connectedCallback(),this.renderBasic(),this.render()}renderBasic(){this.schema?.title&&this.namespace.title&&$(this.namespace.title).html(this.schema.title),this.schema?.description&&this.namespace.description&&$(this.namespace.description).html(this.schema.description),this.schema?.isRequired&&$(this).attr("data-required",!0),this.schema?.col&&this.schema.col!==12?$(this).class({["col-"+this.schema.col]:!0,"col-12":!1}):$(this).class("col-12",!0),this.schema?.display==="hidden"&&$(this).class("overflow-hidden wt-0 ht-0 pd-0 mg-0",!0),$(this).attr("data-remote-action",this.state.remoteAction||!1),$(this).attr("data-remote-action-error",this.state.remoteActionError||!1);var e=this.state.alert?this.state.alert.message:"",t=this.state.alert?this.state.alert.type:"";this.namespace.alert&&($(this.namespace.alert).html(e||""),$(this.namespace.alert).attr("data-type",t||!1),e&&this.namespace.alert.focus())}render(){}alert(){let e=super.alert(...arguments);return this.renderBasic(),e}},Ht=i=>class extends Ce(i){connectedCallback(){super.connectedCallback(),this.namespace.adder&&(this.adderAction=this.adderAction||(()=>this.extend()),this.namespace.adder.removeEventListener("click",this.adderAction),this.namespace.adder.addEventListener("click",this.adderAction))}deriveChildEntry(e,t){if(!!this.template){var r=Reflect.ownKeys(this.template.exports).map(s=>this.template.exports[s][0]).reduce((s,n)=>{if(s)return s;let o=n.hasAttribute("is")?customElements.get(n.getAttribute("is")):customElements.get(n.localName);return o&&o.testSchema(e)?n:null},null);if(r){r=r.cloneNode(!0),this.namespace.content?this.namespace.content.append(r):this.append(r);try{r.define(e,this),(r.attrs||{}).index=t}catch(s){console.warn("Error calling element.define();",s,this)}}return r}}},De=i=>class extends Ht(Rt(i||HTMLElement)){get value(){if(this.schema.primaryKey&&this.childEntries[this.schema.primaryKey])return this.childEntries[this.schema.primaryKey].json()}},Ut=i=>class extends Ht(i){},at=i=>class extends Ut(st(i||HTMLElement)){},lt=i=>class extends Ut(St(i||HTMLElement)){constructor(){super(),this.addEventListener("keypress",e=>{e.key==="Enter"&&(this.extend(t=>t.namespace.input?t.namespace.input.focus():null),e.preventDefault())})}extend(e=null){if(!(this.childEntries.length&&!this.childEntries[this.childEntries.length-1].namespace.input.value))return super.extend(e)}render(){this.namespace.input&&this.attrs?.name&&$(this.namespace.input).attr(this.attrs)}},Vt=i=>class extends Ce(i){deriveEnumEntry(e,t){var r;if(!this.template&&this.namespace.input instanceof HTMLSelectElement)r=document.createElement("option");else{var s=Reflect.ownKeys(this.template.exports).map(n=>this.template.exports[n][0]).reduce((n,o)=>{if(n)return n;let a=o.hasAttribute("is")?customElements.get(o.getAttribute("is")):customElements.get(o.localName);return a&&a.testSchema(this.schema,e)?o:null},null);s&&(r=s.cloneNode(!0))}return r&&(this.namespace.input instanceof HTMLSelectElement?(this.namespace.input.options.add(r),r.setAttribute("label",e.label||se(e.value)),r.value=e.value,r.selected=e.selected):(this.namespace.input.append(r),r.setAttribute("data-index",itemIndex))),r}render(){this.namespace.input&&this.attrs?.name&&$(this.namespace.input).attr(this.attrs)}},ft=i=>class extends Vt(nt(i||HTMLElement)){},ut=i=>class extends Vt(It(i||HTMLElement)){},mt=i=>class extends Ce(Wt(i||HTMLElement)){constructor(){super(),this.addEventListener("change",e=>{this.namespace.dropArea&&this.populate(Array.from(e.target.files).map(t=>({file:t})),1)}),this._handlerDrag=e=>{e.type==="dragover"||e.type==="dragenter"?this.state&&(this.state.dragging=!0):(e.type==="dragleave"||e.type==="dragend"||e.type==="drop")&&(e.preventDefault(),this.state&&(this.state.dragging=!1),e.type==="drop"&&this.populate(Array.from(e.dataTransfer.files).map(t=>({file:t}))))},y.observe(this.filesList,e=>{if(e[0].name==="length"||!this.namespace.input)return;let t=new DataTransfer;this.filesList.map(r=>r.file).filter(r=>!M(r)).forEach(r=>{t.items.add(r)}),this.namespace.input.files=t.files,this.schema.isRequired&&(!this.namespace.input.files.length&&this.filesList.length&&this.filesList[0]?this.namespace.input.removeAttribute("required"):this.namespace.input.setAttribute("required",!0))})}connectedCallback(){super.connectedCallback(),this.namespace.dropArea&&["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(e=>{this.namespace.dropArea.removeEventListener(e,this._handlerDrag),this.namespace.dropArea.addEventListener(e,this._handlerDrag)})}define(e,t=null){super.define(...arguments),this.render()}deriveFileEntry(e,t,r=null){if(!!this.template){var s=Reflect.ownKeys(this.template.exports).map(n=>this.template.exports[n][0]).reduce((n,o)=>{if(n)return n;let a=o.hasAttribute("is")?customElements.get(o.getAttribute("is")):customElements.get(o.localName);return a&&a.testFile(e)?o:null},null);if(s){if(s=s.cloneNode(!0),s.file=e._file||e.file,M(e.file)){let n=document.createElement("input");n.setAttribute("name",this.attrs.name),n.setAttribute("value",e.file),n.setAttribute("type","hidden"),s.append(n),s.setAttribute("data-src",e.file),L(m(r),[1,2]).length===2&&!this.schema.remoteDelete&&s.setAttribute("data-isdefault","true")}this.namespace.preview?this.namespace.preview.append(s):this.append(s);try{s.previewFile(e.file,this)}catch(n){console.warn("Error calling element.previewFile();",n,this)}}return s}}render(){this.namespace.input&&(this.attrs?.type||this.attrs?.name)&&$(this.namespace.input).attr(this.attrs)}},zt=i=>class extends(i||HTMLElement){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,(e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then(r=>{$(this).attr("data-deleting",!1),this.ownerWidget.populate([],[1,2])}))})}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}static testFile(e){return!0}async previewFile(e,t){if(this.ownerWidget=t,M(e)){let h=await fetch(e),u=h.ok?await h.blob():"";e=new File([u],e.split("/").pop(),{type:h.headers.get("content-type")||"application/octet-stream"})}if(!e.name)return;var r=`${e.name}: ${e.size?e.size/1024:e.size}KB`,s=h=>{try{return window.URL.createObjectURL(h)}catch{return""}},n=h=>window.URL.revokeObjectURL(h.src);if(/^image\//.test(e.type)){var o=document.createElement("img");o.onload=h=>{n(o)},o.src=s(e),this.append(o);return}if(/^video\//.test(e.type)){var a=document.createElement("video");a.onloadstart=h=>{n(a),a.play()},a.src=s(e),a.muted=!0,this.append(a);return}let f=document.createElement("i");f.classList.add("bi");var l="file";/^audio\//.test(e.type)?l="music":/msword|ms-word|wordprocessing/.test(e.type)?l="word":/powerpoint|presentation/.test(e.type)?l="powerpoint":/excel|spreadsheet/.test(e.type)?l="excel":/^text\//.test(e.type)?l="text":/\/pdf/.test(e.type)?l="pdf":/\/zip/.test(e.type)&&(l="zip"),f.classList.add("bi-file-"+l),this.append(f)}},qe=i=>class extends Ce(i){json(e=null){if(arguments.length){this.namespace.input.value=e;return}return this.namespace.input.value}render(){this.namespace.input&&(this.attrs?.type||this.attrs?.name)&&$(this.namespace.input).attr(this.attrs)}},ct=i=>class extends qe(jt(i||HTMLElement)){},pt=i=>class extends qe(Ct(i||HTMLElement)){},ht=i=>class extends qe(Dt(i||HTMLElement)){},dt=i=>class extends qe(qt(i||HTMLElement)){json(e=null){if(arguments.length){this.namespace.input.checked=e===!0||e+""===this.namespace.input.value;return}return this.namespace.input.checked?this.namespace.input.value:null}},W=i=>class extends $t(i||HTMLElement){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,(e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then(r=>{$(this).attr("data-deleting",!1)}))})}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}};var{SubscriptElement:E}=WebQit.OOHTML,mr=class extends De(E(HTMLFormElement)){};customElements.define("playui-form-widget",mr,{extends:"form"});var cr=class extends De(E(HTMLFieldSetElement)){},pr=class extends at(E(HTMLFieldSetElement)){},hr=class extends lt(E(HTMLFieldSetElement)){},dr=class extends ft(E(HTMLDivElement)){},gr=class extends ut(E(HTMLDivElement)){},_r=class extends mt(E(HTMLDivElement)){},vr=class extends ct(E(HTMLDivElement)){},xr=class extends pt(E(HTMLDivElement)){},yr=class extends ht(E(HTMLDivElement)){},br=class extends dt(E(HTMLDivElement)){};customElements.define("playui-collection-widget",cr,{extends:"fieldset"});customElements.define("playui-multiple-widget",pr,{extends:"fieldset"});customElements.define("playui-multiple2-widget",hr,{extends:"fieldset"});customElements.define("playui-enum-widget",dr,{extends:"div"});customElements.define("playui-enum2-widget",gr,{extends:"div"});customElements.define("playui-file-widget",_r,{extends:"div"});customElements.define("playui-editor-widget",vr,{extends:"div"});customElements.define("playui-text-widget",xr,{extends:"div"});customElements.define("playui-number-widget",yr,{extends:"div"});customElements.define("playui-state-widget",br,{extends:"div"});var Er=class extends W(De(E(HTMLFieldSetElement))){},Or=class extends W(at(E(HTMLFieldSetElement))){},wr=class extends W(lt(E(HTMLFieldSetElement))){},Tr=class extends W(ft(E(HTMLDivElement))){},Lr=class extends W(ut(E(HTMLDivElement))){},Fr=class extends W(mt(E(HTMLDivElement))){},Pr=class extends W(ct(E(HTMLDivElement))){},Ar=class extends W(pt(E(HTMLDivElement))){},Mr=class extends W(ht(E(HTMLDivElement))){},Nr=class extends W(dt(E(HTMLDivElement))){};customElements.define("playui-collection-itemscope-widget",Er,{extends:"fieldset"});customElements.define("playui-multiple-itemscope-widget",Or,{extends:"fieldset"});customElements.define("playui-multiple2-itemscope-widget",wr,{extends:"fieldset"});customElements.define("playui-enum-itemscope-widget",Tr,{extends:"div"});customElements.define("playui-enum2-itemscope-widget",Lr,{extends:"div"});customElements.define("playui-file-itemscope-widget",Fr,{extends:"div"});customElements.define("playui-editor-itemscope-widget",Pr,{extends:"div"});customElements.define("playui-text-itemscope-widget",Ar,{extends:"div"});customElements.define("playui-number-itemscope-widget",Mr,{extends:"div"});customElements.define("playui-state-itemscope-widget",Nr,{extends:"div"});var Rr=class extends zt(HTMLDivElement){};customElements.define("playui-file-preview",Rr,{extends:"div"});})();
//# sourceMappingURL=main.js.map
