!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var i={};s.r(i),s.d(i,"_Schema",(function(){return Ee})),s.d(i,"_ObjectOrArray",(function(){return we})),s.d(i,"_Object",(function(){return je})),s.d(i,"_Array",(function(){return Le})),s.d(i,"_String",(function(){return Oe})),s.d(i,"_Num",(function(){return Me})),s.d(i,"_Number",(function(){return Re})),s.d(i,"_Integer",(function(){return Te})),s.d(i,"_Boolean",(function(){return _e})),s.d(i,"_Null",(function(){return Pe}));var n=function(e){return!Array.isArray(e)&&"object"==typeof e&&e},r=function(e){return typeof e};function a(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var s,i,n=globalThis.WebQitInternalsRegistry.get(e);if(!n){if(n=new Map,!1===t[0])return n;globalThis.WebQitInternalsRegistry.set(e,n)}for(;s=t.shift();)if((i=n)&&!(n=n.get(s))){if(n=new Map,!1===t[0])return n;i.set(s,n)}return n}var l=function(e){return Array.isArray(e)},c=function(e){return!0===e||!1===e},o=function(e){return"function"==typeof e},h=function(e){return null===e||""===e},u=function(e){return arguments.length&&(void 0===e||void 0===e)},d=function(e){return Array.isArray(e)||"object"==typeof e&&e||o(e)},m=function(e){return h(e)||u(e)||!1===e||0===e||d(e)&&!Object.keys(e).length},p=function(e){return o(e)||e&&"[object function]"==={}.toString.call(e)},f=function(e){return e instanceof Number||"number"==typeof e},v=function(e){return f(e)||!0!==e&&!1!==e&&null!==e&&""!==e&&!isNaN(1*e)},g=function(e){return e instanceof String||"string"==typeof e&&null!==e},y=function(e,t=1){var s=0;e.forEach(e=>{s++});var i=e.slice(e.length-s,t);return arguments.length>1?i:i[0]},b=function(e,t=1){return arguments.length>1?y(e.slice().reverse(),t).reverse():y(e.slice().reverse())},x=function(e,...t){return t.forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e},E=function(e,t){var s=[];return function(e,t){t=(t=t||Object.prototype)&&!l(t)?[t]:t;var s=[];for(e=e;e&&(!t||t.indexOf(e)<0)&&"default"!==e.name;)s.push(e),e=e?Object.getPrototypeOf(e):null;return s}(e,t).forEach(e=>{x(s,...Object.getOwnPropertyNames(e))}),s};function w(e,t,s=!1,i=!1,r=!1){var a=0,c=e.shift();if((v(c)||!0===c||!1===c)&&(a=c,c=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((e,o)=>{(d(e)||p(e))&&(s?E(e):Object.getOwnPropertyNames(e)).forEach(h=>{if(t(h,c,e,o)){var u=c[h],d=e[h];if((l(u)&&l(d)||n(u)&&n(d))&&(!0===a||a>0))c[h]=l(u)&&l(d)?[]:{},w([v(a)?a-1:a,c[h],u,d],t,s,i,r);else if(l(c)&&l(e))i?c[h]=d:c.push(d);else try{r?Object.defineProperty(c,h,Object.getOwnPropertyDescriptor(e,h)):c[h]=e[h]}catch(e){}}})}),c}var j=function(e,t){var s=void 0;return d(e)&&Object.keys(e).forEach((i,n)=>{!1!==s&&(s=t(v(i)?parseFloat(i):i,e[i],n))}),s};new Map;var L=function(...e){return w(e,(e,t,s)=>!0,!1,!1,!1)};function O(e,t,s=null,i=!1){return t.length>e.length?-1:("number"==typeof s?i?e.slice(0,s+1+(s<0?e.length:0)):e.slice(s):e).reduce((e,s,n)=>{var[r,a,l]=e;if(!i&&r>-1)return[r,a,l];var c=l+1,o=s===t[c]?0===c?[n,0]:[a,c]:[-1,-1];return o[1]===t.length-1&&(o[1]=-1,o[0]>-1)?[o[0]].concat(o):[r].concat(o)},[-1,-1,-1])[0]+(i||"number"!=typeof s?0:s>-1?s:e.length-s)}function M(e,t,s=null,i=!1){var n=O(e,t,s,i);return-1===n?[]:e.slice(n+t.length)}var R=function(e,t=!0){return l(e)?e:!t&&n(e)?[e]:!1!==e&&0!==e&&m(e)?[]:function(e){return!g(e)&&!u(e.length)}(e)?Array.prototype.slice.call(e):n(e)?Object.values(e):[e]},T=function(e,t,s=null){return l(t)?e.filter(e=>s?t.filter(t=>s(e,t)).length:-1===t.indexOf(e)):[]};function _(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?e.join(".")===t.join("."):e.length===t.length&&e.reduce((e,s,i)=>e&&s===t[i],!0)}var P=function(e,t,s=null){return l(t)?e.filter(e=>s?t.filter(t=>s(e,t)).length:-1!==t.indexOf(e)):[]};function N(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?(e.join(".")+".").startsWith(t.join(".")+"."):t.reduce((t,s,i)=>t&&s===e[i],!0)}var S=function(e){return e.filter((e,t,s)=>s.indexOf(e)===t)};function A(e){return(F(e)?e:R(e).length?[e]:[]).reduce((e,t)=>e.concat([R(t)]),[]).map(e=>k.resolve(e))}class k extends Array{static resolve(e){return e.every(e=>!(e+"").includes("."))?(new k).concat(e):e}get dotSafe(){return!0}}function F(e){return R(e).reduce((e,t)=>e||l(t),!1)}function D(e){return e.filter(e=>e||0===e).length!==e.length}class I{constructor(e){this.target=e,this.fireables=[],this.currentlyFiring=[]}add(e){return this.fireables.push(e),e}remove(e){this.fireables=this.fireables.filter(t=>t!==e)}removeMatches(e){this.match(e).forEach(e=>{this.fireables=this.fireables.filter(t=>t!==e)})}match(e){return this.fireables.filter(t=>{var s=A(t.filter),i=R((t.params||{}).tags),n=A(e.filter),r=R((e.params||{}).tags);return(!e.originalHandler||t.handler===e.originalHandler)&&(!n.length||_(n,s))&&(!r.length||r.length===i.length&&P(i,r).length===r.length)})}static _getFirebase(e,t,s=!0,i=this.__namespace){if(!d(t))throw new Error('Subject must be of type object; "'+r(t)+'" given!');var n=this;return i&&globalThis.WebQitObserverNamespaceRegistry.has(e+"-"+i)&&(n=globalThis.WebQitObserverNamespaceRegistry.get(e+"-"+i),e+="-"+i),!a(t,"firebases").has(e)&&s&&a(t,"firebases").set(e,new n(t)),a(t,"firebases").get(e)}static _namespace(e,t,s=null){if(e+="-"+t,2===arguments.length)return globalThis.WebQitObserverNamespaceRegistry.get(e);if(!(s.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${t} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(e,s),s.__namespace=t}}globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);class H{constructor(e,t){this.target=e,this.handler=t.handler,this.filter=t.filter,this.params=t.params}disconnect(){this.disconnected=!0}}class q extends H{fire(e,t,s){return this.disconnected||this.filter&&!P(R(this.filter),[e.type]).length?t(...Array.prototype.slice.call(arguments,2)):this.handler(e,s,t)}}class C{constructor(e,t){if(this.target=e,!t.type)throw new Error("Action type must be given in definition!");j(t,(e,t)=>{Object.defineProperty(this,e,{value:t,enumerable:!0})}),Object.seal(this)}}class V extends I{add(e){return super.add(new q(this.target,e))}fire(e,t=null){if(e instanceof C||(e=new C(this.target,e)),this.currentlyFiring.filter(t=>t.type===e.type&&t.name===e.name).length)return t?t():void 0;this.currentlyFiring.push(e);const s=(i,...n)=>{var r=this.fireables[i];return r?r.fire(e,(...e)=>s(i+1,...e),...n):t?t(...n):n[0]};var i=s(0);return this.currentlyFiring.pop(),i}static getFirebase(e,t=!0,s=null){return super._getFirebase("interceptor",...arguments)}static namespace(e,t=null){return super._namespace("interceptor",...arguments)}}var W=function(e){return a(e,!1).get(e)||e},U=function(e,t,s={},i={}){if(!t||!d(t))throw new Error("Target must be of type object!");t=W(t);var n,r=function(i){return arguments.length?i:Reflect[e](t,...Object.values(s))};return(n=V.getFirebase(t,!1,i.namespace))?n.fire({type:e,...s},r):r()},z=function(e,t,s,i={}){return U("apply",e,{thisArgument:t,argumentsList:s},i)},B=function(e,t,s=null,i={}){return U("construct",e,arguments.length>2?{argumentsList:t,newTarget:s}:{argumentsList:t},i)},Q=function(e,t){return"string"!=typeof e?e:e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+(void 0!==typeof t&&t?e.substr(1).toLowerCase():e.substr(1))}))};class K{constructor(e,t=!1){this._={},this._.target=e,this._.cancellable=t,this._.propagationStopped=!1,this._.defaultPrevented=!1,this._.promisesInstance=null,this._.promises=[]}get target(){return this._.target}get cancellable(){return this._.cancellable}stopPropagation(){this._.propagationStopped=!0}get propagationStopped(){return this._.propagationStopped}preventDefault(){this._.defaultPrevented=!0}get defaultPrevented(){return this._.defaultPrevented}waitUntil(e){e instanceof Promise&&(this._.promises.push(e),this._.promisesInstance=null)}get promises(){return!this._.promisesInstance&&this._.promises.length&&(this._.promisesInstance=Promise.all(this._.promises)),this._.promisesInstance}respondWith(e){var t,s=n(e)&&!u(e.propagationStopped)&&!u(e.defaultPrevented);!1===e||s&&e.propagationStopped?this.stopPropagation():!1===e||s&&e.defaultPrevented?this.preventDefault():(e instanceof Promise&&(t=e)||s&&(t=e.promises))&&this.waitUntil(t)}}class J extends H{constructor(e,t){if(super(e,t),this.filters2D=A(this.filter),this.filtersIsOriginally2D=F(this.filter),this.filtersIsDynamic=this.filters2D.filter(e=>D(R(e))).length>0,this.filtersIsDynamic&&this.filters2D.length>1)throw new Error('Only one "Dynamic Filter" must be observed at a time! "'+this.filters2D.map(e=>"["+e.join(", ")+"]").join(", ")+'" have been bound together.')}fire(e){if(this.disconnected||this.params.type&&(t=e=>this.params.type===e.type,!e.reduce((e,s,i)=>e||t(s,i),!1)))return;var t;const s=e=>!["set","def"].includes(e.type)||!this.params.diff||(p(this.params.diff)?this.params.diff(e.value,e.oldValue):e.value!==e.oldValue);var i=new K(this.target);if(this.filters2D.length){var r=e.filter(e=>this.filters2D.filter((t,i)=>{var n=t.slice();return this.filtersIsDynamic&&e.path.forEach((e,t)=>{n[t]=n[t]||0===n[t]?n[t]:e}),(!this.filtersIsDynamic||!D(n))&&s(e)&&(!this.params.subtree&&_(n,e.path)||this.params.suptree&&N(n,e.path)&&(!v(this.params.suptree)||M(n,e.path).length<=this.params.suptree)||this.params.subtree&&e.path.length>=n.length&&N(e.path,n)&&(!v(this.params.subtree)||M(e.path,n).length<=this.params.subtree))}).length);if(r.length)if(this.filtersIsOriginally2D||this.params.subtree){var a=r;n(this.filter)&&(a={...this.filter},r.forEach((e,t)=>{a[e.name]=e})),i.respondWith(this.handler(a,i))}else r.forEach((e,t)=>{i.respondWith(this.handler(e,i))})}else(this.params.subtree||e.filter(e=>_(e.path,[e.name])).length===e.length)&&e.filter(e=>s(e)).length&&i.respondWith(this.handler(e,i));return i}}class G{constructor(e,t){if(this.target=e,t.originalSubject||(this.originalSubject=e),!("type"in t))throw new Error("Mutation type must be given in definition!");if(!("name"in t))throw new Error("Property name must be given in definition!");j(t,(e,t)=>{"path"===e&&(t=k.resolve(t)),Object.defineProperty(this,e,{value:t,enumerable:!0})}),this.path||Object.defineProperty(this,"path",{value:k.resolve([t.name]),enumerable:!0}),Object.seal(this)}}class X extends I{constructor(e){super(e),this.buffers=[]}add(e){return super.add(new J(this.target,e))}fire(e,t){var s=new K(this.target,t);return e=R(e,!1).map(e=>e instanceof G?e:new G(this.target,e)),this.buffers.length?(b(this.buffers)(e),s):(this.currentlyFiring.filter(t=>e.filter(e=>t.type===e.type&&t.name===e.name).length).length,this.fireables.forEach(i=>{if(s.propagationStopped&&t)return s;s.respondWith(i.fire(e))}),s)}static getFirebase(e,t=!0,s=null){return super._getFirebase("observer",...arguments)}static namespace(e,t=null){return super._namespace("observer",...arguments)}}var Y=function(e,t,s=null,i={}){if(!(e=s||e)||!d(e))throw new Error("Target must be of type object!");e=W(e);var n=R(t),r=n.map(t=>{var r,l=function(i){return arguments.length?i:a(e,"accessorizedProps").has(t)&&a(e,"accessorizedProps").get(t).touch(!0)?a(e,"accessorizedProps").get(t).get():s?Reflect.get(e,t,s):Reflect.get(e,t)};return(r=V.getFirebase(e,!0,i.namespace))?r.fire({type:"get",name:t,related:n,receiver:s},l):l()});return l(t)?r:r[0]},Z=function(e,t,s=null,i={}){if(!(e=W(e))||!d(e))throw new Error('Observable subjects must be of type object; "'+r(e)+'" given!');if(p(t)&&(i=arguments.length>2?s:{},s=t,t=null),!p(s))throw new Error('Handler must be a function; "'+r(s)+'" given!');var n,a=X.getFirebase(e,!0,i.namespace),l={filter:t,handler:s,params:i};if((l.filter||"*"===l.params.subtree||l.params.subtree&&ie(e))&&se(e,l.filter,l.params.subtree,i.namespace),l.params.unique&&(n=a.match({filter:t,params:i})).length){if("replace"!==l.params.unique)return n[0];a.remove(n[0])}return a.add(l)},ee=function(e,t,s,i=null,r={}){var a;if(e!==s&&(Z(s,(s,i)=>{if(a=X.getFirebase(e,!1,r.namespace)){var n=s.map(s=>{var i=s;do{if(i.target===e)return}while(i=i.src);var n={};return j(s,(e,t)=>{"target"!==e&&"name"!==e&&"path"!==e&&"src"!==e&&(n[e]=t)}),n.name=t,n.path=[t].concat(s.path),n.originalSubject=s.originalSubject,n.src=s,new G(e,n)}).filter(e=>e);if(n.length)return a.fire(n,i.cancellable)}},{subtree:!0,...r,unique:!0,tags:[te,t,e]}),n(i)&&(a=X.getFirebase(e,!1,r.namespace)))){var l=L({name:t,type:"set",value:s,related:[t]},i);let e=a.fire(l,r.cancellable);if(r.eventTypeReturn)return e}};const te={};function se(e,t=null,s=!1,i=null){if(!e||!d(e))throw new Error("Target must be of type object!");var n=X.getFirebase(e,!0,i);if(n&&!n.build){n.build=s;var r=A(t),a=!r.length||r.filter(e=>!e[0]&&0!==e[0]).length?Object.keys(e):r.map(e=>e[0]),l=r.length?r.map(e=>e.slice(1)).filter(e=>e.length):null;n.subBuild=l&&l.length?l:null,a.forEach(t=>{var r=Y(e,t,null,{namespace:i});try{d(r)&&(ee(e,t,r,null,params),(n.subBuild&&ie(r)||(_isFunction(s)?s(r):s&&ie(r)))&&se(r,n.subBuild,s,i))}catch(e){}})}}const ie=e=>(e instanceof Object||e instanceof Array||e instanceof Function)&&("undefined"==typeof window||e!==window);var ne=function(e,t,s=null,i={}){if(!(e=W(e))||!d(e))throw new Error('Observable subjects must be of type object; "'+r(e)+'" given!');if(p(t)&&(i=arguments.length>2?s:{},s=t,t=null),s&&!p(s))throw new Error('Handler must be a function; "'+r(s)+'" given!');var n;if(n=X.getFirebase(e,!1,i.namespace))return n.removeMatches({filter:t,originalHandler:s,params:i})},re=function(e,t,s,i=null,r={}){var a;if(ne(s,null,null,{...r,tags:[te,t,e]}),n(i)&&(a=X.getFirebase(e,!1,r.namespace))){var l=L({name:t,type:"del",oldValue:s,related:[t]},i);a.fire(l,r.cancellable)}},ae=function(e,t,s={}){return U("has",e,{name:t},s)},le=function(e,t,s,i={}){t=s.receiver||t;var r=s.keysOrPayload,c=s.value;if(!t||!d(t))throw new Error("Target must be of type object!");n(r)&&(i=c||{},c=null),t=W(t);var o=V.getFirebase(t,!1,i.namespace),h=X.getFirebase(t,!1,i.namespace);const u=(n,r,l,c)=>{var u,m="set";e&&(m="defineProperty",r=(u=r||{}).value);var p,f=!1;ae(t,n,i)&&(f=!0,p=Y(t,n,s.receiver,i));var v={name:n,type:m,value:r,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p},g=function(e){return arguments.length&&(u?u=e:r=e),u?!(a(t,"accessorizedProps",!1).has(n)&&!a(t,"accessorizedProps").get(n).restore())&&(Object.defineProperty(t,n,u),!0):a(t,"accessorizedProps",!1).has(n)?a(t,"accessorizedProps").get(n).set(r):(t[n]=r,!0)};if(o){var y=u?{type:"defineProperty",name:n,descriptor:u,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p}:{type:"set",name:n,value:r,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p};v.success=o.fire(y,g)}else v.success=g();return v.success&&v.value!==v.oldValue&&(d(v.oldValue)&&re(t,n,v.oldValue,null,i),d(v.value)&&(ee(t,n,v.value,null,i),h&&(h.subBuild||h.build&&ie(v.value))&&se(v.value,h.subBuild,h.build,i.namespace))),v};var m,p=[];l(r)||(g(r)||f(r))&&(m=R(r))?p=m.map(e=>u(e,c,m,i.detail)):n(r)&&(m=Object.keys(r))&&(p=m.map(e=>u(e,r[e],m,i.detail)));var v,y=p.filter(e=>!1!==e.success);return h?(v=h.fire(y,i.cancellable)).successCount=y.length:i.eventTypeReturn&&(v=new K(t)),i.eventTypeReturn?v:y.length>0},ce=function(e,t,s=null,i={}){return le(!0,e,{keysOrPayload:t,value:s},i)},oe=function(e,t,s={}){if(!e||!d(e))throw new Error("Target must be of type object!");e=W(e);var i,n,r=R(t),l=r.map(t=>{var i;ae(e,t,s)&&(i=Y(e,t,null,s));var n,l={name:t,type:"deleteProperty",related:r,detail:s.detail,oldValue:i},c=function(s){return arguments.length?s:!(a(e,"accessorizedProps",!1).has(t)&&!a(e,"accessorizedProps").get(t).restore())&&(delete e[t],!0)};return(n=V.getFirebase(e,!1,s.namespace))?l.success=n.fire({type:"deleteProperty",name:t,oldValue:i,related:r},c):l.success=c(),l.success&&d(l.oldValue)&&re(e,t,l.oldValue,null,s),l}).filter(e=>!1!==e.success);return(i=X.getFirebase(e,!1,s.namespace))?(n=i.fire(l,s.cancellable)).successCount=l.length:s.eventTypeReturn&&(n=new K(e)),s.eventTypeReturn?n:l.length>0},he=function(e,t,s={}){return U("getOwnPropertyDescriptor",e,{name:t},s)},ue=function(e,t={}){return U("getPrototypeOf",e,{},t)},de=function(e,t={}){return U("isExtensible",e,{},t)},me=function(e,t={}){return U("ownKeys",e,{},t)},pe=function(e,t={}){return U("preventExtensions",e,{},t)},fe=function(e,t,s=null,i=null,n={}){return le(!1,e,arguments.length>3?{keysOrPayload:t,value:s,receiver:i}:{keysOrPayload:t,value:s},n)},ve=function(e,t,s={}){return U("setPrototypeOf",e,{prototype:t},s)},ge=fe,ye=function(e,t={}){if(!d(e))throw new Error('Object must be of type target; "'+r(e)+'" given!');var s=new Proxy(e,{apply:(e,s,i)=>z(e,s,i,t),construct:(e,s,i=null)=>B(e,s,i,t),defineProperty:(e,s,i)=>ce(e,s,i,t),deleteProperty:(e,s)=>oe(e,s,t),get:(e,i,n=null)=>{var r=Y(e,i,n,t);return!1!==t.proxyAutoBinding&&p(r)&&!function(e){return o(e)&&/^class\s?/.test(Function.prototype.toString.call(e))}(r)?r.bind(s):r},getOwnPropertyDescriptor:(e,s)=>he(e,s,t),getPrototypeOf:e=>ue(e,t),has:(e,s)=>ae(e,s,t),isExtensible:e=>de(e,t),ownKeys:e=>me(e,t),preventExtensions:e=>pe(e,t),set:(e,s,i,n=null)=>fe(e,s,i,n,t),setPrototypeOf:(e,s)=>ve(e,s,t)});return a(s).set(s,e),s},be=Z;const xe=e=>e&&(e.startsWith("text/")||"application/rtf"===e||"application/xml"===e||"application/xhtml+xml"===e||"application/json"===e),Ee=e=>class extends(e||class{}){constructor(e){super(e),Object.keys(e).forEach(t=>{Object.defineProperty(this,t,{value:e[t]})})}validate(e){return super.validate?super.validate(e):{valid:!0}}},we=e=>class extends(Ee(e)){validate(e){var t=super.validate(e);return t.valid?(t=this._validateMin(e)).valid?(t=this._validateMax(e)).valid?t:{valid:!1,error:t.error||`Maximum number of entries exceeded by: ${t.violation}.`}:{valid:!1,error:t.error||`Minimum number of entries short of: ${t.violation}.`}:t}},je=e=>class extends(we(e)){getPropertyNameSchema(e=null){var t=this.propertyNames||{type:"string"};return!1===this.additionalProperties&&(t.error="Additional properties not allowed."),t.isRequired=!0,t}getPropertySchema(e,t=null){var s;if(this.properties&&(s=this.properties[e])||(s=this._patternPropertiesMatch(e))||(s=this.additionalProperties)||!1===s||(s={}),s){if((this.required||[]).includes(e)&&(s.isRequired=!0),t){const r=Object.keys(t);var i,n;!s.isRequired&&(i=P(this.dependentRequired||[],r).reduce((t,s)=>t||this.dependentRequired[s].includes(e)?s:null,null))&&(s.isRequired=i),(r.includes(e)||(n=this._validateMax(t)).valid)&&0!==n.violation||(s.error="This additional entry will violate the maximum number of entries allowed.")}return{...s,name:e}}}_patternPropertiesMatch(e){return Object.keys(this.patternProperties||{}).reduce((t,s)=>t||(new RegExp(s).test(e)?this.patternProperties[s]:void 0),null)}validate(e){var t=super.validate(e);return t.valid?(t=this._validateRequired(e)).valid?(t=this._validateDependentRequired(e)).valid?t:{valid:!1,error:t.error||`Entries associated with "${t.master}" still empty: ${t.violation.join(", ")}.`}:{valid:!1,error:t.error||`Required entries still empty: ${t.violation.join(", ")}.`}:t}_validateMax(e){if(!this.maxProperties)return{valid:!0};const t=Object.keys(e).length-this.maxProperties;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minProperties)return{valid:!0};const t=Object.keys(e),s=this.minProperties-t.length;return{valid:s<=0,violation:s}}_validateRequired(e){if(!this.required)return{valid:!0};const t=Object.keys(e),s=T(this.required,t);return{valid:0===s.length,violation:s}}_validateDependentRequired(e){if(!this.dependentRequired)return{valid:!0};const t=Object.keys(e),[s,i]=Object.keys(this.dependentRequired).reduce((e,s)=>{if(e)return e;if(t.includes(s)){const e=T(this.dependentRequired[s],t);if(e.length)return[s,e]}},null)||[];return{valid:!s,master:s,violation:i}}},Le=e=>class extends(we(e)){getItemSchema(e,t=null){var s;if(this.prefixItems&&(s=this.prefixItems[e])||(s=this.items)||!1===s||(s={}),s){var i;if(t)(e in t||(i=this._validateMax(t)).valid)&&0!==i.violation||(s.error="This additional entry will violate the maximum number of entries allowed.");return{...s,name:e}}}validate(e){var t=super.validate(e);return t.valid?(t=this._validateUnique(e)).valid?(t=this._validateContains(e)).valid?t:{valid:!1,error:t.error||`Entries must contain ${t.min>0?`at least ${t.min} `+(t.max>1?"and ":""):""} ${t.max>1?`at most ${t.max} `:""}of ${t.desc}.`}:{valid:!1,error:t.error||"Entries must be unique"}:t}_validateMax(e){if(!this.maxItems)return{valid:!0};const t=e.length-this.maxItems;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minItems)return{valid:!0};const t=this.minItems-e.length;return{valid:t<=0,violation:t}}_validateUnique(e){return this.uniqueItems?{valid:S(e).length===e.length}:{valid:!0}}_validateContains(e){if(!this.contains)return{valid:!0};const t=e.filter(e=>this.__validateContains(this.contains,e));return t.length<(this.minContains||1)||this.maxContains&&t.length>this.maxContains?{valid:!1,min:this.minContains||1,max:this.maxContains,desc:desc}:{valid:!0}}},Oe=e=>class extends(Ee(e)){validate(e){var t=super.validate(e);return t.valid?{valid:g(e)}:t}},Me=e=>class extends(Ee(e)){validate(e){var t=super.validate(e);return t.valid,t}},Re=e=>class extends(Me(e)){validate(e){var t=super.validate(e);return t.valid?{valid:v(e)}:t}},Te=e=>class extends(Me(e)){validate(e){var t=super.validate(e);return t.valid?{valid:Number.isInteger(e)}:t}},_e=e=>class extends(Ee(e)){validate(e){var t=super.validate(e);return t.valid?{valid:c(e)}:t}},Pe=e=>class extends(Ee(e)){validate(e){var t=super.validate(e);return t.valid?{valid:h(e)}:t}},Ne=e=>class extends(e||class{}){constructor(){super(),this.nodeRemovalListeners=new Map}execNodeRemoval(e){p(e.remove)&&e.remove()}onNodeRemoval(e,t){var s=this.nodeRemovalListeners.get(e);s||(s=[],this.nodeRemovalListeners.set(e,s)),s.push(t)}async remoteAction(e,t,s={}){return{}}static getSchemaName(e){return e=R(e||"string"),[["object","_Object"],["array","_Array"],["string","_String"],["number","_Number"],["integer","_Integer"],["boolean","_Boolean"],["null","_Null"]].reduce((t,s)=>t||(e.includes(s[0])?s[1]:null),null)}define(e,t=null){ge(this,"schema",ye(e)),ge(this,"ownerWidget",t),ge(this,"attrs",ye({name:this.ownerWidget&&this.ownerWidget.attrs.name?`${this.ownerWidget.attrs.name}[${this.schema.name}]`:this.schema.name})),this.state||ge(this,"state",ye({})),this.schema.title||(this.schema.title=Q(((this.schema.name||"")+"").replaceAll("_"," "))),this.schema.isRequired&&(this.attrs.required=!0),u(this.schema.const)&&u(this.schema.default)||(this.attrs.value=u(this.schema.const)?this.schema.default:this.schema.const),!this.schema.readOnly&&u(this.schema.const)||(this.attrs.readonly=!0)}alert(e=null){return arguments.length&&(this.state.alert={message:e.message,type:e.type}),{...this.state.alert||{}}}json(){}set value(e){this.json(e)}get value(){return this.json()}},Se=e=>class extends(Ne(e)){deriveChildEntry(e,t){}},Ae=e=>class extends(Se(e)){constructor(){super(),ge(this,"childEntries",ye({})),be(this.childEntries,e=>{e.forEach(e=>{"set"===e.type&&(e.isUpdate&&e.oldValue&&this.execNodeRemoval(e.oldValue),e.value?p(this.onNodeRemoval)&&this.onNodeRemoval(e.value,()=>{this.childEntries[e.name]===e.value&&delete this.childEntries[e.name]}):console.warn(`No widget type defined for entry "${e.name}" of schema type "${R(this.schema.properties[e.name].type||"string").join(", ")}".`)),"deleteProperty"===e.type&&this.execNodeRemoval(e.oldValue)})})}static testSchema(e){return R(e.type).includes("object")}define(e,t=null){super.define(new(je())(e),t),Object.keys(this.childEntries).forEach(e=>{delete this.childEntries[e]}),Object.keys(this.schema.properties||{}).forEach(e=>{const t=this.schema.getPropertySchema(e);!1!==t.display&&(this.childEntries[e]=this.deriveChildEntry(t,e))})}extend(e,t=null){if(p(e)){const s=()=>{const i=this.schema.getPropertyNameSchema(this.json());e(i,e=>{i.validate(e)?extend(e,t):s()})};s()}else if(e){const s=this.json();this.childEntries[e]=this.deriveChildEntry(this.schema.getPropertySchema(e,s),e),t&&t(this.childEntries[e])}}json(e={},t=!1){if(arguments.length){if(!n(e))throw new Error("Data must be a valid JSON object.");return void Object.keys(e).forEach(s=>{this.childEntries[s]?this.childEntries[s].json(e[s]):t&&this.extend(s,t=>{t.json(e[s])})})}const s={};return Object.keys(this.childEntries).forEach(e=>{s[e]=this.childEntries[e].json()}),s}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!n(e.details))throw new Error("Alert details must be a valid JSON object.");return void Object.keys(e.details||{}).forEach(s=>{this.childEntries[s]?this.childEntries[s].alert(e.details[s]):t&&this.extend(s,t=>{t.alert(e.details[s])})})}const s=super.alert();return s.details={},Object.keys(this.childEntries).forEach(e=>{s.details[e]=this.childEntries[e].alert()}),s}},ke=e=>class extends(Se(e)){constructor(){super(),ge(this,"childEntries",ye([])),be(this.childEntries,e=>{e.forEach(e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.childEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),e.value?p(this.onNodeRemoval)&&this.onNodeRemoval(e.value,()=>{const t=this.childEntries.indexOf(e.value);t>-1&&this.childEntries.splice(t,1)}):console.warn(`No widget type defined for entry "${e.name}" of schema type "${R(e.value.type||"string").join(", ")}".`)),"deleteProperty"===e.type&&-1===this.childEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))})})}static testSchema(e){return R(e.type).includes("array")}define(e,t=null){super.define(new(Le())(e),t),this.childEntries.splice(0),m(this.schema.prefixItems)||this.schema.prefixItems.forEach((e,t)=>{this.childEntries.push(this.deriveChildEntry(e,t))}),!0===this.schema.autoExtend&&this.extend()}extend(e=null){const t=this.json(),s=t.length,i=this.deriveChildEntry(this.schema.getItemSchema(s,t),s);this.childEntries.push(i),e&&e(i)}execNodeRemoval(e,t=null){t||(t=(e,t)=>t());if(-1===this.childEntries.indexOf(e))return;const s=e.schema?v(e.schema.title)?"item "+(parseInt(e.schema.title)+1):e.schema.title:"item";if(this.schema.remoteDelete){var i=e.value;if(i&&!d(i)){var n=this.schema.remoteDelete.url.replace(/\{value\}/g,i);return void t(`Remove ${s} (and delete from your account)?`,()=>this.remoteAction(this.schema.remoteDelete.method||"delete",n).then(t=>(t.ok&&super.execNodeRemoval(e),t)))}}t(`Remove ${s}?`,async()=>{super.execNodeRemoval(e)})}json(e=[]){if(!arguments.length)return this.childEntries.filter(e=>e).map(e=>e.json());if(!l(e))throw new Error("Data must be a valid JSON array.");e.forEach((e,t)=>{this.childEntries[t]?this.childEntries[t].json(e):this.extend(t=>{t.json(e)})})}alert(e={},t=!1){if(arguments.length){if(super.alert(e),e.details&&!l(e.details)&&!Object.keys(e.details).every(e=>v(e)))throw new Error("Alert items must be a valid JSON array.");return void Object.keys(e.details).forEach(t=>{const s=e.details[t];this.childEntries[t]?this.childEntries[t].alert(s):this.extend(e=>{e.alert(s)})})}const s=super.alert();return s.details=this.childEntries.filter(e=>e).map(e=>e.alert()),s}},Fe=e=>class extends(ke(e)){static testSchema(e){if(super.testSchema(e)&&!e.enum){var t=[],s=this.lineContentLengthLimit||50;if(e.prefixItems){if(e.prefixItems.some(e=>!("const"in e)&&1!==(e.enum||[]).length||P(R(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s))return;t=e.prefixItems.map(e=>"const"in e?e.const:e.enum[0])}if(e.items){if(P(R(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum||[])}return!t.some(e=>d(e)||(e+"").length>s)}}define(e,t=null){super.define(...arguments),!1!==this.schema.autoExtend&&this.extend()}},De=e=>class extends(Ne(e)){constructor(){super(),ge(this,"enumEntries",ye([])),be(this.enumEntries,e=>{e.forEach(e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.enumEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),p(this.onNodeRemoval)&&this.onNodeRemoval(e.value,()=>{const t=this.enumEntries.indexOf(e.value);t>-1&&this.enumEntries.splice(t,1)})),"deleteProperty"===e.type&&-1===this.enumEntries.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))})})}static testSchema(e){return l(e.enum)||R(e.type).includes("array")&&(m(e.prefixItems)||e.prefixItems.every(e=>"const"in e||1===(e.enum||[]).length))&&(!1===e.items||l((e.items||{}).enum)&&e.uniqueItems)}define(e,t=null){const s=this.constructor.getSchemaName(e.type);this.enumEntries.splice(0),super.define(new(i[s]())(e),t);const r=(e,t)=>{const s=e.map((e,s)=>({value:e,label:(t||{})[s]}));this.enumerate(s,1)},a=e=>{this.enumFetching=this.remoteAction(e.method||"get",e.url,{headers:{accept:"application/json"}}).then(e=>e.ok?e.json():Promise.reject({message:e.statusText})).then(t=>{var s=l(t.data)?t.data.map(e=>n(e)?{value:"value"in e?e.value:e.id,label:"label"in e?e.label:e.title}:{value:e}):[];this.enumerate(s,e.url)})};if(this.schema.remoteFetch)a(this.schema.remoteFetch),be(this.schema,"remoteFetch",()=>{a(this.schema.remoteFetch)},{subtree:!0});else if(this.schema.enum)r(this.schema.enum,this.schema.enumNames),be(this.schema,[["enum"],["enumNames"]],()=>{r(this.schema.enum,this.schema.enumNames)});else if(R(this.schema.type||"string").includes("array")){const e=[];this.schema.prefixItems&&(e=this.schema.prefixItems.map(e=>"const"in e?{value:e.const,label:e.title}:{value:e.enum[0],label:e.title||(e.enumNames||[])[0]})),this.schema.items&&this.schema.items.enum.forEach((t,s)=>{e.push({value:t,label:(this.schema.items.enumNames||[])[s]})}),this.attrs.multiple=!0,this.attrs.name+="[]",e.forEach(e=>{e.selected=!0}),this.enumerate(e,2)}}deriveEnumEntry(e,t){}enumerate(e,t=null){R(this.schema.type).includes("null")&&(e=[{value:null,label:this.attrs.placeholder}].concat(e)),t&&(!0===t?this.enumEntries.splice(0):this.enumEntries.filter(e=>P(R(e.enumTag),R(t)).length).forEach(e=>{const t=this.enumEntries.indexOf(e);t>-1&&this.enumEntries.splice(t,1)})),this.enumEntries.push(...e.map((e,s)=>(e=this.deriveEnumEntry(e,s),t&&(e.enumTag=t),e)))}json(e=[]){if(arguments.length){if(!l(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}const t=()=>{this.enumEntries.forEach(t=>{t.selected=!1,e.forEach(e=>{t.value===e+""&&(t.selected=!0)})})};return void(this.enumFetching?this.enumFetching.then(t):t())}const t=this.enumEntries.filter(e=>e.selected).map(e=>e.value);return this.attrs.multiple?t:t[0]}},Ie=e=>class extends(De(e)){static testSchema(e){if(super.testSchema(e)){var t=[],s=this.lineContentLengthLimit||50;if(e.enum){if(P(R(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s)return;t=e.enum}else if(!e.remoteFetch){if(e.prefixItems){if(e.prefixItems.some(e=>P(R(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s))return;t=e.prefixItems.map(e=>"const"in e?e.const:e.enum[0])}if(e.items){if(P(R(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum)}}return!t.some(e=>d(e)||(e+"").length>s)}}},He=e=>class extends(Ne(e)){constructor(){super(),ge(this,"filesList",ye([])),ge(this,"fallbackFilesList",ye([])),be(this.filesList,e=>{e.forEach(e=>{"length"!==e.name&&("set"===e.type&&(e.isUpdate&&e.oldValue&&-1===this.filesList.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue),p(this.onNodeRemoval)&&this.onNodeRemoval(e.value,()=>{const t=this.filesList.indexOf(e.value);t>-1&&this.filesList.splice(t,1)})),"deleteProperty"===e.type&&-1===this.filesList.indexOf(e.oldValue)&&this.execNodeRemoval(e.oldValue))})})}static testSchema(e){const t=e=>{return R(e.type||"string").includes("string")&&("data-url"===(t=e).format||"base64"===t.contentEncoding||e.contentMediaType&&!xe(e.contentMediaType));var t};return t(e)||R(e.type).includes("array")&&e.uniqueItems&&m(e.prefixItems)&&t(e.items||{})}define(e,t=null){const s=R(e.type),i=s.includes("array")?Le():Oe();super.define(new i(e),t),this.filesList.splice(0),this.attrs.type="file",s.includes("array")&&(this.attrs.name+="[]",this.attrs.multiple=!0),(this.schema.contentMediaType||this.schema.items&&this.schema.items.contentMediaType)&&(this.attrs.accept=this.schema.contentMediaType||this.schema.items.contentMediaType)}deriveFileEntry(e,t){}populate(e,t=null){if(t&&(!0===t?this.filesList.splice(0):this.filesList.filter(e=>P(R(e.enumTag),R(t)).length).forEach(e=>{const t=this.filesList.indexOf(e);t>-1&&(t>-1&&2===P(R(e.enumTag),[1,2]).length&&this.fallbackFilesList.push(this.filesList[t]),this.filesList.splice(t,1))})),(!e||!e.length)&&(!this.filesList.length||!this.filesList[0])&&this.fallbackFilesList.length){const e=this.fallbackFilesList[0].enumTag;this.populate(this.fallbackFilesList.splice(0).map(e=>({file:e.file})),e)}this.filesList.push(...e.map((e,s)=>{var i=this.deriveFileEntry(e,s,t);return null!==t&&(i.enumTag=t),i}))}execNodeRemoval(e,t=null){t||(t=(e,t)=>t());if(this.schema.remoteDelete&&-1===this.fallbackFilesList.indexOf(e)){var s=e.file;if(s&&!d(s)){var i=this.schema.remoteDelete.url.replace(/\{value\}/g,s);return void t("Remove file (and delete from your account)?",()=>this.remoteAction(this.schema.remoteDelete.method||"delete",i).then(t=>(t.ok&&super.execNodeRemoval(e),t)))}}t("Remove file?",async()=>{super.execNodeRemoval(e)})}json(e=[]){if(arguments.length){if(!l(e)){if(this.attrs.multiple)throw new Error("Data must be a valid JSON array.");e=[e]}return void this.populate(e.filter(e=>e).map(e=>({file:e})),[1,2])}const t=this.filesList.filter(e=>n(e.file)).map(e=>e.file);return this.attrs.multiple?t:t[0]}},$e=e=>class extends(Ne(e)){define(e,t=null){super.define(...arguments),u(this.schema.default)&&!this.schema.examples||(this.attrs.placeholder="E.g.: "+(u(this.schema.default)?this.schema.examples[0]:this.schema.default)),("const"in this.schema||1===(this.schema.enum||[]).length)&&(this.attrs.value="const"in this.schema?this.schema.const:this.schema.enum[0])}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},qe=e=>class extends($e(e)){static testSchema(e){return R(e.type||"string").includes("string")&&(e.contentMediaType&&xe(e.contentMediaType)||Math.max(e.maxLength||0,e.minLength||0)>=1024)}define(e,t=null){super.define(new(Oe())(e),t)}},Ce=e=>class extends($e(e)){static testSchema(e){return R(e.type||"string").includes("string")}define(e,t=null){if(super.define(new(Oe())(e),t),this.attrs.type="text","date"===this.schema.format?this.attrs.type="date":"time"===this.schema.format?this.attrs.type="time":"date-time"===this.schema.format?this.attrs.type="datetime-local":"duration"===this.schema.format?this.attrs.type="":["uri","uri-reference","iri","iri-reference","uuid"].includes(this.schema.format)||["hostname","idn-hostname"].includes(this.schema.format)?this.attrs.pattern="":["email","idn-email"].includes(this.schema.format)?this.attrs.type="email":["ipv4","ipv6"].includes(this.schema.format)?this.attrs.pattern="":"password"===this.schema.format?this.attrs.type="password":"color"===this.schema.format?this.attrs.type="color":"phone"===this.schema.format?this.attrs.pattern="^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,6}$":"postal-code"===this.schema.format&&(this.attrs.pattern="^[0-9]{5}(?:-[0-9]{4})?$"),this.schema.maxLength&&(this.attrs.maxlength=this.schema.maxLength),this.schema.minLength&&(this.attrs.minlength=this.schema.minLength),this.schema.pattern&&(this.attrs.pattern=this.schema.pattern),!this.schema.col){const e=this.schema.maxLength||150;this.schema.col=Math.max(1,parseInt(e/25))}}},Ve=e=>class extends($e(e)){static testSchema(e){const t=R(e.type);return t.includes("integer")||t.includes("number")}define(e,t=null){if(super.define(new(Re())(e),t),this.attrs.type="number",this.schema.exclusiveMaximum?this.attrs.max=this.schema.exclusiveMaximum-1e-4:this.schema.maximum&&(this.attrs.max=this.schema.maximum),this.schema.exclusiveMinimum?this.attrs.min=this.schema.exclusiveMinimum+1e-4:this.schema.minimum&&(this.attrs.min=this.schema.minimum),this.schema.multipleOf&&(this.attrs.step=this.schema.multipleOf),!this.schema.col){const e=this.schema.maxLength||50;this.schema.col=Math.max(1,parseInt(e/25))}}},We=e=>class extends(Ne(e)){static testSchema(e){return R(e.type).includes("boolean")}define(e,t=null){super.define(new(_e())(e),t),this.attrs.type="checkbox",!0!==this.schema.const&&!0!==this.schema.default||(this.attrs.checked=!0)}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},Ue=e=>class extends(e||class{}){define(e,t=null){super.define(...arguments);const s=()=>{(this.attrs.index||0===this.attrs.index)&&this.childEntries&&this.schema.indexProperty&&this.childEntries[this.schema.indexProperty]&&this.childEntries[this.schema.indexProperty].json(this.attrs.index)};s(),be(this.attrs,"index",s)}},ze=e=>class extends(e||HTMLElement){constructor(){super();new MutationObserver(e=>{e.forEach(e=>{e.removedNodes.forEach(e=>{this.nodeRemovalListeners&&this.nodeRemovalListeners.has(e)&&this.nodeRemovalListeners.get(e).forEach(e=>e())})})}).observe(this,{subtree:!0,childList:!0})}async remoteAction(e,t,s={}){return this.state.remoteAction=e,this.state.remoteActionError="",fetch(t,{headers:{accept:"application/json"},...s,method:e}).then(e=>(this.state.remoteAction=!1,e)).catch(e=>{this.state.remoteAction=!1,this.alert(e)})}static get subscriptMethods(){return["renderBasic","render"]}connectedCallback(){this.renderBasic(),this.render()}renderBasic(){this.schema.title&&this.namespace.title&&$(this.namespace.title).html(this.schema.title),this.schema.description&&this.namespace.description&&$(this.namespace.description).html(this.schema.description),this.schema.isRequired&&$(this).attr("data-required",!0),this.schema.col&&12!==this.schema.col?$(this).class({["col-"+this.schema.col]:!0,"col-12":!1}):$(this).class("col-12",!0),"hidden"===this.schema.display&&$(this).class("overflow-hidden wt-0 ht-0 pd-0 mg-0",!0),$(this).attr("data-remote-action",this.state.remoteAction||!1),$(this).attr("data-remote-action-error",this.state.remoteActionError||!1);var e=this.state.alert?this.state.alert.message:"",t=this.state.alert?this.state.alert.type:"";this.namespace.alert&&($(this.namespace.alert).html(e||""),$(this.namespace.alert).attr("data-type",t||!1),e&&this.namespace.alert.focus())}render(){}alert(){const e=super.alert(...arguments);return this.renderBasic(),e}},Be=e=>class extends(ze(e)){connectedCallback(){super.connectedCallback(),this.namespace.adder&&(this.adderAction=this.adderAction||(()=>this.extend()),this.namespace.adder.removeEventListener("click",this.adderAction),this.namespace.adder.addEventListener("click",this.adderAction))}deriveChildEntry(e,t){if(this.template){var s=Reflect.ownKeys(this.template.exports).map(e=>this.template.exports[e][0]).reduce((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testSchema(e)?s:null},null);if(s){s=s.cloneNode(!0),this.namespace.content?this.namespace.content.append(s):this.append(s);try{s.define(e,this),(s.attrs||{}).index=t}catch(e){console.warn("Error calling element.define();",e,this)}}return s}}},Qe=e=>class extends(Be(Ae(e||HTMLElement))){get value(){if(this.schema.primaryKey&&this.childEntries[this.schema.primaryKey])return this.childEntries[this.schema.primaryKey].json()}},Ke=e=>class extends(Be(e)){},Je=e=>class extends(Ke(ke(e||HTMLElement))){},Ge=e=>class extends(Ke(Fe(e||HTMLElement))){constructor(){super(),this.addEventListener("keypress",e=>{"Enter"===e.key&&(this.extend(e=>e.namespace.input?e.namespace.input.focus():null),e.preventDefault())})}extend(e=null){if(!this.childEntries.length||this.childEntries[this.childEntries.length-1].namespace.input.value)return super.extend(e)}render(){this.namespace.input&&this.attrs.name&&$(this.namespace.input).attr(this.attrs)}},Xe=e=>class extends(ze(e)){deriveEnumEntry(e,t){var s;if(!this.template&&this.namespace.input instanceof HTMLSelectElement)s=document.createElement("option");else{var i=Reflect.ownKeys(this.template.exports).map(e=>this.template.exports[e][0]).reduce((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testSchema(this.schema,e)?s:null},null);i&&(s=i.cloneNode(!0))}return s&&(this.namespace.input instanceof HTMLSelectElement?(this.namespace.input.options.add(s),s.setAttribute("label",e.label||Q(e.value)),s.value=e.value,s.selected=e.selected):(this.namespace.input.append(s),s.setAttribute("data-index",itemIndex))),s}render(){this.namespace.input&&this.attrs.name&&$(this.namespace.input).attr(this.attrs)}},Ye=e=>class extends(Xe(De(e||HTMLElement))){},Ze=e=>class extends(Xe(Ie(e||HTMLElement))){},et=e=>class extends(ze(He(e||HTMLElement))){constructor(){super(),this.addEventListener("change",e=>{this.namespace.dropArea&&this.populate(Array.from(e.target.files).map(e=>({file:e})),1)}),this._handlerDrag=e=>{"dragover"===e.type||"dragenter"===e.type?this.state&&(this.state.dragging=!0):"dragleave"!==e.type&&"dragend"!==e.type&&"drop"!==e.type||(e.preventDefault(),this.state&&(this.state.dragging=!1),"drop"===e.type&&this.populate(Array.from(e.dataTransfer.files).map(e=>({file:e}))))},be(this.filesList,e=>{if("length"===e[0].name||!this.namespace.input)return;const t=new DataTransfer;this.filesList.map(e=>e.file).filter(e=>!g(e)).forEach(e=>{t.items.add(e)}),this.namespace.input.files=t.files,this.schema.isRequired&&(!this.namespace.input.files.length&&this.filesList.length&&this.filesList[0]?this.namespace.input.removeAttribute("required"):this.namespace.input.setAttribute("required",!0))})}connectedCallback(){super.connectedCallback(),this.namespace.dropArea&&["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(e=>{this.namespace.dropArea.removeEventListener(e,this._handlerDrag),this.namespace.dropArea.addEventListener(e,this._handlerDrag)})}define(e,t=null){super.define(...arguments),this.render()}deriveFileEntry(e,t,s=null){if(this.template){var i=Reflect.ownKeys(this.template.exports).map(e=>this.template.exports[e][0]).reduce((t,s)=>{if(t)return t;const i=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return i&&i.testFile(e)?s:null},null);if(i){if((i=i.cloneNode(!0)).file=e._file||e.file,g(e.file)){const t=document.createElement("input");t.setAttribute("name",this.attrs.name),t.setAttribute("value",e.file),t.setAttribute("type","hidden"),i.append(t),i.setAttribute("data-src",e.file),2!==P(R(s),[1,2]).length||this.schema.remoteDelete||i.setAttribute("data-isdefault","true")}this.namespace.preview?this.namespace.preview.append(i):this.append(i);try{i.previewFile(e.file,this)}catch(e){console.warn("Error calling element.previewFile();",e,this)}}return i}}render(){this.namespace.input&&(this.attrs.type||this.attrs.name)&&$(this.namespace.input).attr(this.attrs)}},tt=e=>class extends(e||HTMLElement){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,(e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then(e=>{$(this).attr("data-deleting",!1),this.ownerWidget.populate([],[1,2])}))})}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}static testFile(e){return!0}async previewFile(e,t){if(this.ownerWidget=t,g(e)){const t=await fetch(e),s=t.ok?await t.blob():"";e=new File([s],e.split("/").pop(),{type:t.headers.get("content-type")||"application/octet-stream"})}e.name,e.size;var s=e=>window.URL.revokeObjectURL(e.src);if(/^image\//.test(e.type)){var i=document.createElement("img");return i.onload=e=>{s(i)},i.src=window.URL.createObjectURL(e),void this.append(i)}if(/^video\//.test(e.type)){var n=document.createElement("video");return n.onloadstart=e=>{s(n),n.play()},n.src=window.URL.createObjectURL(e),n.muted=!0,void this.append(n)}const r=document.createElement("i");r.classList.add("bi");var a="file";/^audio\//.test(e.type)?a="music":/msword|ms-word|wordprocessing/.test(e.type)?a="word":/powerpoint|presentation/.test(e.type)?a="powerpoint":/excel|spreadsheet/.test(e.type)?a="excel":/^text\//.test(e.type)?a="text":/\/pdf/.test(e.type)?a="pdf":/\/zip/.test(e.type)&&(a="zip"),r.classList.add("bi-file-"+a),this.append(r)}},st=e=>class extends(ze(e)){json(e=null){if(!arguments.length)return this.namespace.input.value;this.namespace.input.value=e}render(){this.namespace.input&&(this.attrs.type||this.attrs.name)&&$(this.namespace.input).attr(this.attrs)}},it=e=>class extends(st(qe(e||HTMLElement))){},nt=e=>class extends(st(Ce(e||HTMLElement))){},rt=e=>class extends(st(Ve(e||HTMLElement))){},at=e=>class extends(st(We(e||HTMLElement))){json(e=null){if(!arguments.length)return this.namespace.input.checked?this.namespace.input.value:null;this.namespace.input.checked=!0===e||e+""===this.namespace.input.value}},lt=e=>class extends(Ue(e||HTMLElement)){connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.namespace.deleter&&(this.deleterAction=this.deleterAction||(()=>{this.ownerWidget&&this.ownerWidget.execNodeRemoval(this,(e,t)=>{confirm(e)&&($(this).attr("data-deleting",!0),t().then(e=>{$(this).attr("data-deleting",!1)}))})}),this.namespace.deleter.removeEventListener("click",this.deleterAction),this.namespace.deleter.addEventListener("click",this.deleterAction))}},{SubscriptElement:ct}=WebQit.OOHTML,ot=class extends(Qe(ct(HTMLFormElement))){};customElements.define("playui-form-widget",ot,{extends:"form"});const ht=class extends(Qe(ct(HTMLFieldSetElement))){},ut=class extends(Je(ct(HTMLFieldSetElement))){},dt=class extends(Ge(ct(HTMLFieldSetElement))){},mt=class extends(Ye(ct(HTMLDivElement))){},pt=class extends(Ze(ct(HTMLDivElement))){},ft=class extends(et(ct(HTMLDivElement))){},vt=class extends(it(ct(HTMLDivElement))){},gt=class extends(nt(ct(HTMLDivElement))){},yt=class extends(rt(ct(HTMLDivElement))){},bt=class extends(at(ct(HTMLDivElement))){};customElements.define("playui-collection-widget",ht,{extends:"fieldset"}),customElements.define("playui-multiple-widget",ut,{extends:"fieldset"}),customElements.define("playui-multiple2-widget",dt,{extends:"fieldset"}),customElements.define("playui-enum-widget",mt,{extends:"div"}),customElements.define("playui-enum2-widget",pt,{extends:"div"}),customElements.define("playui-file-widget",ft,{extends:"div"}),customElements.define("playui-editor-widget",vt,{extends:"div"}),customElements.define("playui-text-widget",gt,{extends:"div"}),customElements.define("playui-number-widget",yt,{extends:"div"}),customElements.define("playui-state-widget",bt,{extends:"div"});const xt=class extends(lt(Qe(ct(HTMLFieldSetElement)))){},Et=class extends(lt(Je(ct(HTMLFieldSetElement)))){},wt=class extends(lt(Ge(ct(HTMLFieldSetElement)))){},jt=class extends(lt(Ye(ct(HTMLDivElement)))){},Lt=class extends(lt(Ze(ct(HTMLDivElement)))){},Ot=class extends(lt(et(ct(HTMLDivElement)))){},Mt=class extends(lt(it(ct(HTMLDivElement)))){},Rt=class extends(lt(nt(ct(HTMLDivElement)))){},Tt=class extends(lt(rt(ct(HTMLDivElement)))){},_t=class extends(lt(at(ct(HTMLDivElement)))){};customElements.define("playui-collection-itemscope-widget",xt,{extends:"fieldset"}),customElements.define("playui-multiple-itemscope-widget",Et,{extends:"fieldset"}),customElements.define("playui-multiple2-itemscope-widget",wt,{extends:"fieldset"}),customElements.define("playui-enum-itemscope-widget",jt,{extends:"div"}),customElements.define("playui-enum2-itemscope-widget",Lt,{extends:"div"}),customElements.define("playui-file-itemscope-widget",Ot,{extends:"div"}),customElements.define("playui-editor-itemscope-widget",Mt,{extends:"div"}),customElements.define("playui-text-itemscope-widget",Rt,{extends:"div"}),customElements.define("playui-number-itemscope-widget",Tt,{extends:"div"}),customElements.define("playui-state-itemscope-widget",_t,{extends:"div"});const Pt=class extends(tt(HTMLDivElement)){};customElements.define("playui-file-preview",Pt,{extends:"div"})}]);
//# sourceMappingURL=main.js.map