!function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var r={};s.r(r),s.d(r,"_Schema",(function(){return we})),s.d(r,"_ObjectOrArray",(function(){return Ee})),s.d(r,"_Object",(function(){return Se})),s.d(r,"_Array",(function(){return je})),s.d(r,"_String",(function(){return _e})),s.d(r,"_Num",(function(){return Oe})),s.d(r,"_Number",(function(){return Le})),s.d(r,"_Integer",(function(){return Pe})),s.d(r,"_Boolean",(function(){return Me})),s.d(r,"_Null",(function(){return Te}));var i=function(e){return!Array.isArray(e)&&"object"==typeof e&&e},n=function(e){return typeof e};function a(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var s,r,i=globalThis.WebQitInternalsRegistry.get(e);if(!i){if(i=new Map,!1===t[0])return i;globalThis.WebQitInternalsRegistry.set(e,i)}for(;s=t.shift();)if((r=i)&&!(i=i.get(s))){if(i=new Map,!1===t[0])return i;r.set(s,i)}return i}var l=function(e){return Array.isArray(e)},c=function(e){return!0===e||!1===e},u=function(e){return"function"==typeof e},o=function(e){return null===e||""===e},h=function(e){return arguments.length&&(void 0===e||void 0===e)},m=function(e){return Array.isArray(e)||"object"==typeof e&&e||u(e)},d=function(e){return o(e)||h(e)||!1===e||0===e||m(e)&&!Object.keys(e).length},p=function(e){return u(e)||e&&"[object function]"==={}.toString.call(e)},f=function(e){return e instanceof Number||"number"==typeof e},g=function(e){return f(e)||!0!==e&&!1!==e&&null!==e&&""!==e&&!isNaN(1*e)},v=function(e){return e instanceof String||"string"==typeof e&&null!==e},y=function(e,t=1){var s=0;e.forEach(e=>{s++});var r=e.slice(e.length-s,t);return arguments.length>1?r:r[0]},b=function(e,t=1){return arguments.length>1?y(e.slice().reverse(),t).reverse():y(e.slice().reverse())},x=function(e,...t){return t.forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e},w=function(e,t){var s=[];return function(e,t){t=(t=t||Object.prototype)&&!l(t)?[t]:t;var s=[];for(e=e;e&&(!t||t.indexOf(e)<0)&&"default"!==e.name;)s.push(e),e=e?Object.getPrototypeOf(e):null;return s}(e,t).forEach(e=>{x(s,...Object.getOwnPropertyNames(e))}),s};function E(e,t,s=!1,r=!1,n=!1){var a=0,c=e.shift();if((g(c)||!0===c||!1===c)&&(a=c,c=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((e,u)=>{(m(e)||p(e))&&(s?w(e):Object.getOwnPropertyNames(e)).forEach(o=>{if(t(o,c,e,u)){var h=c[o],m=e[o];if((l(h)&&l(m)||i(h)&&i(m))&&(!0===a||a>0))c[o]=l(h)&&l(m)?[]:{},E([g(a)?a-1:a,c[o],h,m],t,s,r,n);else if(l(c)&&l(e))r?c[o]=m:c.push(m);else try{n?Object.defineProperty(c,o,Object.getOwnPropertyDescriptor(e,o)):c[o]=e[o]}catch(e){}}})}),c}var S=function(e,t){var s=void 0;return m(e)&&Object.keys(e).forEach((r,i)=>{!1!==s&&(s=t(g(r)?parseFloat(r):r,e[r],i))}),s};new Map;var j=function(...e){return E(e,(e,t,s)=>!0,!1,!1,!1)};function _(e,t,s=null,r=!1){return t.length>e.length?-1:("number"==typeof s?r?e.slice(0,s+1+(s<0?e.length:0)):e.slice(s):e).reduce((e,s,i)=>{var[n,a,l]=e;if(!r&&n>-1)return[n,a,l];var c=l+1,u=s===t[c]?0===c?[i,0]:[a,c]:[-1,-1];return u[1]===t.length-1&&(u[1]=-1,u[0]>-1)?[u[0]].concat(u):[n].concat(u)},[-1,-1,-1])[0]+(r||"number"!=typeof s?0:s>-1?s:e.length-s)}function O(e,t,s=null,r=!1){var i=_(e,t,s,r);return-1===i?[]:e.slice(i+t.length)}var L=function(e,t=!0){return l(e)?e:!t&&i(e)?[e]:!1!==e&&0!==e&&d(e)?[]:function(e){return!v(e)&&!h(e.length)}(e)?Array.prototype.slice.call(e):i(e)?Object.values(e):[e]},P=function(e,t,s=null){return l(t)?e.filter(e=>s?t.filter(t=>s(e,t)).length:-1===t.indexOf(e)):[]};function M(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?e.join(".")===t.join("."):e.length===t.length&&e.reduce((e,s,r)=>e&&s===t[r],!0)}var T=function(e,t,s=null){return l(t)?e.filter(e=>s?t.filter(t=>s(e,t)).length:-1!==t.indexOf(e)):[]};function I(e,t,s=null){return s||!1!==s&&e.dotSafe&&t.dotSafe?(e.join(".")+".").startsWith(t.join(".")+"."):t.reduce((t,s,r)=>t&&s===e[r],!0)}var R=function(e){return e.filter((e,t,s)=>s.indexOf(e)===t)};function W(e){return(F(e)?e:L(e).length?[e]:[]).reduce((e,t)=>e.concat([L(t)]),[]).map(e=>N.resolve(e))}class N extends Array{static resolve(e){return e.every(e=>!(e+"").includes("."))?(new N).concat(e):e}get dotSafe(){return!0}}function F(e){return L(e).reduce((e,t)=>e||l(t),!1)}function A(e){return e.filter(e=>e||0===e).length!==e.length}class D{constructor(e){this.target=e,this.fireables=[],this.currentlyFiring=[]}add(e){return this.fireables.push(e),e}remove(e){this.fireables=this.fireables.filter(t=>t!==e)}removeMatches(e){this.match(e).forEach(e=>{this.fireables=this.fireables.filter(t=>t!==e)})}match(e){return this.fireables.filter(t=>{var s=W(t.filter),r=L((t.params||{}).tags),i=W(e.filter),n=L((e.params||{}).tags);return(!e.originalHandler||t.handler===e.originalHandler)&&(!i.length||M(i,s))&&(!n.length||n.length===r.length&&T(r,n).length===n.length)})}static _getFirebase(e,t,s=!0,r=this.__namespace){if(!m(t))throw new Error('Subject must be of type object; "'+n(t)+'" given!');var i=this;return r&&globalThis.WebQitObserverNamespaceRegistry.has(e+"-"+r)&&(i=globalThis.WebQitObserverNamespaceRegistry.get(e+"-"+r),e+="-"+r),!a(t,"firebases").has(e)&&s&&a(t,"firebases").set(e,new i(t)),a(t,"firebases").get(e)}static _namespace(e,t,s=null){if(e+="-"+t,2===arguments.length)return globalThis.WebQitObserverNamespaceRegistry.get(e);if(!(s.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${t} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(e,s),s.__namespace=t}}globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);class H{constructor(e,t){this.target=e,this.handler=t.handler,this.filter=t.filter,this.params=t.params}disconnect(){this.disconnected=!0}}class q extends H{fire(e,t,s){return this.disconnected||this.filter&&!T(L(this.filter),[e.type]).length?t(...Array.prototype.slice.call(arguments,2)):this.handler(e,s,t)}}class k{constructor(e,t){if(this.target=e,!t.type)throw new Error("Action type must be given in definition!");S(t,(e,t)=>{Object.defineProperty(this,e,{value:t,enumerable:!0})}),Object.seal(this)}}class C extends D{add(e){return super.add(new q(this.target,e))}fire(e,t=null){if(e instanceof k||(e=new k(this.target,e)),this.currentlyFiring.filter(t=>t.type===e.type&&t.name===e.name).length)return t?t():void 0;this.currentlyFiring.push(e);const s=(r,...i)=>{var n=this.fireables[r];return n?n.fire(e,(...e)=>s(r+1,...e),...i):t?t(...i):i[0]};var r=s(0);return this.currentlyFiring.pop(),r}static getFirebase(e,t=!0,s=null){return super._getFirebase("interceptor",...arguments)}static namespace(e,t=null){return super._namespace("interceptor",...arguments)}}var Q=function(e){return a(e,!1).get(e)||e},V=function(e,t,s={},r={}){if(!t||!m(t))throw new Error("Target must be of type object!");t=Q(t);var i,n=function(r){return arguments.length?r:Reflect[e](t,...Object.values(s))};return(i=C.getFirebase(t,!1,r.namespace))?i.fire({type:e,...s},n):n()},U=function(e,t,s,r={}){return V("apply",e,{thisArgument:t,argumentsList:s},r)},z=function(e,t,s=null,r={}){return V("construct",e,arguments.length>2?{argumentsList:t,newTarget:s}:{argumentsList:t},r)},B=function(e,t){return"string"!=typeof e?e:e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+(void 0!==typeof t&&t?e.substr(1).toLowerCase():e.substr(1))}))};class K{constructor(e,t=!1){this._={},this._.target=e,this._.cancellable=t,this._.propagationStopped=!1,this._.defaultPrevented=!1,this._.promisesInstance=null,this._.promises=[]}get target(){return this._.target}get cancellable(){return this._.cancellable}stopPropagation(){this._.propagationStopped=!0}get propagationStopped(){return this._.propagationStopped}preventDefault(){this._.defaultPrevented=!0}get defaultPrevented(){return this._.defaultPrevented}waitUntil(e){e instanceof Promise&&(this._.promises.push(e),this._.promisesInstance=null)}get promises(){return!this._.promisesInstance&&this._.promises.length&&(this._.promisesInstance=Promise.all(this._.promises)),this._.promisesInstance}respondWith(e){var t,s=i(e)&&!h(e.propagationStopped)&&!h(e.defaultPrevented);!1===e||s&&e.propagationStopped?this.stopPropagation():!1===e||s&&e.defaultPrevented?this.preventDefault():(e instanceof Promise&&(t=e)||s&&(t=e.promises))&&this.waitUntil(t)}}class J extends H{constructor(e,t){if(super(e,t),this.filters2D=W(this.filter),this.filtersIsOriginally2D=F(this.filter),this.filtersIsDynamic=this.filters2D.filter(e=>A(L(e))).length>0,this.filtersIsDynamic&&this.filters2D.length>1)throw new Error('Only one "Dynamic Filter" must be observed at a time! "'+this.filters2D.map(e=>"["+e.join(", ")+"]").join(", ")+'" have been bound together.')}fire(e){if(this.disconnected||this.params.type&&(t=e=>this.params.type===e.type,!e.reduce((e,s,r)=>e||t(s,r),!1)))return;var t;const s=e=>!["set","def"].includes(e.type)||!this.params.diff||(p(this.params.diff)?this.params.diff(e.value,e.oldValue):e.value!==e.oldValue);var r=new K(this.target);if(this.filters2D.length){var n=e.filter(e=>this.filters2D.filter((t,r)=>{var i=t.slice();return this.filtersIsDynamic&&e.path.forEach((e,t)=>{i[t]=i[t]||0===i[t]?i[t]:e}),(!this.filtersIsDynamic||!A(i))&&s(e)&&(!this.params.subtree&&M(i,e.path)||this.params.suptree&&I(i,e.path)&&(!g(this.params.suptree)||O(i,e.path).length<=this.params.suptree)||this.params.subtree&&e.path.length>=i.length&&I(e.path,i)&&(!g(this.params.subtree)||O(e.path,i).length<=this.params.subtree))}).length);if(n.length)if(this.filtersIsOriginally2D||this.params.subtree){var a=n;i(this.filter)&&(a={...this.filter},n.forEach((e,t)=>{a[e.name]=e})),r.respondWith(this.handler(a,r))}else n.forEach((e,t)=>{r.respondWith(this.handler(e,r))})}else(this.params.subtree||e.filter(e=>M(e.path,[e.name])).length===e.length)&&e.filter(e=>s(e)).length&&r.respondWith(this.handler(e,r));return r}}class G{constructor(e,t){if(this.target=e,t.originalSubject||(this.originalSubject=e),!("type"in t))throw new Error("Mutation type must be given in definition!");if(!("name"in t))throw new Error("Property name must be given in definition!");S(t,(e,t)=>{"path"===e&&(t=N.resolve(t)),Object.defineProperty(this,e,{value:t,enumerable:!0})}),this.path||Object.defineProperty(this,"path",{value:N.resolve([t.name]),enumerable:!0}),Object.seal(this)}}class X extends D{constructor(e){super(e),this.buffers=[]}add(e){return super.add(new J(this.target,e))}fire(e,t){var s=new K(this.target,t);return e=L(e,!1).map(e=>e instanceof G?e:new G(this.target,e)),this.buffers.length?(b(this.buffers)(e),s):(this.currentlyFiring.filter(t=>e.filter(e=>t.type===e.type&&t.name===e.name).length).length,this.fireables.forEach(r=>{if(s.propagationStopped&&t)return s;s.respondWith(r.fire(e))}),s)}static getFirebase(e,t=!0,s=null){return super._getFirebase("observer",...arguments)}static namespace(e,t=null){return super._namespace("observer",...arguments)}}var Y=function(e,t,s=null,r={}){if(!(e=s||e)||!m(e))throw new Error("Target must be of type object!");e=Q(e);var i=L(t),n=i.map(t=>{var n,l=function(r){return arguments.length?r:a(e,"accessorizedProps").has(t)&&a(e,"accessorizedProps").get(t).touch(!0)?a(e,"accessorizedProps").get(t).get():s?Reflect.get(e,t,s):Reflect.get(e,t)};return(n=C.getFirebase(e,!0,r.namespace))?n.fire({type:"get",name:t,related:i,receiver:s},l):l()});return l(t)?n:n[0]},Z=function(e,t,s=null,r={}){if(!(e=Q(e))||!m(e))throw new Error('Observable subjects must be of type object; "'+n(e)+'" given!');if(p(t)&&(r=arguments.length>2?s:{},s=t,t=null),!p(s))throw new Error('Handler must be a function; "'+n(s)+'" given!');var i,a=X.getFirebase(e,!0,r.namespace),l={filter:t,handler:s,params:r};if((l.filter||"*"===l.params.subtree||l.params.subtree&&re(e))&&se(e,l.filter,l.params.subtree,r.namespace),l.params.unique&&(i=a.match({filter:t,params:r})).length){if("replace"!==l.params.unique)return i[0];a.remove(i[0])}return a.add(l)},ee=function(e,t,s,r=null,n={}){var a;if(e!==s&&(Z(s,(s,r)=>{if(a=X.getFirebase(e,!1,n.namespace)){var i=s.map(s=>{var r=s;do{if(r.target===e)return}while(r=r.src);var i={};return S(s,(e,t)=>{"target"!==e&&"name"!==e&&"path"!==e&&"src"!==e&&(i[e]=t)}),i.name=t,i.path=[t].concat(s.path),i.originalSubject=s.originalSubject,i.src=s,new G(e,i)}).filter(e=>e);if(i.length)return a.fire(i,r.cancellable)}},{subtree:!0,...n,unique:!0,tags:[te,t,e]}),i(r)&&(a=X.getFirebase(e,!1,n.namespace)))){var l=j({name:t,type:"set",value:s,related:[t]},r);let e=a.fire(l,n.cancellable);if(n.eventTypeReturn)return e}};const te={};function se(e,t=null,s=!1,r=null){if(!e||!m(e))throw new Error("Target must be of type object!");var i=X.getFirebase(e,!0,r);if(i&&!i.build){i.build=s;var n=W(t),a=!n.length||n.filter(e=>!e[0]&&0!==e[0]).length?Object.keys(e):n.map(e=>e[0]),l=n.length?n.map(e=>e.slice(1)).filter(e=>e.length):null;i.subBuild=l&&l.length?l:null,a.forEach(t=>{var n=Y(e,t,null,{namespace:r});try{m(n)&&(ee(e,t,n,null,params),(i.subBuild&&re(n)||(_isFunction(s)?s(n):s&&re(n)))&&se(n,i.subBuild,s,r))}catch(e){}})}}const re=e=>(e instanceof Object||e instanceof Array||e instanceof Function)&&("undefined"==typeof window||e!==window);var ie=function(e,t,s=null,r={}){if(!(e=Q(e))||!m(e))throw new Error('Observable subjects must be of type object; "'+n(e)+'" given!');if(p(t)&&(r=arguments.length>2?s:{},s=t,t=null),s&&!p(s))throw new Error('Handler must be a function; "'+n(s)+'" given!');var i;if(i=X.getFirebase(e,!1,r.namespace))return i.removeMatches({filter:t,originalHandler:s,params:r})},ne=function(e,t,s,r=null,n={}){var a;if(ie(s,null,null,{...n,tags:[te,t,e]}),i(r)&&(a=X.getFirebase(e,!1,n.namespace))){var l=j({name:t,type:"del",oldValue:s,related:[t]},r);a.fire(l,n.cancellable)}},ae=function(e,t,s={}){return V("has",e,{name:t},s)},le=function(e,t,s,r={}){t=s.receiver||t;var n=s.keysOrPayload,c=s.value;if(!t||!m(t))throw new Error("Target must be of type object!");i(n)&&(r=c||{},c=null),t=Q(t);var u=C.getFirebase(t,!1,r.namespace),o=X.getFirebase(t,!1,r.namespace);const h=(i,n,l,c)=>{var h,d="set";e&&(d="defineProperty",n=(h=n||{}).value);var p,f=!1;ae(t,i,r)&&(f=!0,p=Y(t,i,s.receiver,r));var g={name:i,type:d,value:n,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p},v=function(e){if(arguments.length&&(h?h=e:n=e),h){if(a(t,"accessorizedProps",!1).has(i)&&!a(t,"accessorizedProps").get(i).restore())return!1;Object.defineProperty(t,i,h)}else if(a(t,"accessorizedProps",!1).has(i))return a(t,"accessorizedProps").get(i).set(n);return t[i]=n,!0};if(u){var y=h?{type:"defineProperty",name:i,descriptor:h,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p}:{type:"set",name:i,value:n,receiver:s.receiver,related:l,detail:c,isUpdate:f,oldValue:p};g.success=u.fire(y,v)}else g.success=v();return g.success&&g.value!==g.oldValue&&(m(g.oldValue)&&ne(t,i,g.oldValue,null,r),m(g.value)&&(ee(t,i,g.value,null,r),o&&(o.subBuild||o.build&&re(g.value))&&se(g.value,o.subBuild,o.build,r.namespace))),g};var d,p=[];l(n)||(v(n)||f(n))&&(d=L(n))?p=d.map(e=>h(e,c,d,r.detail)):i(n)&&(d=Object.keys(n))&&(p=d.map(e=>h(e,n[e],d,r.detail)));var g,y=p.filter(e=>!1!==e.success);return o?(g=o.fire(y,r.cancellable)).successCount=y.length:r.eventTypeReturn&&(g=new K(t)),r.eventTypeReturn?g:y.length>0},ce=function(e,t,s=null,r={}){return le(!0,e,{keysOrPayload:t,value:s},r)},ue=function(e,t,s={}){if(!e||!m(e))throw new Error("Target must be of type object!");e=Q(e);var r,i,n=L(t),l=n.map(t=>{var r;ae(e,t,s)&&(r=Y(e,t,null,s));var i,l={name:t,type:"deleteProperty",related:n,detail:s.detail,oldValue:r},c=function(s){return arguments.length?s:!(a(e,"accessorizedProps",!1).has(t)&&!a(e,"accessorizedProps").get(t).restore())&&(delete e[t],!0)};return(i=C.getFirebase(e,!1,s.namespace))?l.success=i.fire({type:"deleteProperty",name:t,oldValue:r,related:n},c):l.success=c(),l.success&&m(l.oldValue)&&ne(e,t,l.oldValue,null,s),l}).filter(e=>!1!==e.success);return(r=X.getFirebase(e,!1,s.namespace))?(i=r.fire(l,s.cancellable)).successCount=l.length:s.eventTypeReturn&&(i=new K(e)),s.eventTypeReturn?i:l.length>0},oe=function(e,t,s={}){return V("getOwnPropertyDescriptor",e,{name:t},s)},he=function(e,t={}){return V("getPrototypeOf",e,{},t)},me=function(e,t={}){return V("isExtensible",e,{},t)},de=function(e,t={}){return V("ownKeys",e,{},t)},pe=function(e,t={}){return V("preventExtensions",e,{},t)},fe=function(e,t,s=null,r=null,i={}){return le(!1,e,arguments.length>3?{keysOrPayload:t,value:s,receiver:r}:{keysOrPayload:t,value:s},i)},ge=function(e,t,s={}){return V("setPrototypeOf",e,{prototype:t},s)},ve=fe,ye=function(e,t={}){if(!m(e))throw new Error('Object must be of type target; "'+n(e)+'" given!');var s=new Proxy(e,{apply:(e,s,r)=>U(e,s,r,t),construct:(e,s,r=null)=>z(e,s,r,t),defineProperty:(e,s,r)=>ce(e,s,r,t),deleteProperty:(e,s)=>ue(e,s,t),get:(e,r,i=null)=>{var n=Y(e,r,i,t);return!1!==t.proxyAutoBinding&&p(n)&&!function(e){return u(e)&&/^class\s?/.test(Function.prototype.toString.call(e))}(n)?n.bind(s):n},getOwnPropertyDescriptor:(e,s)=>oe(e,s,t),getPrototypeOf:e=>he(e,t),has:(e,s)=>ae(e,s,t),isExtensible:e=>me(e,t),ownKeys:e=>de(e,t),preventExtensions:e=>pe(e,t),set:(e,s,r,i=null)=>fe(e,s,r,i,t),setPrototypeOf:(e,s)=>ge(e,s,t)});return a(s).set(s,e),s},be=Z;const xe=e=>e&&(e.startsWith("text/")||"application/rtf"===e||"application/xml"===e||"application/xhtml+xml"===e||"application/json"===e),we=e=>class extends(e||class{}){constructor(e){super(e),Object.keys(e).forEach(t=>{Object.defineProperty(this,t,{value:e[t]})})}validate(e){return super.validate?super.validate(e):{valid:!0}}},Ee=e=>class extends(we(e)){validate(e){var t=super.validate(e);return t.valid?(t=this._validateMin(e)).valid?(t=this._validateMax(e)).valid?t:{valid:!1,error:t.error||`Maximum number of entries exceeded by: ${t.violation}.`}:{valid:!1,error:t.error||`Minimum number of entries short of: ${t.violation}.`}:t}},Se=e=>class extends(Ee(e)){getPropertyNameSchema(e=null){var t=this.propertyNames||{type:"string"};return!1===this.additionalProperties&&(t.error="Additional properties not allowed."),t.isRequired=!0,t}getPropertySchema(e,t=null){var s;if(this.properties&&(s=this.properties[e])||(s=this._patternPropertiesMatch(e))||(s=this.additionalProperties)||!1===s||(s={}),s){if((this.required||[]).includes(e)&&(s.isRequired=!0),t){const n=Object.keys(t);var r,i;!s.isRequired&&(r=T(this.dependentRequired||[],n).reduce((t,s)=>t||this.dependentRequired[s].includes(e)?s:null,null))&&(s.isRequired=r),(n.includes(e)||(i=this._validateMax(t)).valid)&&0!==i.violation||(s.error="This additional entry will violate the maximum number of entries allowed.")}return{...s,name:e}}}_patternPropertiesMatch(e){return Object.keys(this.patternProperties||{}).reduce((t,s)=>t||(new RegExp(s).test(e)?this.patternProperties[s]:void 0),null)}validate(e){var t=super.validate(e);return t.valid?(t=this._validateRequired(e)).valid?(t=this._validateDependentRequired(e)).valid?t:{valid:!1,error:t.error||`Entries associated with "${t.master}" still empty: ${t.violation.join(", ")}.`}:{valid:!1,error:t.error||`Required entries still empty: ${t.violation.join(", ")}.`}:t}_validateMax(e){if(!this.maxProperties)return{valid:!0};const t=Object.keys(e).length-this.maxProperties;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minProperties)return{valid:!0};const t=Object.keys(e),s=this.minProperties-t.length;return{valid:s<=0,violation:s}}_validateRequired(e){if(!this.required)return{valid:!0};const t=Object.keys(e),s=P(this.required,t);return{valid:0===s.length,violation:s}}_validateDependentRequired(e){if(!this.dependentRequired)return{valid:!0};const t=Object.keys(e),[s,r]=Object.keys(this.dependentRequired).reduce((e,s)=>{if(e)return e;if(t.includes(s)){const e=P(this.dependentRequired[s],t);if(e.length)return[s,e]}},null)||[];return{valid:!s,master:s,violation:r}}},je=e=>class extends(Ee(e)){getItemSchema(e,t=null){var s;if(this.prefixItems&&(s=this.prefixItems[e])||(s=this.items)||!1===s||(s={}),s){var r;if(t)(e in t||(r=this._validateMax(t)).valid)&&0!==r.violation||(s.error="This additional entry will violate the maximum number of entries allowed.");return{...s,name:e}}}validate(e){var t=super.validate(e);return t.valid?(t=this._validateUnique(e)).valid?(t=this._validateContains(e)).valid?t:{valid:!1,error:t.error||`Entries must contain ${t.min>0?`at least ${t.min} `+(t.max>1?"and ":""):""} ${t.max>1?`at most ${t.max} `:""}of ${t.desc}.`}:{valid:!1,error:t.error||"Entries must be unique"}:t}_validateMax(e){if(!this.maxItems)return{valid:!0};const t=e.length-this.maxItems;return{valid:t<=0,violation:t}}_validateMin(e){if(!this.minItems)return{valid:!0};const t=this.minItems-e.length;return{valid:t<=0,violation:t}}_validateUnique(e){return this.uniqueItems?{valid:R(e).length===e.length}:{valid:!0}}_validateContains(e){if(!this.contains)return{valid:!0};const t=e.filter(e=>this.__validateContains(this.contains,e));return t.length<(this.minContains||1)||this.maxContains&&t.length>this.maxContains?{valid:!1,min:this.minContains||1,max:this.maxContains,desc:desc}:{valid:!0}}},_e=e=>class extends(we(e)){validate(e){var t=super.validate(e);return t.valid?{valid:v(e)}:t}},Oe=e=>class extends(we(e)){validate(e){var t=super.validate(e);return t.valid,t}},Le=e=>class extends(Oe(e)){validate(e){var t=super.validate(e);return t.valid?{valid:g(e)}:t}},Pe=e=>class extends(Oe(e)){validate(e){var t=super.validate(e);return t.valid?{valid:Number.isInteger(e)}:t}},Me=e=>class extends(we(e)){validate(e){var t=super.validate(e);return t.valid?{valid:c(e)}:t}},Te=e=>class extends(we(e)){validate(e){var t=super.validate(e);return t.valid?{valid:o(e)}:t}},Ie=e=>class extends(e||class{}){static getSchemaName(e){return e=L(e||"string"),[["object","_Object"],["array","_Array"],["string","_String"],["number","_Number"],["integer","_Integer"],["boolean","_Boolean"],["null","_Null"]].reduce((t,s)=>t||(e.includes(s[0])?s[1]:null),null)}setSchema(e,t=null){ve(this,"schema",ye(e)),ve(this,"parentWidget",t),ve(this,"attrs",ye({name:this.parentWidget&&this.parentWidget.attrs.name?`${this.parentWidget.attrs.name}[${this.schema.name}]`:this.schema.name})),this.schema.title||(this.schema.title=B(((this.schema.name||"")+"").replaceAll("_"," "))),this.schema.isRequired&&(this.attrs.required=!0),h(this.schema.const)&&h(this.schema.default)||(this.attrs.value=h(this.schema.const)?this.schema.default:this.schema.const),!this.schema.readOnly&&h(this.schema.const)||(this.attrs.readonly=!0)}},Re=e=>class extends(Ie(e)){deriveChildWidget(e){}renderChildWidget(e,t,s=null){}},We=e=>class extends(Re(e)){static testSchema(e){return L(e.type).includes("object")}setSchema(e,t=null){super.setSchema(new(Se())(e),t),ve(this,"entries",ye({})),Object.keys(this.schema.properties||{}).forEach(e=>{const t=this.schema.getPropertySchema(e);this.addResolvedEntry(e,t)})}addResolvedEntry(e,t){const s=this.renderChildWidget(this.deriveChildWidget(t),t,()=>{this.entries[e]===s&&delete this.entries[e]});return s?this.entries[e]=s:console.warn(`No widget type defined for entry "${e}" of schema type "${L(t.type||"string").join(", ")}".`),s}extend(e,t=null){if(p(e)){const s=()=>{const r=this.schema.getPropertyNameSchema(this.json());e(r,e=>{r.validate(e)?extend(e,t):s()})};s()}else if(e){const s=this.json(),r=this.schema.getPropertySchema(e,s),i=this.addResolvedEntry(e,r);t&&t(i)}}json(e={}){if(arguments.length){if(!i(e))throw new Error("Data must be a valid JSON object.");return void Object.keys(e).forEach(t=>{if(!this.entries[t])throw new Error(`Entry "${t}" not in collection.`);this.entries[t].json(e[t])})}const t={};return Object.keys(this.entries).forEach(e=>{t[e]=this.entries[e].json()}),t}},Ne=e=>class extends(Re(e)){static testSchema(e){return L(e.type).includes("array")}setSchema(e,t=null){super.setSchema(new(je())(e),t),ve(this,"entries",ye([])),d(this.schema.prefixItems)||this.schema.prefixItems.forEach(e=>{const t=this.schema.getItemSchema(e);this.addResolvedEntry(e,t)}),!0===this.schema.autoExtend&&this.extend()}addResolvedEntry(e,t){const s=this.renderChildWidget(this.deriveChildWidget(t),t,()=>{this.entries[e]===s&&delete this.entries[e]});return s?this.entries[e]=s:console.warn(`No widget type defined for entry "${e}" of schema type "${L(t.type||"string").join(", ")}".`),s}extend(e=null){const t=this.json(),s=t.length,r=this.schema.getItemSchema(s,t),i=this.addResolvedEntry(s,r);e&&e(i)}json(e=[]){if(!arguments.length)return this.entries.filter(e=>e).map(e=>e.json());if(!l(e))throw new Error("Data must be a valid JSON array.");e.forEach((e,t)=>{if(!this.entries[t])throw new Error(`Entry "${t}" not in collection.`);this.entries[t].json(e)})}},Fe=e=>class extends(Ne(e)){static testSchema(e){if(super.testSchema(e)&&!e.enum){var t=[],s=this.lineContentLengthLimit||50;if(e.prefixItems){if(e.prefixItems.some(e=>!("const"in e)&&1!==(e.enum||[]).length||T(L(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s))return;t=e.prefixItems.map(e=>"const"in e?e.const:e.enum[0])}if(e.items){if(T(L(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum||[])}return!t.some(e=>m(e)||(e+"").length>s)}}setSchema(e,t=null){super.setSchema(...arguments),!1!==this.schema.autoExtend&&this.extend()}},Ae=e=>class extends(Ie(e)){static testSchema(e){return l(e.enum)||L(e.type).includes("array")&&(d(e.prefixItems)||e.prefixItems.every(e=>"const"in e||1===(e.enum||[]).length))&&(!1===e.items||l((e.items||{}).enum)&&e.uniqueItems)}constructor(){super(),ve(this,"entries",ye([]))}setSchema(e,t=null){const s=this.constructor.getSchemaName(e.type);super.setSchema(new(r[s]())(e),t);var i=[];this.schema.enum?i=this.schema.enum.map((e,t)=>({value:e,label:(this.schema.enumNames||{})[t]})):L(this.schema.type||"string").includes("array")&&(this.schema.prefixItems&&(i=this.schema.prefixItems.map(e=>"const"in e?{value:e.const,label:e.title}:{value:e.enum[0],label:e.title||(e.enumNames||[])[0]})),this.schema.items&&this.schema.items.enum.forEach((e,t)=>{i.push({value:e,label:(this.schema.items.enumNames||[])[t]})}),this.attrs.multiple=!0,this.attrs.name+="[]",i.forEach(e=>{e.selected=!0})),L(this.schema.type).includes("null")&&(i=[{value:null}].concat(i)),i.forEach((e,t)=>{const s=this.renderItemWidget(this.deriveItemWidget(e,t),e,t,()=>{this.entries[t]===s&&delete this.entries[t]});s&&(this.entries[t]=s)})}deriveItemWidget(e,t){}renderItemWidget(e,t,s,r=null){}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},$e=e=>class extends(Ae(e)){static testSchema(e){if(super.testSchema(e)){var t=[],s=this.lineContentLengthLimit||50;if(e.enum){if(T(L(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s)return;t=e.enum}else{if(e.prefixItems){if(e.prefixItems.some(e=>T(L(e.type),["array","object"]).length||Math.max(e.minLength,e.maxLength,0)>s))return;t=e.prefixItems.map(e=>"const"in e?e.const:e.enum[0])}if(e.items){if(T(L(e.items.type),["array","object"]).length||Math.max(e.items.minLength,e.items.maxLength,0)>s)return;t=t.concat(e.items.enum)}}return!t.some(e=>m(e)||(e+"").length>s)}}},De=e=>class extends(Ie(e)){static testSchema(e){const t=e=>{return L(e.type||"string").includes("string")&&("data-url"===(t=e).format||"base64"===t.contentEncoding||e.contentMediaType&&!xe(e.contentMediaType));var t};return t(e)||L(e.type).includes("array")&&e.uniqueItems&&d(e.prefixItems)&&t(e.items||{})}constructor(){super(),ve(this,"filesList",ye([]))}setSchema(e,t=null){const s=L(e.type),r=s.includes("array")?je():_e();super.setSchema(new r(e),t),this.attrs.type="file",s.includes("array")&&(this.attrs.name+="[]",this.attrs.multiple=!0)}deriveItemWidget(e,t){}renderItemWidget(e,t,s){}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},He=e=>class extends(Ie(e)){setSchema(e,t=null){super.setSchema(...arguments),h(this.schema.default)&&!this.schema.examples||(this.attrs.placeholder="E.g.: "+(h(this.schema.default)?this.schema.examples[0]:this.schema.default))}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},qe=e=>class extends(He(e)){static testSchema(e){return L(e.type||"string").includes("string")&&(e.contentMediaType&&xe(e.contentMediaType)||Math.max(e.maxLength,e.minLength)>=1024)}setSchema(e,t=null){super.setSchema(new(_e())(e),t)}},ke=e=>class extends(He(e)){static testSchema(e){return L(e.type||"string").includes("string")}setSchema(e,t=null){if(super.setSchema(new(_e())(e),t),this.attrs.type="text","date"===this.schema.format?this.attrs.type="date":"time"===this.schema.format?this.attrs.type="time":"date-time"===this.schema.format?this.attrs.type="datetime-local":"duration"===this.schema.format?this.attrs.type="":["uri","uri-reference","iri","iri-reference","uuid"].includes(this.schema.format)||["hostname","idn-hostname"].includes(this.schema.format)?this.attrs.pattern="":["email","idn-email"].includes(this.schema.format)?this.attrs.type="email":["ipv4","ipv6"].includes(this.schema.format)?this.attrs.pattern="":"password"===this.schema.format?this.attrs.type="password":"color"===this.schema.format?this.attrs.type="color":"phone"===this.schema.format?this.attrs.pattern="^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,6}$":"postal-code"===this.schema.format&&(this.attrs.pattern="^[0-9]{5}(?:-[0-9]{4})?$"),this.schema.maxLength&&(this.attrs.maxlength=this.schema.maxLength),this.schema.minLength&&(this.attrs.minlength=this.schema.minLength),this.schema.pattern&&(this.attrs.pattern=this.schema.pattern),!this.schema.col){const e=this.schema.maxLength||150;this.schema.col=Math.max(1,parseInt(e/25))}}},Ce=e=>class extends(He(e)){static testSchema(e){const t=L(e.type);return t.includes("integer")||t.includes("number")}setSchema(e,t=null){if(super.setSchema(new(Le())(e),t),this.attrs.type="number",this.schema.exclusiveMaximum?this.attrs.max=this.schema.exclusiveMaximum-1e-4:this.schema.maximum&&(this.attrs.max=this.schema.maximum),this.schema.exclusiveMinimum?this.attrs.min=this.schema.exclusiveMinimum+1e-4:this.schema.minimum&&(this.attrs.min=this.schema.minimum),this.schema.multipleOf&&(this.attrs.step=this.schema.multipleOf),!this.schema.col){const e=this.schema.maxLength||50;this.schema.col=Math.max(1,parseInt(e/25))}}},Qe=e=>class extends(Ie(e)){static testSchema(e){return L(e.type).includes("boolean")}setSchema(e,t=null){super.setSchema(new(Me())(e),t),this.attrs.type="checkbox",!0!==this.schema.const&&!0!==this.schema.default||(this.attrs.checked=!0)}json(e={}){if(!arguments.length)return this.attrs.multiple?[]:null}},Ve=e=>class extends(e||HTMLElement){static get subscriptBlocks(){return["renderBasic","render"]}renderBasic(){this.schema.title&&this.namespace.title&&$(this.namespace.title).html(this.schema.title),this.schema.col?$(this).class({["col-"+this.schema.col]:!0,"col-12":!1}):$(this).class("col-12",!0)}render(){}},Ue=e=>class extends(Ve(e)){deriveChildWidget(e){if(this.template)return Reflect.ownKeys(this.template.exports).map(e=>this.template.exports[e][0]).reduce((t,s)=>{if(t)return t;const r=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return r&&r.testSchema(e)?s:null},null)}renderChildWidget(e,t,s=null){if(e){e=e.cloneNode(!0),this.namespace.content?this.namespace.content.append(e):this.append(e);try{e.setSchema(t,this)}catch(e){console.warn("Error calling element.setSchema();",e,this)}return e}}},ze=e=>class extends(Ue(We(e||HTMLElement))){},Be=e=>class extends(Ue(e)){},Ke=e=>class extends(Be(Fe(e||HTMLElement))){render(){this.namespace.input&&this.attrs.name&&$(this.namespace.input).attr(this.attrs)}extend(e=null){if(!this.entries.length||this.entries[this.entries.length-1].namespace.input.value)return super.extend(e)}},Je=e=>class extends(Ve(e)){deriveItemWidget(e,t){return!this.template&&this.namespace.input instanceof HTMLSelectElement?document.createElement("option"):Reflect.ownKeys(this.template.exports).map(e=>this.template.exports[e][0]).reduce((t,s)=>{if(t)return t;const r=s.hasAttribute("is")?customElements.get(s.getAttribute("is")):customElements.get(s.localName);return r&&r.testSchema(this.schema,e)?s:null},null)}renderItemWidget(e,t,s,r=null){if(e)return e=e.cloneNode(!0),this.namespace.input instanceof HTMLSelectElement?(this.namespace.input.options.add(e),e.setAttribute("label",t.label||B(t.value)),e.value=t.value,e.selected=t.selected):(this.namespace.input.append(e),e.setAttribute("data-index",s)),e}json(e=null){if(!arguments.length)return this.namespace.input instanceof HTMLSelectElement?this.attrs.multiple?this.namespace.input.selectedOptions:this.namespace.input.value:this.attrs.multiple?[]:this.namespace.input.value;if(this.namespace.input instanceof HTMLSelectElement)if(this.attrs.multiple){if(!_isArray(e))throw new Error("Data must be a valid JSON array.");Array.from(this.namespace.input.options).forEach(t=>{t.selected=!1,e.forEach(e=>{t.value===e&&(t.selected=!0)})})}else this.namespace.input.value=e;else this.attrs.multiple}render(){this.namespace.input&&this.attrs.name&&$(this.namespace.input).attr(this.attrs)}},Ge=e=>class extends(Ve(De(e||HTMLElement))){setSchema(e,t=null){super.setSchema(...arguments);L(this.schema.type).includes("array")&&(this.attrs.name+="[]")}constructor(){super(),this._dataTransfer=new DataTransfer,be(this.filesList,e=>{e.forEach(e=>{"deleteProperty"===e.type&&e.oldValue.previewElement&&e.oldValue.previewElement.remove(),"set"===e.type&&e.isUpdate&&e.oldValue&&e.oldValue.previewElement&&e.oldValue.previewElement.remove()})}),this.addEventListener("change",e=>{this.namespace.dropArea&&this.addFiles(e.target.files,!0)}),this._handlerDrag=e=>{"dragover"===e.type||"dragenter"===e.type?this.state&&(this.state.dragging=!0):"dragleave"!==e.type&&"dragend"!==e.type&&"drop"!==e.type||(e.preventDefault(),this.state&&(this.state.dragging=!1),"drop"===e.type&&this.addFiles(e.dataTransfer.files))}}connectedCallback(){super.connectedCallback(),this.namespace.dropArea&&["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(e=>{this.namespace.dropArea.removeEventListener(e,this._handlerDrag),this.namespace.dropArea.addEventListener(e,this._handlerDrag)})}addFiles(e,t=!1){const s=e=>{if(!e)return;const s={file:e,isDirectSelection:t,remove:()=>{this._dataTransfer.items.remove(e),this.filesList.splice(this.filesList.indexOf(s),1)}};this._dataTransfer.items.add(e),this.filesList.push(s);const r=this.filesList.length-1;s.previewElement=this.renderPreviewElement(this.derivePreviewElement(e,r),e,r,()=>{s.remove()})};if(this.schema.multiple){t&&this.filesList.filter(e=>e.isDirectSelection).forEach(e=>e.remove());for(let t=0;t<e.length;t++)s(e[t])}else this._dataTransfer.items.clear(),this.filesList.splice(0),s(e[0]);this.namespace.input&&(this.namespace.input.files=this._dataTransfer.files)}derivePreview(e){var t=`${e.name}: ${e.size/1024}KB`,s=e=>window.URL.revokeObjectURL(e.src);if(/^image\//.test(e.type)){var r=document.createElement("img");return r.onload=e=>{s(r)},r.src=window.URL.createObjectURL(e),{el:r,type:"image",mime:e.type,desc:t}}if(/^video\//.test(e.type)){var i=document.createElement("video");return i.onloadstart=e=>{s(i),i.play()},i.src=window.URL.createObjectURL(e),i.muted=!0,{el:i,type:"video",mime:e.type,desc:t}}const n=document.createElement("i");n.classList.add("bi");var a="file";return/^audio\//.test(e.type)?a="audio":/msword|ms-word|wordprocessing/.test(e.type)?a="word":/powerpoint|presentation/.test(e.type)?a="powerpoint":/excel|spreadsheet/.test(e.type)?a="excel":/^text\//.test(e.type)?a="text":/\/pdf/.test(e.type)?a="pdf":/\/zip/.test(e.type)&&(a="zip"),n.classList.add("bi-file-"+a),{el:n,type:a,mime:e.type,desc:t}}derivePreviewElement(e,t){if(this.template)return(this.template.exports.default||[])[0]}renderPreviewElement(e,t,s,r=null){const i=this.derivePreview(t);return e?(e=e.cloneNode(!0)).append(i.el):e=i.el,this.namespace.preview?this.namespace.preview.append(e):this.append(e),e}json(e=null){if(!arguments.length)return this.attrs.multiple?this.namespace.input.files:this.namespace.input.files[0];if(this.filesList.forEach(e=>{e.remove()}),this.attrs.multiple){if(!_isArray(e))throw new Error("Data must be a valid JSON array.")}else e=[e];this.addFiles(e)}render(){this.namespace.input&&(this.attrs.type||this.attrs.name)&&$(this.namespace.input).attr(this.attrs)}},Xe=e=>class extends(Ve(e)){json(e=null){if(!arguments.length)return this.namespace.input.value;this.namespace.input.value=e}render(){this.namespace.input&&(this.attrs.type||this.attrs.name)&&$(this.namespace.input).attr(this.attrs)}},Ye=e=>class extends(Xe(Qe(e||HTMLElement))){json(e=null){if(!arguments.length)return this.namespace.input.checked?this.namespace.input.value:null;this.namespace.input.value=e}},Ze=class extends(WebQit.SubscriptElement(ze(HTMLFormElement))){},et=class extends(WebQit.SubscriptElement(ze(HTMLFieldSetElement))){},tt=class extends(WebQit.SubscriptElement((e=>class extends(Be(Ne(e||HTMLElement))){})(HTMLFieldSetElement))){},st=class extends(WebQit.SubscriptElement(Ke(HTMLFieldSetElement))){},rt=class extends(WebQit.SubscriptElement((e=>class extends(Je(Ae(e||HTMLElement))){})(HTMLLabelElement))){},it=class extends(WebQit.SubscriptElement((e=>class extends(Je($e(e||HTMLElement))){})(HTMLLabelElement))){},nt=class extends(WebQit.SubscriptElement(Ge(HTMLLabelElement))){},at=class extends(WebQit.SubscriptElement((e=>class extends(Xe(qe(e||HTMLElement))){})(HTMLLabelElement))){},lt=class extends(WebQit.SubscriptElement((e=>class extends(Xe(ke(e||HTMLElement))){})(HTMLLabelElement))){},ct=class extends(WebQit.SubscriptElement((e=>class extends(Xe(Ce(e||HTMLElement))){})(HTMLLabelElement))){},ut=class extends(WebQit.SubscriptElement(Ye(HTMLLabelElement))){};customElements.define("playui-form-widget",Ze,{extends:"form"}),customElements.define("playui-collection-widget",et,{extends:"fieldset"}),customElements.define("playui-multiple-widget",tt,{extends:"fieldset"}),customElements.define("playui-multiple2-widget",st,{extends:"fieldset"}),customElements.define("playui-enum-widget",rt,{extends:"label"}),customElements.define("playui-enum2-widget",it,{extends:"label"}),customElements.define("playui-file-widget",nt,{extends:"label"}),customElements.define("playui-editor-widget",at,{extends:"label"}),customElements.define("playui-text-widget",lt,{extends:"label"}),customElements.define("playui-number-widget",ct,{extends:"label"}),customElements.define("playui-state-widget",ut,{extends:"label"})}]);
//# sourceMappingURL=main.js.map